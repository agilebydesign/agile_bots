{
  "behaviorName": "shape",
  "order": 1,
  "description": "Create a story map that captures the user's journey through epics, features, and stories",
  "goal": "Shape story map from user context - capture user needs, business requirements, and story structure",
  "inputs": "User context, interviews, vision documents, existing requirements, business domain experts interviews",
  "outputs": "story-graph.json, story-map.md, story-map-outline.drawio, story-map.txt",
  "baseActionsPath": "agile_bot/base_actions",
  "instructions": [
    "Create a story map that captures the user's journey through epics, sub-epics, and stories"
  ],
  "actions_workflow": {
    "actions": [
      {
        "name": "clarify",
        "order": 1,
        "next_action": "strategy",
        "instructions": [
          "Gather context for story mapping"
        ]
      },
      {
        "name": "strategy",
        "order": 2,
        "next_action": "build",
        "instructions": []
      },
      {
        "name": "build",
        "order": 3,
        "next_action": "validate",
        "instructions": [
          "shape: build story map structure",
          "Apply story shaping rules (context: 'when shaping stories') for story structure",
          "",
          "**STORY GRAPH UPDATE STRATEGY (use when story-graph.json already exists):**",
          "",
          "When updating an existing story graph, do NOT read and rewrite the entire story-graph.json manually.",
          "Choose one of these approaches in order of preference:",
          "",
          "1. **API approach (preferred for targeted changes):**",
          "   Use the StoryMap node API via CLI dot-notation to make surgical changes.",
          "   - Navigate: story_map.filter_by_name name:\"Sub Epic Name\" to read only the relevant subtree",
          "   - Create:  story_map.create_epic name:\"Epic Name\"",
          "   - Create:  story_map.\"Epic\".create_sub_epic name:\"Sub Epic Name\"",
          "   - Create:  story_map.\"Epic\".\"SubEpic\".create_story name:\"Story Name\"",
          "   - Rename:  story_map.\"Epic\".\"SubEpic\".rename name:\"New Name\"",
          "   - Move:    story_map.\"Epic\".\"SubEpic\".\"Story\".move_to target:\"Other SubEpic\"",
          "   - Reorder: story_map.\"Epic\".\"SubEpic\".\"Story\".move_to at_position:2",
          "   - Delete:  story_map.\"Epic\".\"SubEpic\".delete",
          "   Each call auto-saves the full graph safely through in-memory tree serialization.",
          "",
          "2. **Bulk approach (for sweeping changes across many stories):**",
          "   Build a temporary StoryMap with just your changes using the same create API (without bot context),",
          "   then use generate_merge_report() to compare against the original, and merge_story_graphs() to apply.",
          "   The merge preserves all original data (acceptance_criteria, scenarios, steps, metadata) you did not change.",
          "",
          "3. **Manual JSON edit (last resort only):**",
          "   Only if the API and bulk approaches cannot handle the situation.",
          "   Use filter_by_name to read a scoped subtree rather than the full file.",
          "   Write changes back through the StoryMap.save() method, as oposed to by editing story-graph.json directly."
        ]
      },
      {
        "name": "validate",
        "order": 4,
        "next_action": "render",
        "instructions": [
          "shape: validate hierarchy and story structure",
          "Apply story shaping rules (context: 'when shaping stories') for story structure"
        ]
      },
      {
        "name": "render",
        "order": 5,
        "instructions": [
          "shape: render story map documents"
        ]
      }
    ]
  },
  "trigger_words": {
    "description": "Behavior-level trigger words - specific to shaping/scoping/initial planning behavior",
    "patterns": [
      "start.*shaping",
      "let.*s.*shape",
      "begin.*shaping",
      "do.*shaping",
      "shaping",
      "shape.*capability",
      "scoping",
      "initial.*planning",
      "starting.*with.*requirements",
      "begin.*capability.*shape",
      "explore.*problem.*space",
      "what.*are.*we.*solving",
      "frame.*initiative",
      "frame.*solution",
      "kick.*off.*project",
      "initiate.*request",
      "describe.*need",
      "start.*intake",
      "capture.*ask",
      "early.*shaping",
      "solution.*intent",
      "business.*intent",
      "initial.*goal",
      "who.*needs.*what",
      "start.*mapping.*conversation",
      "map.*user.*types",
      "identify.*system.*touchpoints",
      "start.*exploring.*flow",
      "problem.*framing",
      "build.*new",
      "start.*new.*project",
      "new.*project",
      "begin.*new",
      "create.*new",
      "start.*on.*new",
      "want.*to.*build.*new",
      "want.*to.*start.*new",
      "want.*to.*start.*on.*new",
      "i.*want.*to.*build",
      "i.*want.*to.*start",
      "new.*initiative",
      "new.*application",
      "new.*solution",
      "new.*system",
      "new.*platform",
      "new.*service",
      "new.*product",
      "new.*capability",
      "new.*tool",
      "new.*software",
      "new.*technology",
      "new.*tech.*stack",
      "new.*architecture",
      "new.*infrastructure",
      "new.*integration",
      "new.*api",
      "new.*microservice",
      "new.*component",
      "new.*module",
      "new.*framework",
      "new.*library",
      "new.*ecosystem",
      "new.*transformation",
      "new.*modernization",
      "new.*digital",
      "new.*automation",
      "new.*enterprise",
      "new.*program",
      "launch.*new",
      "develop.*new",
      "design.*new",
      "implement.*new",
      "roll.*out.*new",
      "deploy.*new",
      "release.*new",
      "introduce.*new",
      "establish.*new",
      "set.*up.*new",
      "commence.*new",
      "embark.*on.*new",
      "undertake.*new"
    ]
  }
}