{
  "epics": [
    {
      "name": "Build Agile Bots",
      "sequential_order": 1.0,
      "domain_concepts": [
        {
          "name": "Base Bot",
          "module": "bot",
          "responsibilities": [
            {
              "name": "Executes Actions",
              "collaborators": [
                "Workflow",
                "Behavior",
                "Action"
              ]
            },
            {
              "name": "Execute behavior by name",
              "collaborators": [
                "Behavior Name",
                "BotResult"
              ]
            },
            {
              "name": "Execute current action",
              "collaborators": [
                "BotResult"
              ]
            },
            {
              "name": "Navigate and execute",
              "collaborators": [
                "Behavior Name",
                "Action Name",
                "ActionContext",
                "BotResult"
              ]
            },
            {
              "name": "Validate behavior exists",
              "collaborators": [
                "Behavior Name",
                "Boolean"
              ]
            },
            {
              "name": "Validate action exists",
              "collaborators": [
                "Behavior Name",
                "Action Name",
                "Boolean"
              ]
            },
            {
              "name": "Track activity",
              "collaborators": [
                "Behavior",
                "Action"
              ]
            },
            {
              "name": "Route to behaviors and actions",
              "collaborators": [
                "Router",
                "Trigger Words"
              ]
            },
            {
              "name": "Persist content",
              "collaborators": [
                "Content"
              ]
            },
            {
              "name": "Manage Project State",
              "collaborators": [
                "Project"
              ]
            },
            {
              "name": "Render",
              "collaborators": []
            }
          ]
        },
        {
          "name": "Specific Bot",
          "module": "bot",
          "responsibilities": [
            {
              "name": "Provide Behavior config",
              "collaborators": [
                "Bot Config",
                "Behavior"
              ]
            },
            {
              "name": "Provide MCP config",
              "collaborators": [
                "MCP Config"
              ]
            },
            {
              "name": "Provide Renderers",
              "collaborators": []
            },
            {
              "name": "Provide Extractors",
              "collaborators": []
            },
            {
              "name": "Provide Synchronizer",
              "collaborators": []
            },
            {
              "name": "Provide Trigger Words",
              "collaborators": []
            }
          ]
        },
        {
          "name": "BotLangActionNode",
          "module": "workflow",
          "responsibilities": [
            {
              "name": "Wrap action.execute(context) method",
              "collaborators": [
                "Action",
                "LangGraph"
              ]
            },
            {
              "name": "Implement two-pass pattern",
              "collaborators": [
                "Action",
                "AI"
              ]
            },
            {
              "name": "Support execution modes",
              "collaborators": [
                "BotMode"
              ]
            },
            {
              "name": "Provide LangGraph entry point",
              "collaborators": [
                "LangGraph"
              ]
            }
          ]
        },
        {
          "name": "BehaviorGraphBuilder",
          "module": "workflow",
          "responsibilities": [
            {
              "name": "Read behavior workflow definitions",
              "collaborators": [
                "Behavior",
                "Behavior Config"
              ]
            },
            {
              "name": "Create LangGraph StateGraph",
              "collaborators": [
                "LangGraph",
                "BotLangState"
              ]
            },
            {
              "name": "Build node instances from actions",
              "collaborators": [
                "BotLangActionNode",
                "Action"
              ]
            },
            {
              "name": "Connect nodes based on workflow order",
              "collaborators": [
                "LangGraph",
                "BotLangActionNode"
              ]
            }
          ]
        },
        {
          "name": "BotLangFlowRunner",
          "module": "workflow",
          "responsibilities": [
            {
              "name": "Load BotLangFlow Python files",
              "collaborators": [
                "BotLangFlow",
                "File System"
              ]
            },
            {
              "name": "Compile graph with checkpointer",
              "collaborators": [
                "LangGraph",
                "SqliteSaver",
                "Checkpoint"
              ]
            },
            {
              "name": "Execute workflow graph",
              "collaborators": [
                "LangGraph",
                "BotLangActionNode",
                "BotLangState"
              ]
            },
            {
              "name": "Resume from checkpoint",
              "collaborators": [
                "Checkpoint",
                "BotLangState"
              ]
            }
          ]
        },
        {
          "name": "StoryBotMCPServer",
          "module": "agile_bot.bots.story_bot.src.story_bot_mcp_server",
          "responsibilities": [
            {
              "name": "Bootstraps environment",
              "collaborators": [
                "BOT_DIRECTORY",
                "WORKING_AREA",
                "Bot Config"
              ]
            },
            {
              "name": "Creates Bot instance",
              "collaborators": [
                "Bot",
                "Bot Config",
                "Bot Directory"
              ]
            },
            {
              "name": "Creates FastMCP server",
              "collaborators": [
                "FastMCP",
                "Server Name"
              ]
            },
            {
              "name": "Registers bot tool",
              "collaborators": [
                "Bot",
                "Current Behavior",
                "Current Action"
              ]
            },
            {
              "name": "Registers behavior tools",
              "collaborators": [
                "Bot",
                "Behavior",
                "Action",
                "Tool Generator"
              ]
            },
            {
              "name": "Registers utility tools",
              "collaborators": [
                "Working Directory Manager",
                "Action State Manager",
                "Server Restart Manager"
              ]
            },
            {
              "name": "Delegates to Bot",
              "collaborators": [
                "Bot",
                "Behavior",
                "Action"
              ]
            },
            {
              "name": "Runs MCP server",
              "collaborators": [
                "FastMCP",
                "Event Loop"
              ]
            },
            {
              "name": "Get bot_directory",
              "collaborators": [
                "Path"
              ]
            },
            {
              "name": "Get workspace_directory",
              "collaborators": [
                "Path"
              ]
            },
            {
              "name": "Get bot",
              "collaborators": [
                "Bot"
              ]
            },
            {
              "name": "Get server",
              "collaborators": [
                "FastMCP"
              ]
            }
          ]
        },
        {
          "name": "StoryBotCLI",
          "module": "agile_bot.bots.story_bot.src.story_bot_cli",
          "responsibilities": [
            {
              "name": "Bootstraps environment",
              "collaborators": [
                "BOT_DIRECTORY",
                "WORKING_AREA",
                "Bot Config"
              ]
            },
            {
              "name": "Delegates to BaseBotCli",
              "collaborators": [
                "Base Bot CLI",
                "Bot Name",
                "Bot Config Path"
              ]
            },
            {
              "name": "Executes CLI",
              "collaborators": [
                "Base Bot CLI",
                "Command Arguments"
              ]
            },
            {
              "name": "Get bot_directory",
              "collaborators": [
                "Path"
              ]
            },
            {
              "name": "Get workspace_directory",
              "collaborators": [
                "Path"
              ]
            },
            {
              "name": "Get bot_name",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get bot_config_path",
              "collaborators": [
                "Path"
              ]
            }
          ]
        },
        {
          "name": "BehaviorToolGenerator",
          "module": "agile_bot.bots.story_bot.src.story_bot_mcp_server",
          "responsibilities": [
            {
              "name": "Generates behavior tool function",
              "collaborators": [
                "Behavior",
                "Trigger Patterns"
              ]
            },
            {
              "name": "Routes to behavior",
              "collaborators": [
                "Bot",
                "Behavior Name"
              ]
            },
            {
              "name": "Routes to action",
              "collaborators": [
                "Behavior",
                "Action Name"
              ]
            },
            {
              "name": "Executes action",
              "collaborators": [
                "Action",
                "Parameters"
              ]
            },
            {
              "name": "Returns result",
              "collaborators": [
                "Bot Result",
                "Status",
                "Data"
              ]
            },
            {
              "name": "Handles missing action",
              "collaborators": [
                "Current Action",
                "State"
              ]
            },
            {
              "name": "Loads action state",
              "collaborators": [
                "Behavior",
                "Action State"
              ]
            },
            {
              "name": "Get tool_name",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get tool_description",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get trigger_patterns",
              "collaborators": [
                "List"
              ]
            }
          ]
        },
        {
          "name": "WorkingDirectoryManager",
          "module": "agile_bot.bots.story_bot.src.story_bot_mcp_server",
          "responsibilities": [
            {
              "name": "Gets working directory",
              "collaborators": [
                "Workspace Directory",
                "WORKING_AREA"
              ]
            },
            {
              "name": "Sets working directory",
              "collaborators": [
                "New Path",
                "Persist Flag"
              ]
            },
            {
              "name": "Validates path",
              "collaborators": [
                "Path",
                "Validation Rules"
              ]
            },
            {
              "name": "Updates environment",
              "collaborators": [
                "WORKING_AREA",
                "Environment Variables"
              ]
            },
            {
              "name": "Updates bot config",
              "collaborators": [
                "Bot Config",
                "Working Area",
                "Persist Flag"
              ]
            },
            {
              "name": "Persists to config",
              "collaborators": [
                "Bot Config File",
                "JSON"
              ]
            },
            {
              "name": "Returns previous directory",
              "collaborators": [
                "Previous Path",
                "Workspace Directory"
              ]
            },
            {
              "name": "Get working_directory",
              "collaborators": [
                "Path"
              ]
            },
            {
              "name": "Get previous_directory",
              "collaborators": [
                "Path"
              ]
            },
            {
              "name": "Get persisted",
              "collaborators": [
                "Boolean"
              ]
            }
          ]
        },
        {
          "name": "ActionStateManager",
          "module": "agile_bot.bots.story_bot.src.story_bot_mcp_server",
          "responsibilities": [
            {
              "name": "Closes current action",
              "collaborators": [
                "Current Action",
                "Behavior",
                "State File"
              ]
            },
            {
              "name": "Loads action state",
              "collaborators": [
                "Behavior",
                "Action State",
                "State File"
              ]
            },
            {
              "name": "Determines next action",
              "collaborators": [
                "Behavior",
                "Action Names",
                "Current Index"
              ]
            },
            {
              "name": "Transitions to next action",
              "collaborators": [
                "Behavior",
                "Current Action",
                "Next Action"
              ]
            },
            {
              "name": "Detects behavior completion",
              "collaborators": [
                "Current Action",
                "Final Action",
                "Behavior"
              ]
            },
            {
              "name": "Transitions to next behavior",
              "collaborators": [
                "Bot",
                "Next Behavior",
                "First Action"
              ]
            },
            {
              "name": "Returns transition result",
              "collaborators": [
                "Status",
                "Completed Action",
                "Next Action"
              ]
            },
            {
              "name": "Handles out-of-order confirmation",
              "collaborators": [
                "Behavior",
                "Confirmation",
                "State File"
              ]
            },
            {
              "name": "Validates human confirmation",
              "collaborators": [
                "Confirmed By",
                "Timestamp"
              ]
            },
            {
              "name": "Persists confirmation",
              "collaborators": [
                "State File",
                "Confirmation Data",
                "JSON"
              ]
            },
            {
              "name": "Get state_file",
              "collaborators": [
                "Path"
              ]
            },
            {
              "name": "Get current_action",
              "collaborators": [
                "Action"
              ]
            },
            {
              "name": "Get next_action",
              "collaborators": [
                "Action"
              ]
            },
            {
              "name": "Get behavior_complete",
              "collaborators": [
                "Boolean"
              ]
            },
            {
              "name": "Get out_of_order_confirmations",
              "collaborators": [
                "Dict"
              ]
            }
          ]
        },
        {
          "name": "Synchronizer",
          "module": "agile_bot.bots.base_bot.src.synchronizers",
          "responsibilities": [
            {
              "name": "Synchronizes formats",
              "collaborators": [
                "Source Format",
                "Target Format"
              ]
            },
            {
              "name": "Extracts from source",
              "collaborators": [
                "Extractor",
                "Source File"
              ]
            },
            {
              "name": "Renders to target",
              "collaborators": [
                "Renderer",
                "Target File"
              ]
            },
            {
              "name": "Validates sync",
              "collaborators": [
                "Source",
                "Target",
                "Rules"
              ]
            },
            {
              "name": "Get source_format",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get target_format",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get extractor",
              "collaborators": [
                "Extractor"
              ]
            },
            {
              "name": "Get renderer",
              "collaborators": [
                "Renderer"
              ]
            }
          ]
        },
        {
          "name": "StoryIOSynchronizer : Synchronizer",
          "module": "agile_bot.bots.story_bot.src.synchronizers.story_io.story_io_synchronizer",
          "responsibilities": [
            {
              "name": "Syncs story graph with drawio",
              "collaborators": [
                "Story Graph",
                "Drawio File"
              ]
            },
            {
              "name": "Extracts stories from drawio",
              "collaborators": [
                "Drawio Parser",
                "Story Components"
              ]
            },
            {
              "name": "Renders stories to drawio",
              "collaborators": [
                "Story Renderer",
                "Drawio Generator"
              ]
            },
            {
              "name": "Manages story positions",
              "collaborators": [
                "Position Manager",
                "Story Layout"
              ]
            },
            {
              "name": "Updates increments",
              "collaborators": [
                "Increment Manager",
                "Priority Data"
              ]
            },
            {
              "name": "Validates story structure",
              "collaborators": [
                "Structure Validator",
                "Story Rules"
              ]
            },
            {
              "name": "Get story_graph_path",
              "collaborators": [
                "Path"
              ]
            },
            {
              "name": "Get drawio_path",
              "collaborators": [
                "Path"
              ]
            },
            {
              "name": "Get increments",
              "collaborators": [
                "List"
              ]
            },
            {
              "name": "Get epics",
              "collaborators": [
                "List"
              ]
            },
            {
              "name": "Get stories",
              "collaborators": [
                "List"
              ]
            }
          ]
        },
        {
          "name": "DomainModelSynchronizer : Synchronizer",
          "module": "agile_bot.bots.story_bot.src.synchronizers.domain_model.domain_model_synchronizer",
          "responsibilities": [
            {
              "name": "Syncs CRC text with story graph",
              "collaborators": [
                "CRC Text",
                "Story Graph",
                "Domain Concepts"
              ]
            },
            {
              "name": "Extracts domain concepts",
              "collaborators": [
                "CRC Parser",
                "Concept Extractor"
              ]
            },
            {
              "name": "Renders domain concepts",
              "collaborators": [
                "Concept Renderer",
                "CRC Template"
              ]
            },
            {
              "name": "Validates CRC format",
              "collaborators": [
                "CRC Validator",
                "Format Rules"
              ]
            },
            {
              "name": "Preserves module paths",
              "collaborators": [
                "Module Mapper",
                "Code Structure"
              ]
            },
            {
              "name": "Get crc_path",
              "collaborators": [
                "Path"
              ]
            },
            {
              "name": "Get story_graph_path",
              "collaborators": [
                "Path"
              ]
            },
            {
              "name": "Get domain_concepts",
              "collaborators": [
                "List"
              ]
            }
          ]
        },
        {
          "name": "StoryIOEpic",
          "module": "agile_bot.bots.story_bot.src.synchronizers.story_io.story_io_epic",
          "responsibilities": [
            {
              "name": "Owns features",
              "collaborators": [
                "Feature List",
                "Epic Context"
              ]
            },
            {
              "name": "Calculates total stories",
              "collaborators": [
                "Feature",
                "Story Count"
              ]
            },
            {
              "name": "Renders epic section",
              "collaborators": [
                "Epic Renderer",
                "Template"
              ]
            },
            {
              "name": "Validates epic structure",
              "collaborators": [
                "Epic Validator",
                "Rules"
              ]
            },
            {
              "name": "Get name",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get description",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get features",
              "collaborators": [
                "List"
              ]
            },
            {
              "name": "Get total_stories",
              "collaborators": [
                "Integer"
              ]
            },
            {
              "name": "Get sequential_order",
              "collaborators": [
                "Float"
              ]
            }
          ]
        },
        {
          "name": "StoryIOFeature",
          "module": "agile_bot.bots.story_bot.src.synchronizers.story_io.story_io_feature",
          "responsibilities": [
            {
              "name": "Owns stories",
              "collaborators": [
                "Story List",
                "Feature Context"
              ]
            },
            {
              "name": "Calculates story count",
              "collaborators": [
                "Story",
                "Count"
              ]
            },
            {
              "name": "Renders feature section",
              "collaborators": [
                "Feature Renderer",
                "Template"
              ]
            },
            {
              "name": "Validates feature structure",
              "collaborators": [
                "Feature Validator",
                "Rules"
              ]
            },
            {
              "name": "Get name",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get description",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get stories",
              "collaborators": [
                "List"
              ]
            },
            {
              "name": "Get story_count",
              "collaborators": [
                "Integer"
              ]
            }
          ]
        },
        {
          "name": "StoryIOStory",
          "module": "agile_bot.bots.story_bot.src.synchronizers.story_io.story_io_story",
          "responsibilities": [
            {
              "name": "Owns acceptance criteria",
              "collaborators": [
                "Criteria List",
                "Story Context"
              ]
            },
            {
              "name": "Owns increment assignment",
              "collaborators": [
                "Increment",
                "Priority"
              ]
            },
            {
              "name": "Renders story card",
              "collaborators": [
                "Story Renderer",
                "Template"
              ]
            },
            {
              "name": "Validates story format",
              "collaborators": [
                "Story Validator",
                "Rules"
              ]
            },
            {
              "name": "Calculates position",
              "collaborators": [
                "Position Manager",
                "Layout"
              ]
            },
            {
              "name": "Get name",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get description",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get acceptance_criteria",
              "collaborators": [
                "List"
              ]
            },
            {
              "name": "Get increment",
              "collaborators": [
                "Integer"
              ]
            },
            {
              "name": "Get priority",
              "collaborators": [
                "Integer"
              ]
            },
            {
              "name": "Get position",
              "collaborators": [
                "Position"
              ]
            }
          ]
        },
        {
          "name": "StoryIOIncrement",
          "module": "agile_bot.bots.story_bot.src.synchronizers.story_io.story_io_increment",
          "responsibilities": [
            {
              "name": "Owns story assignments",
              "collaborators": [
                "Story List",
                "Increment Context"
              ]
            },
            {
              "name": "Manages priorities",
              "collaborators": [
                "Priority Order",
                "Story Sequence"
              ]
            },
            {
              "name": "Calculates capacity",
              "collaborators": [
                "Story Count",
                "Capacity Limit"
              ]
            },
            {
              "name": "Renders increment view",
              "collaborators": [
                "Increment Renderer",
                "Template"
              ]
            },
            {
              "name": "Validates increment structure",
              "collaborators": [
                "Increment Validator",
                "Rules"
              ]
            },
            {
              "name": "Get number",
              "collaborators": [
                "Integer"
              ]
            },
            {
              "name": "Get name",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get stories",
              "collaborators": [
                "List"
              ]
            },
            {
              "name": "Get capacity",
              "collaborators": [
                "Integer"
              ]
            },
            {
              "name": "Get priority_order",
              "collaborators": [
                "List"
              ]
            }
          ]
        },
        {
          "name": "StoryIORenderer",
          "module": "agile_bot.bots.story_bot.src.synchronizers.story_io.story_io_renderer",
          "responsibilities": [
            {
              "name": "Renders epic cells",
              "collaborators": [
                "Epic",
                "Cell Generator",
                "XML"
              ]
            },
            {
              "name": "Renders feature cells",
              "collaborators": [
                "Feature",
                "Cell Generator",
                "XML"
              ]
            },
            {
              "name": "Renders story cells",
              "collaborators": [
                "Story",
                "Cell Generator",
                "XML"
              ]
            },
            {
              "name": "Renders increment lanes",
              "collaborators": [
                "Increment",
                "Lane Generator",
                "XML"
              ]
            },
            {
              "name": "Calculates layout",
              "collaborators": [
                "Layout Manager",
                "Position Calculator"
              ]
            },
            {
              "name": "Formats XML",
              "collaborators": [
                "XML Formatter",
                "Pretty Print"
              ]
            },
            {
              "name": "Get cell_style",
              "collaborators": [
                "String"
              ]
            },
            {
              "name": "Get layout_config",
              "collaborators": [
                "Dict"
              ]
            },
            {
              "name": "Get xml_formatter",
              "collaborators": [
                "XMLFormatter"
              ]
            }
          ]
        }
      ],
      "sub_epics": [
        {
          "name": "Generate MCP Tools",
          "sequential_order": 1.0,
          "test_file": "test_generate_mcp_tools.py",
          "story_groups": [
            {
              "type": "and",
              "connector": "or",
              "stories": [
                {
                  "name": "Generate Bot Tools",
                  "sequential_order": 0.5,
                  "connector": "and",
                  "users": [
                    "MCP Server Generator"
                  ],
                  "story_type": "user",
                  "test_class": "TestGenerateBotTools",
                  "acceptance_criteria": [
                    "WHEN Generator processes Bot Config",
                    "THEN Generator creates 1 bot tool instance"
                  ],
                  "scenarios": [
                    {
                      "name": "Generator creates bot tool for test_bot",
                      "steps": "Given A bot configuration file with a working directory and behaviors\nAnd A bot that has been initialized with that config file\nWhen Generator processes Bot Config\nThen Generator creates 1 bot tool instance",
                      "test_method": "test_generator_creates_bot_tool_for_test_bot"
                    }
                  ]
                },
                {
                  "name": "Generate Behavior Tools",
                  "sequential_order": 0.6,
                  "connector": "and",
                  "users": [
                    "MCP Server Generator"
                  ],
                  "story_type": "user",
                  "test_class": "TestGenerateBehaviorTools",
                  "acceptance_criteria": [
                    "WHEN Generator processes Bot Config",
                    "THEN Generator creates behavior tool instances for each behavior"
                  ],
                  "scenarios": [
                    {
                      "name": "Generator creates behavior tools for test_bot with 4 behaviors",
                      "steps": "Given A bot configuration file with a working directory and behaviors\nAnd A bot that has been initialized with that config file\nWhen Generator processes Bot Config\nThen Generator creates 4 behavior tool instances",
                      "test_method": "test_generator_creates_behavior_tools_for_test_bot_with_4_behaviors"
                    }
                  ]
                },
                {
                  "name": "Generate MCP Bot Server",
                  "sequential_order": 1,
                  "connector": "and",
                  "users": [
                    "MCP Server Generator"
                  ],
                  "story_type": "user",
                  "test_class": "TestGenerateMCPBotServer",
                  "acceptance_criteria": [
                    "WHEN MCP Server Generator receives Bot Config",
                    "THEN Generator generates unique MCP Server instance with Unique server name from bot name",
                    "AND Generated server includes Bot Config reference",
                    "AND Generated server leverages Specific Bot instantiation code"
                  ],
                  "scenarios": [
                    {
                      "name": "Generator creates MCP server for test_bot",
                      "steps": "Given A bot configuration file with a working directory and behaviors\nAnd A bot that has been initialized with that config file\nWhen MCP Server Generator receives Bot Config\nThen Generator creates MCP Server instance with unique server name",
                      "test_method": "test_generator_creates_mcp_server_for_test_bot"
                    },
                    {
                      "name": "Generator fails when Bot Config is missing",
                      "steps": "Given A bot directory exists\nAnd Bot Config does NOT exist\nWhen MCP Server Generator attempts to receive Bot Config\nThen Generator raises FileNotFoundError and does not create MCP Server instance",
                      "test_method": "test_generator_fails_when_bot_config_missing"
                    },
                    {
                      "name": "Generator fails when Bot Config is malformed",
                      "steps": "Given A bot directory exists\nAnd Bot Config file exists with invalid JSON syntax\nWhen MCP Server Generator attempts to receive Bot Config\nThen Generator raises JSONDecodeError and does not create MCP Server instance",
                      "test_method": "test_generator_fails_when_bot_config_malformed"
                    }
                  ]
                },
                {
                  "name": "Generate Behavior Action Tools",
                  "sequential_order": 2,
                  "connector": "and",
                  "users": [
                    "MCP Server Generator"
                  ],
                  "story_type": "user",
                  "test_class": "TestGenerateBehaviorActionTools",
                  "acceptance_criteria": [
                    "WHEN Generator processes Bot Config",
                    "THEN Generator creates tool code for each (behavior, action) pair",
                    "AND Enumerates all behaviors and actions from Bot Config",
                    "AND For each pair, generates tool code with unique name, trigger words, forwarding logic",
                    "AND Tool catalog prepared with all generated tool instances"
                  ],
                  "scenarios": [
                    {
                      "name": "Tools generated for each behavior action",
                      "steps": "GIVEN: Bot with behaviors and actions\nWHEN: Tool generation is triggered\nTHEN: MCP tools are created for each action",
                      "test_method": "test_tools_generated_for_each_behavior_action"
                    }
                  ]
                },
                {
                  "name": "Deploy MCP BOT Server",
                  "sequential_order": 3,
                  "connector": "and",
                  "users": [],
                  "story_type": "user",
                  "test_class": "TestDeployMCPBotServer",
                  "acceptance_criteria": [
                    "WHEN Generation Complete",
                    "THEN Generator deploys/starts generated MCP Server",
                    "AND Server initializes in separate thread",
                    "AND Server registers with MCP Protocol Handler using unique server name",
                    "AND Server publishes tool catalog to AI Chat",
                    "AND Each tool entry includes name, description, trigger patterns, parameters"
                  ],
                  "scenarios": [
                    {
                      "name": "MCP server deployed with tools",
                      "steps": "GIVEN: Bot tools are generated\nWHEN: Server deployment is triggered\nTHEN: MCP server is running with tools",
                      "test_method": "test_mcp_server_deployed_with_tools"
                    }
                  ]
                },
                {
                  "name": "Restart MCP Server To Load Code Changes",
                  "sequential_order": 4,
                  "connector": "and",
                  "users": [
                    "MCP Server Generator"
                  ],
                  "story_type": "user",
                  "test_class": "TestRestartMCPServerToLoadCodeChanges",
                  "acceptance_criteria": [
                    "WHEN Bot code changes are detected",
                    "THEN MCP Server clears Python bytecode cache (__pycache__)",
                    "AND MCP Server restarts to load new code",
                    "AND Server restarts gracefully without losing state",
                    "AND Server re-registers with MCP Protocol Handler after restart"
                  ],
                  "scenarios": [
                    {
                      "name": "Clear Python bytecode cache",
                      "steps": "Given __pycache__ directories exist with .pyc files\nWhen clear_python_cache is called\nThen All __pycache__ directories are removed\nAnd All .pyc files are deleted\nAnd Cache is cleared before server restart",
                      "test_method": "test_clear_python_bytecode_cache"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Generate CLI",
          "sequential_order": 3.0,
          "test_file": "test_generate_cli.py",
          "story_groups": [
            {
              "type": "and",
              "connector": null,
              "stories": [
                {
                  "name": "Generate Command Definitions",
                  "sequential_order": 1,
                  "connector": null,
                  "users": [
                    "Generator"
                  ],
                  "story_type": "user",
                  "acceptance_criteria": [
                    "WHEN generator runs, THEN Orchestrator walks all bot behaviors",
                    "WHEN behaviors are walked, THEN ActionDataCollector gathers action metadata for each behavior",
                    "WHEN actions are gathered, THEN generator extracts parameters from each action's context_class",
                    "WHEN metadata is collected, THEN ReplCommandVisitor generates navigate commands for all behaviors and actions",
                    "WHEN commands are generated, THEN scope commands are created for scope.type, scope.value, scope.exclude",
                    "WHEN all commands are defined, THEN generator outputs command definition file"
                  ]
                },
                {
                  "name": "Generate CLI Entry Point",
                  "sequential_order": 2,
                  "connector": "and",
                  "users": [
                    "Generator"
                  ],
                  "story_type": "user",
                  "acceptance_criteria": [
                    "WHEN generator creates PowerShell script, THEN it generates bot-specific CLI launcher (e.g., story_cli.ps1)",
                    "WHEN PowerShell script is generated, THEN it sets BOT_DIRECTORY and PYTHONPATH environment variables",
                    "WHEN script is generated, THEN it launches repl_main.py for the specific bot",
                    "WHEN REPL is launched, THEN it includes TTY detection, state display, command parsing, and execution"
                  ]
                },
                {
                  "name": "Generate Cursor Commands",
                  "sequential_order": 3,
                  "connector": "and",
                  "users": [
                    "Generator"
                  ],
                  "story_type": "user",
                  "acceptance_criteria": [
                    "WHEN generator creates CursorReplVisitor, THEN it follows existing visitor pattern",
                    "WHEN visitor generates shortcuts, THEN it creates navigate shortcuts for behaviors",
                    "WHEN visitor generates action shortcuts, THEN it creates shortcuts for behavior-action combinations",
                    "WHEN visitor generates help shortcuts, THEN it creates help and status commands"
                  ]
                },
                {
                  "name": "Generate Help Documentation",
                  "sequential_order": 4,
                  "connector": "and",
                  "users": [
                    "Generator"
                  ],
                  "story_type": "user",
                  "acceptance_criteria": [
                    "WHEN generator creates HelpReplVisitor, THEN it generates command reference with all REPL commands",
                    "WHEN help is generated, THEN it includes parameter reference with descriptions for all action parameters",
                    "WHEN examples are generated, THEN it includes scope examples with dot-notation syntax",
                    "WHEN documentation is output, THEN it creates Markdown help files in .cursor/commands/ and terminal help"
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Invoke Bot",
      "sequential_order": 2.0,
      "domain_concepts": [
        {
          "name": "Router",
          "module": "ext",
          "responsibilities": [
            {
              "name": "Match trigger patterns",
              "collaborators": [
                "Trigger Words",
                "Route"
              ]
            },
            {
              "name": "Route to MCP bot tool",
              "collaborators": [
                "Base Bot",
                "Trigger Words"
              ]
            },
            {
              "name": "Route to behavior tool",
              "collaborators": [
                "Behavior",
                "Trigger Words"
              ]
            },
            {
              "name": "Route to action tool",
              "collaborators": [
                "Action",
                "Trigger Words"
              ]
            },
            {
              "name": "Forward to behavior",
              "collaborators": [
                "Behavior",
                "Base Bot"
              ]
            },
            {
              "name": "Forward to action",
              "collaborators": [
                "Action",
                "Behavior"
              ]
            },
            {
              "name": "Forward to current behavior and action",
              "collaborators": [
                "Behavior",
                "Action",
                "Base Bot"
              ]
            }
          ]
        },
        {
          "name": "Base Bot",
          "module": "bot",
          "responsibilities": [
            {
              "name": "Executes Actions",
              "collaborators": [
                "Workflow",
                "Behavior",
                "Action"
              ]
            },
            {
              "name": "Execute behavior by name",
              "collaborators": [
                "Behavior Name",
                "BotResult"
              ]
            },
            {
              "name": "Execute current action",
              "collaborators": [
                "BotResult"
              ]
            },
            {
              "name": "Navigate and execute",
              "collaborators": [
                "Behavior Name",
                "Action Name",
                "ActionContext",
                "BotResult"
              ]
            },
            {
              "name": "Validate behavior exists",
              "collaborators": [
                "Behavior Name",
                "Boolean"
              ]
            },
            {
              "name": "Validate action exists",
              "collaborators": [
                "Behavior Name",
                "Action Name",
                "Boolean"
              ]
            },
            {
              "name": "Track activity",
              "collaborators": [
                "Behavior",
                "Action"
              ]
            },
            {
              "name": "Route to behaviors and actions",
              "collaborators": [
                "Router",
                "Trigger Words"
              ]
            },
            {
              "name": "Persist content",
              "collaborators": [
                "Content"
              ]
            },
            {
              "name": "Manage Project State",
              "collaborators": [
                "Project"
              ]
            },
            {
              "name": "Render",
              "collaborators": []
            }
          ]
        },
        {
          "name": "Workflow State",
          "module": "actions",
          "responsibilities": [
            {
              "name": "Track current action",
              "collaborators": [
                "Action"
              ]
            },
            {
              "name": "Track completed actions",
              "collaborators": [
                "Action",
                "Activity Log"
              ]
            },
            {
              "name": "Determine next action",
              "collaborators": [
                "Action",
                "Behavior"
              ]
            },
            {
              "name": "Pause workflow",
              "collaborators": [
                "Human",
                "AI Chat"
              ]
            },
            {
              "name": "Resume workflow",
              "collaborators": [
                "Human",
                "AI Chat"
              ]
            }
          ]
        },
        {
          "name": "Checkpoint",
          "module": "workflow",
          "responsibilities": [
            {
              "name": "Save workflow state",
              "collaborators": [
                "BotLangState",
                "BotLangFlowRunner"
              ]
            },
            {
              "name": "Restore workflow state",
              "collaborators": [
                "BotLangState",
                "BotLangFlowRunner"
              ]
            },
            {
              "name": "Track execution history",
              "collaborators": [
                "BotLangState"
              ]
            },
            {
              "name": "Enable resume capability",
              "collaborators": [
                "BotLangFlow",
                "BotLangFlowRunner"
              ]
            }
          ]
        },
        {
          "name": "BotMode",
          "module": "workflow",
          "responsibilities": [
            {
              "name": "Determine AI interaction",
              "collaborators": [
                "BotLangActionNode",
                "AI Client"
              ]
            },
            {
              "name": "Control pause points",
              "collaborators": [
                "BotLangActionNode",
                "Human"
              ]
            }
          ]
        },
        {
          "name": "BotLangFlow",
          "module": "workflow",
          "responsibilities": [
            {
              "name": "Execute nodes in sequence",
              "collaborators": [
                "BotLangActionNode",
                "BotLangFlowRunner"
              ]
            },
            {
              "name": "Handle conditional branching",
              "collaborators": [
                "Decision Node",
                "BotLangState"
              ]
            },
            {
              "name": "Support loops and iterations",
              "collaborators": [
                "BotLangActionNode",
                "BotLangState"
              ]
            },
            {
              "name": "Pause at interactive points",
              "collaborators": [
                "Human",
                "BotMode"
              ]
            },
            {
              "name": "Resume from checkpoint",
              "collaborators": [
                "Checkpoint",
                "BotLangFlowRunner"
              ]
            }
          ]
        },
        {
          "name": "BotLangState",
          "module": "workflow",
          "responsibilities": [
            {
              "name": "Contain story graph",
              "collaborators": [
                "Story Graph"
              ]
            },
            {
              "name": "Contain clarification data",
              "collaborators": [
                "Key Questions",
                "Evidence"
              ]
            },
            {
              "name": "Contain strategy data",
              "collaborators": [
                "Decision Criteria",
                "Assumptions"
              ]
            },
            {
              "name": "Contain context files",
              "collaborators": [
                "Context"
              ]
            },
            {
              "name": "Contain files dictionary",
              "collaborators": [
                "Source Files",
                "Test Files"
              ]
            },
            {
              "name": "Contain workspace directory",
              "collaborators": [
                "Workspace"
              ]
            },
            {
              "name": "Contain workflow execution state",
              "collaborators": [
                "Action",
                "Instructions"
              ]
            }
          ]
        },
        {
          "name": "Behavior Action State",
          "module": "actions",
          "responsibilities": [
            {
              "name": "Track current action",
              "collaborators": [
                "Action"
              ]
            },
            {
              "name": "Track completed actions",
              "collaborators": [
                "Action",
                "Activity Log"
              ]
            },
            {
              "name": "Determine next action",
              "collaborators": [
                "Action",
                "Behavior"
              ]
            },
            {
              "name": "Pause workflow",
              "collaborators": [
                "Human",
                "AI Chat"
              ]
            },
            {
              "name": "Resume workflow",
              "collaborators": [
                "Human",
                "AI Chat"
              ]
            }
          ]
        }
      ],
      "sub_epics": [
        {
          "name": "Invoke MCP",
          "sequential_order": 2.0,
          "test_file": "domain/test_navigate_and_execute_behaviors.py",
          "story_groups": [
            {
              "type": "and",
              "connector": null,
              "stories": [
                {
                  "name": "Invoke Bot Tool",
                  "sequential_order": 1,
                  "connector": "or",
                  "users": [
                    "AI Chat"
                  ],
                  "story_type": "user",
                  "test_class": "TestInvokeBotTool",
                  "acceptance_criteria": [
                    "WHEN AI Chat invokes bot tool with behavior and action parameters",
                    "THEN Tool routes to correct behavior.action method",
                    "AND Tool executes action and returns result",
                    "WHEN AI Chat invokes tool for specific behavior",
                    "THEN Tool routes to that behavior only, not other behaviors"
                  ],
                  "scenarios": [
                    {
                      "name": "Tool Invokes Behavior Action When Called",
                      "steps": "Given Bot has behavior 'shape' with action 'clarify'\nWhen AI Chat invokes tool with parameters\nThen Tool routes to test_bot.Shape.GatherContext() method",
                      "test_method": "test_tool_invokes_behavior_action_when_called"
                    },
                    {
                      "name": "Tool Routes To Correct Behavior Action Method",
                      "steps": "Given Bot has multiple behaviors with clarify action\nWhen AI Chat invokes 'test_bot_exploration_clarify'\nThen Tool routes to test_bot.Exploration.Clarify() not other behaviors",
                      "test_method": "test_tool_routes_to_correct_behavior_action_method"
                    }
                  ]
                },
                {
                  "name": "Load And Merge Behavior Action Instructions",
                  "sequential_order": 2,
                  "connector": "or",
                  "users": [
                    "Bot Behavior"
                  ],
                  "story_type": "user",
                  "test_class": "TestLoadAndMergeBehaviorActionInstructions",
                  "acceptance_criteria": [
                    "WHEN Action method is invoked",
                    "THEN Action loads instructions from base_actions and behavior-specific locations",
                    "AND Instructions are merged and returned"
                  ],
                  "scenarios": [
                    {
                      "name": "Action Loads And Merges Instructions",
                      "steps": "Given Base and behavior-specific instructions exist\nWhen Action method is invoked\nThen Instructions are loaded from both locations and merged",
                      "test_method": "test_action_loads_and_merges_instructions"
                    },
                    {
                      "name": "Action uses Instructions class to merge base and behavior instructions",
                      "steps": "Given Action with BaseActionConfig and Behavior\nWhen Action initialized\nThen Action uses Instructions class to merge instructions",
                      "test_method": "test_action_uses_instructions_class_to_merge_base_and_behavior_instructions"
                    },
                    {
                      "name": "Action uses MergedInstructions class when render instructions present",
                      "steps": "Given RenderOutputAction with render instructions\nWhen Action initialized\nThen Action uses MergedInstructions class for merging",
                      "test_method": "test_action_uses_merged_instructions_class_when_render_instructions_present"
                    }
                  ]
                },
                {
                  "name": "Forward To Current Behavior and Current Action",
                  "sequential_order": 3,
                  "connector": "or",
                  "users": [
                    "AI Chat"
                  ],
                  "story_type": "user",
                  "test_class": "TestForwardToCurrentBehaviorAndCurrentAction",
                  "acceptance_criteria": [
                    "WHEN Bot tool receives invocation",
                    "AND workflow state shows current_behavior and current_action",
                    "THEN Bot tool forwards to correct behavior and action",
                    "WHEN workflow state does NOT exist",
                    "THEN Bot tool defaults to first behavior and first action"
                  ],
                  "scenarios": [
                    {
                      "name": "Bot tool forwards to current behavior and current action",
                      "steps": "Given behavior action state shows current_behavior='discovery', current_action='build'\nWhen Bot tool receives invocation\nThen Bot tool forwards to correct behavior and action",
                      "test_method": "test_bot_tool_forwards_to_current_behavior_and_current_action"
                    },
                    {
                      "name": "Bot tool defaults to first behavior and first action when state missing",
                      "steps": "Given behavior action state does NOT exist\nWhen Bot tool receives invocation\nThen Bot tool defaults to first behavior and first action",
                      "test_method": "test_bot_tool_defaults_to_first_behavior_and_first_action_when_state_missing"
                    }
                  ]
                },
                {
                  "name": "Forward To Current Action",
                  "sequential_order": 4,
                  "connector": "or",
                  "users": [
                    "AI Chat"
                  ],
                  "story_type": "user",
                  "test_class": "TestForwardToCurrentAction",
                  "acceptance_criteria": [
                    "WHEN Behavior tool receives invocation",
                    "AND workflow state shows current_action within behavior",
                    "THEN Behavior tool forwards to current action",
                    "WHEN workflow state shows different behavior",
                    "THEN Behavior tool updates workflow to current behavior",
                    "WHEN workflow state does NOT exist",
                    "THEN Behavior tool defaults to first action"
                  ],
                  "scenarios": [
                    {
                      "name": "Behavior tool forwards to current action within behavior",
                      "steps": "Given a behavior tool for 'discovery' behavior\nAnd behavior action state shows current_action='build_knowledge'\nWhen Behavior tool receives invocation\nThen Behavior tool forwards to build_knowledge action",
                      "test_method": "test_behavior_tool_forwards_to_current_action_within_behavior"
                    },
                    {
                      "name": "Behavior tool sets behavior action state to current behavior when state shows different behavior",
                      "steps": "Given a behavior tool for 'exploration' behavior\nAnd behavior action state shows current_behavior='discovery'\nWhen Behavior tool receives invocation\nThen behavior action state updated to current_behavior='exploration'",
                      "test_method": "test_behavior_tool_sets_workflow_to_current_behavior_when_state_shows_different_behavior"
                    },
                    {
                      "name": "Behavior tool defaults to first action when state missing",
                      "steps": "Given a behavior tool for 'shape' behavior\nAnd behavior action state does NOT exist\nWhen Behavior tool receives invocation\nThen Behavior tool defaults to first action",
                      "test_method": "test_behavior_tool_defaults_to_first_action_when_state_missing"
                    },
                    {
                      "name": "Action called directly saves behavior action state",
                      "steps": "Given Bot is initialized with WORKING_AREA set\nAnd No behavior action state exists yet\nWhen Action is called directly (e.g., bot.shape.clarify())\nThen behavior_action_state.json is created with current_action\nAnd This ensures state is saved whether action is called via forward or directly",
                      "test_method": "test_action_called_directly_saves_behavior_action_state"
                    }
                  ]
                },
                {
                  "name": "Track Activity For Workspace",
                  "sequential_order": 5,
                  "connector": "or",
                  "users": [
                    "Bot Behavior"
                  ],
                  "story_type": "user",
                  "test_class": "TestTrackActivityForWorkspace",
                  "acceptance_criteria": [
                    "WHEN Activity is tracked",
                    "THEN Activity is logged to workspace area not bot area"
                  ],
                  "scenarios": [
                    {
                      "name": "Activity logged to workspace_area not bot area",
                      "steps": "Given WORKING_AREA environment variable specifies workspace_area\nAnd action 'gather_context' executes\nWhen Activity logger creates entry\nThen Activity log file is at: workspace_area/activity_log.json\nAnd Activity log is NOT at: agile_bot/bots/story_bot/activity_log.json\nAnd Activity log location matches workspace_area from WORKING_AREA environment variable",
                      "test_method": "test_activity_logged_to_workspace_area_not_bot_area"
                    },
                    {
                      "name": "Activity log contains correct entry",
                      "steps": "Given action 'gather_context' executes in behavior 'discovery'\nWhen Activity logger creates entry\nThen Activity log entry includes:\n  - action_state='test_bot.discovery.gather_context'\n  - timestamp\n  - Full path includes bot_name.behavior.action",
                      "test_method": "test_activity_log_contains_correct_entry"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Invoke Bot Directly",
          "sequential_order": 3.0,
          "domain_concepts": [
            {
              "name": "Behavior",
              "module": "bot",
              "responsibilities": [
                {
                  "name": "Perform Configured Actions",
                  "collaborators": [
                    "Actions"
                  ]
                },
                {
                  "name": "Invoke On Trigger Words",
                  "collaborators": [
                    "List"
                  ]
                },
                {
                  "name": "Inject Instructions",
                  "collaborators": [
                    "Text"
                  ]
                },
                {
                  "name": "Provide Guardrails",
                  "collaborators": [
                    "GuardRails"
                  ]
                },
                {
                  "name": "Provide Rules",
                  "collaborators": [
                    "Rule",
                    "Validation"
                  ]
                },
                {
                  "name": "Provide Content Specs",
                  "collaborators": [
                    "Content"
                  ]
                },
                {
                  "name": "Gets action by name",
                  "collaborators": [
                    "Action",
                    "String"
                  ]
                },
                {
                  "name": "Gets actions in sequence",
                  "collaborators": [
                    "List",
                    "Action"
                  ]
                }
              ]
            },
            {
              "name": "Base Action",
              "module": "actions",
              "responsibilities": [
                {
                  "name": "Inject Instructions",
                  "collaborators": [
                    "Behavior"
                  ],
                  "note": "must be overridden"
                },
                {
                  "name": "Load Relevant Content + Inject Into Instructions",
                  "collaborators": [
                    "Content"
                  ],
                  "note": "must be overridden"
                },
                {
                  "name": "Save content changes",
                  "collaborators": [
                    "Content"
                  ],
                  "note": "must be overridden"
                }
              ]
            }
          ],
          "sub_epics": [
            {
              "name": "Navigate And Execute Behaviors",
              "sequential_order": 1,
              "test_file": "domain/test_navigate_and_execute_behaviors.py",
              "story_groups": [
                {
                  "type": "and",
                  "connector": null,
                  "stories": [
                    {
                      "name": "Manage Behaviors",
                      "sequential_order": 1,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestManageBehaviors",
                      "scenarios": [
                        {
                          "name": "Behaviors current property returns current behavior",
                          "type": "happy_path",
                          "steps": [
                            "Given Behaviors collection with current behavior set",
                            "When current property accessed",
                            "Then Returns current Behavior object"
                          ],
                          "test_method": "test_behaviors_current_property_returns_current_behavior"
                        },
                        {
                          "name": "Behaviors navigate to behavior updates current behavior",
                          "type": "happy_path",
                          "steps": [
                            "Given Behaviors collection",
                            "When navigate_to('discovery') called",
                            "Then Current behavior updated to 'discovery'"
                          ],
                          "test_method": "test_behaviors_navigate_to_behavior_updates_current_behavior"
                        },
                        {
                          "name": "Behaviors close current marks behavior and action complete",
                          "type": "happy_path",
                          "steps": [
                            "Given Behaviors collection with current behavior and current action",
                            "When close_current() called",
                            "Then Current behavior marked complete and current action closed"
                          ],
                          "test_method": "test_behaviors_close_current_marks_behavior_and_action_complete"
                        },
                        {
                          "name": "Behaviors execute current executes current behavior",
                          "type": "happy_path",
                          "steps": [
                            "Given Behaviors collection with current behavior",
                            "When execute_current() called",
                            "Then Current behavior's execute() method called"
                          ],
                          "test_method": "test_behaviors_execute_current_executes_current_behavior"
                        },
                        {
                          "name": "Behavior can be found by name when it exists.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_find_behavior_by_name"
                        },
                        {
                          "name": "Finding behavior by name returns None when behavior doesn't exist.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_find_behavior_returns_none_when_not_found"
                        },
                        {
                          "name": "All behaviors can be iterated.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_iterate_all_behaviors"
                        },
                        {
                          "name": "Can check if a behavior exists.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_check_behavior_exists"
                        },
                        {
                          "name": "Action can be found by name when it exists.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_find_action_by_name"
                        },
                        {
                          "name": "Finding action by name returns None when action doesn't exist.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_find_action_returns_none_when_not_found"
                        },
                        {
                          "name": "Action can be found by order when it exists.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_find_action_by_order"
                        },
                        {
                          "name": "All actions can be iterated.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_iterate_all_actions"
                        }
                      ]
                    },
                    {
                      "name": "Manage Behavior Action State",
                      "sequential_order": 2,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestManageBehaviorActionState",
                      "scenarios": [
                        {
                          "name": "Current behavior state is persisted to behavior_action_state.json.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_save_current_behavior_state"
                        },
                        {
                          "name": "Current behavior state is restored from behavior_action_state.json.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_load_behavior_state_from_file"
                        },
                        {
                          "name": "Current action state is persisted to behavior_action_state.json.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_save_current_action_state"
                        },
                        {
                          "name": "Current action state is restored from behavior_action_state.json.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_load_action_state_from_file"
                        },
                        {
                          "name": "Closing current action marks it complete and moves to next.",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_close_current_action"
                        }
                      ]
                    },
                    {
                      "name": "Navigate To Behavior Action And Execute",
                      "sequential_order": 3,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestNavigateToBehaviorActionAndExecute",
                      "scenarios": [
                        {
                          "name": "Execute behavior with action parameter",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot has behavior 'shape' with action 'clarify'",
                            "When Bot.execute_behavior('shape', action='clarify') is called",
                            "Then Action executes and returns BotResult"
                          ],
                          "test_method": "test_execute_behavior_with_action_parameter"
                        },
                        {
                          "name": "Execute behavior without action parameter forwards to current action",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot has behavior 'shape' and workflow state shows current_action='strategy'",
                            "When Bot.execute_behavior('shape') is called (no action parameter)",
                            "Then Forwards to current action (strategy)"
                          ],
                          "test_method": "test_execute_behavior_without_action_forwards_to_current"
                        },
                        {
                          "name": "Execute behavior executes directly when no workflow state exists",
                          "type": "happy_path",
                          "steps": [
                            "Given No behavior_action_state.json exists",
                            "When Bot.execute_behavior('shape') is called",
                            "Then Executes directly (entry workflow handling was in removed wrapper)"
                          ],
                          "test_method": "test_execute_behavior_handles_entry_workflow_when_no_state"
                        },
                        {
                          "name": "Behavior action order determines next action from current_action",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_behavior_action_order_determines_next_action_from_current_action"
                        },
                        {
                          "name": "No completed actions yet",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_behavior_action_order_starts_at_first_action_when_no_completed_actions"
                        },
                        {
                          "name": "Behavior action order falls back to completed_actions when current_action is missing",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_behavior_action_order_falls_back_to_completed_actions_when_current_action_missing"
                        },
                        {
                          "name": "No behavior_action_state.json file exists (fresh start)",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_behavior_action_order_starts_at_first_action_when_no_state_file_exists"
                        },
                        {
                          "name": "Behavior loads workflow order from behaviors/{behavior_name}/behavior.json",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_behavior_loads_workflow_order_from_behavior_specific_actions_workflow"
                        },
                        {
                          "name": "Different behaviors can have different action orders",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_different_behaviors_can_have_different_action_orders"
                        },
                        {
                          "name": "Workflow transitions are built correctly from behavior.json",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_workflow_transitions_built_correctly_from_actions_workflow_json"
                        }
                      ]
                    },
                    {
                      "name": "Navigate Sequentially",
                      "sequential_order": 4,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestNavigateSequentially",
                      "scenarios": [
                        {
                          "name": "bot.next() moves to next action",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot is at clarify action",
                            "When bot.next() is called",
                            "Then Bot moves to strategy (next action in workflow)"
                          ],
                          "test_method": "test_bot_next_navigates_to_next_action_in_workflow"
                        },
                        {
                          "name": "bot.next() progresses through workflow sequence",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot is at first action",
                            "When bot.next() is called multiple times",
                            "Then Bot progresses through clarify -> strategy -> build -> validate -> render"
                          ],
                          "test_method": "test_bot_next_progresses_through_entire_workflow"
                        },
                        {
                          "name": "bot.next() at final action advances to next behavior",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot is at render (final action of shape)",
                            "When bot.next() is called",
                            "Then Bot advances to next behavior (discovery) first action (clarify)"
                          ],
                          "test_method": "test_bot_next_at_final_action_advances_to_next_behavior"
                        },
                        {
                          "name": "bot.current() returns current action instructions",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot is at a specific action",
                            "When bot.current() is called",
                            "Then Current action instructions object is returned"
                          ],
                          "test_method": "test_bot_current_returns_current_action_instructions"
                        },
                        {
                          "name": "bot.next() respects behavior.json workflow sequence",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot is at strategy (second action)",
                            "When bot.next() is called",
                            "Then Bot moves to build (third action), following behavior.json order"
                          ],
                          "test_method": "test_bot_next_respects_workflow_sequence"
                        },
                        {
                          "name": "bot.next() with no behavior selected starts workflow",
                          "type": "happy_path",
                          "steps": [
                            "Given No behavior is selected",
                            "When bot.next() is called",
                            "Then Bot starts at first behavior (shape), first action (clarify)",
                            "Then NOTE: Currently bot.next() returns an error when no behavior is selected.",
                            "Then This test documents the DESIRED behavior - bot should be smart enough",
                            "Then to start at the beginning of the workflow automatically."
                          ],
                          "test_method": "test_bot_next_with_no_behavior_starts_at_first_behavior"
                        },
                        {
                          "name": "Can navigate to a specific behavior",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot exists with multiple behaviors",
                            "When behaviors.navigate_to('discovery') called",
                            "Then Current behavior is set to discovery"
                          ],
                          "test_method": "test_navigate_to_behavior"
                        },
                        {
                          "name": "Next behavior in sequence can be retrieved",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot is at scenarios behavior",
                            "When behaviors.next() called",
                            "Then Returns next behavior (tests) with complete structure"
                          ],
                          "test_method": "test_get_next_behavior"
                        },
                        {
                          "name": "Getting next behavior returns None when at last behavior",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot is at last behavior in list",
                            "When behaviors.next() called",
                            "Then Returns None"
                          ],
                          "test_method": "test_get_next_behavior_returns_none_at_end"
                        },
                        {
                          "name": "Can navigate to a specific action",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot is at a behavior with multiple actions",
                            "When actions.navigate_to('build') called",
                            "Then Current action is set to build"
                          ],
                          "test_method": "test_navigate_to_action"
                        },
                        {
                          "name": "Next action in sequence can be retrieved",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot is at clarify action (first action)",
                            "When actions.next() called",
                            "Then Returns strategy action (second action)"
                          ],
                          "test_method": "test_get_next_action"
                        },
                        {
                          "name": "Getting next action returns None when at last action",
                          "type": "happy_path",
                          "steps": [
                            "Given Bot is at last action in behavior",
                            "When actions.next() called",
                            "Then Returns None"
                          ],
                          "test_method": "test_get_next_action_returns_none_at_end"
                        }
                      ]
                    },
                    {
                      "name": "Inject Context Into Instructions",
                      "sequential_order": 5,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestInjectContextIntoInstructions",
                      "scenarios": [
                        {
                          "name": "Action Loads Context Data Into Instructions",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_action_loads_context_data_into_instructions"
                        },
                        {
                          "name": "Next behavior reminder is NOT injected when action is not final",
                          "type": "happy_path",
                          "steps": [
                            "Given validate is NOT the final action (render comes after)",
                            "When validate action executes",
                            "Then base_instructions do NOT include next behavior reminder",
                            "Then And bot_config.json defines behavior sequence"
                          ],
                          "test_method": "test_next_behavior_reminder_not_injected_when_not_final_action"
                        },
                        {
                          "name": "Next behavior reminder is NOT injected when current behavior is last in sequence",
                          "type": "happy_path",
                          "steps": [
                            "Given discovery is the last behavior in bot_config.json",
                            "When render action executes",
                            "Then base_instructions do NOT include next behavior reminder",
                            "Then And render is the final action"
                          ],
                          "test_method": "test_next_behavior_reminder_not_injected_when_no_next_behavior"
                        }
                      ]
                    },
                    {
                      "name": "Track Activity For Workspace",
                      "sequential_order": 6,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestTrackActivityForWorkspace",
                      "scenarios": [
                        {
                          "name": "Activity logged to workspace_area not bot area",
                          "type": "happy_path",
                          "steps": [
                            "Given WORKING_AREA environment variable specifies workspace_area",
                            "When Activity logger creates entry",
                            "Then Activity log file is at: workspace_area/activity_log.json",
                            "Then And action 'gather_context' executes",
                            "Then And Activity log is NOT at: agile_bot/bots/story_bot/activity_log.json",
                            "Then And Activity log location matches workspace_area from WORKING_AREA environment variable"
                          ],
                          "test_method": "test_activity_logged_to_workspace_area_not_bot_area"
                        },
                        {
                          "name": "Activity log contains correct entry",
                          "type": "happy_path",
                          "steps": [
                            "Given action 'gather_context' executes in behavior 'discovery'",
                            "When Activity logger creates entry",
                            "Then Activity log entry includes:",
                            "Then - action_state='story_bot.discovery.gather_context'",
                            "Then - timestamp",
                            "Then - Full path includes bot_name.behavior.action"
                          ],
                          "test_method": "test_activity_log_contains_correct_entry"
                        }
                      ]
                    },
                    {
                      "name": "Execute End To End Workflow",
                      "sequential_order": 999,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestExecuteEndToEndWorkflow",
                      "scenarios": [
                        {
                          "name": "Complete Workflow Progresses Through Single Behavior",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_complete_workflow_progresses_through_single_behavior"
                        },
                        {
                          "name": "Complete Workflow Progresses Across Multiple Behaviors",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_complete_workflow_progresses_across_multiple_behaviors"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "Manage Story Graph",
              "sequential_order": 4,
              "sub_epics": [
                {
                  "name": "Manage Story Scope",
                  "sequential_order": 4,
                  "test_file": "domain/test_manage_scope.py",
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Create Scope",
                          "sequential_order": 999,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestCreateScope",
                          "scenarios": [
                            {
                              "name": "Scope created with different parameter combinations",
                              "type": "happy_path",
                              "steps": [
                                "Given Parameters dict with scope configuration",
                                "When ActionScope instantiated with parameters",
                                "Then ActionScope scope property returns expected configuration"
                              ],
                              "test_method": "test_scope_created_with_different_parameter_combinations"
                            },
                            {
                              "name": "Scope defaults to 'all' when no parameters provided",
                              "type": "happy_path",
                              "steps": [
                                "Given Empty parameters dict",
                                "When ActionScope instantiated",
                                "Then Scope defaults to 'all'"
                              ],
                              "test_method": "test_scope_defaults_to_all_when_no_parameters"
                            }
                          ]
                        },
                        {
                          "name": "Filter Scope By Stories",
                          "sequential_order": 999,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestFilterScopeByStories",
                          "scenarios": [
                            {
                              "name": "Filter returns all when scope is all",
                              "type": "happy_path",
                              "steps": [
                                "Given Story graph with multiple epics and increments",
                                "When Filter with scope type 'all'",
                                "Then Story graph contains all epics and increments"
                              ],
                              "test_method": "test_filter_returns_all_when_scope_is_all"
                            },
                            {
                              "name": "Filter by single story name returns matching story",
                              "type": "happy_path",
                              "steps": [
                                "Given Story graph with multiple stories",
                                "When Filter with single story name",
                                "Then Story graph contains only matching story and its parent epic"
                              ],
                              "test_method": "test_filter_by_single_story_name_returns_matching_story"
                            },
                            {
                              "name": "Filter by single epic name returns matching epic",
                              "type": "happy_path",
                              "steps": [
                                "Given Story graph with multiple epics",
                                "When Filter with single epic name",
                                "Then Story graph contains only matching epic and its increments"
                              ],
                              "test_method": "test_filter_by_single_epic_name_returns_matching_epic"
                            },
                            {
                              "name": "Filter by increment priorities returns matching increments",
                              "type": "happy_path",
                              "steps": [
                                "Given Story graph with increments having different priorities",
                                "When Filter with increment priorities",
                                "Then Story graph contains only matching increments and their stories"
                              ],
                              "test_method": "test_filter_by_increment_priorities_returns_matching_increments"
                            },
                            {
                              "name": "Filter by increment names returns matching increments",
                              "type": "happy_path",
                              "steps": [
                                "Given Story graph with increments having different names",
                                "When Filter with increment names",
                                "Then Story graph contains only matching increments and their stories"
                              ],
                              "test_method": "test_filter_by_increment_names_returns_matching_increments"
                            },
                            {
                              "name": "Filter returns parent epic when child story matches",
                              "type": "happy_path",
                              "steps": [
                                "Given Story graph with epic containing story",
                                "When Scope set to story name",
                                "Then Story and parent epic are both returned"
                              ],
                              "test_method": "test_filter_returns_parent_epic_when_child_story_matches"
                            }
                          ]
                        },
                        {
                          "name": "Filter Scope By Files",
                          "sequential_order": 999,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestFilterScopeByFiles",
                          "scenarios": [
                            {
                              "name": "File Filter Includes Matching Files",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_file_filter_includes_matching_files"
                            },
                            {
                              "name": "FileFilter excludes files matching exclude patterns",
                              "type": "happy_path",
                              "steps": [
                                "Given A list of files and a FileFilter with exclude patterns",
                                "When filter_files() is called",
                                "Then Files matching exclude patterns are removed"
                              ],
                              "test_method": "test_file_filter_excludes_matching_files"
                            },
                            {
                              "name": "FileFilter combines include and exclude patterns",
                              "type": "happy_path",
                              "steps": [
                                "Given A list of files and a FileFilter with both include and exclude patterns",
                                "When filter_files() is called",
                                "Then Files must match include AND not match exclude"
                              ],
                              "test_method": "test_file_filter_combines_include_and_exclude"
                            },
                            {
                              "name": "FileFilter returns all files when no patterns specified",
                              "type": "happy_path",
                              "steps": [
                                "Given A list of files and a FileFilter with no patterns",
                                "When filter_files() is called",
                                "Then All files are returned"
                              ],
                              "test_method": "test_file_filter_returns_all_when_no_patterns"
                            },
                            {
                              "name": "FileFilter handles specific file paths (not just globs)",
                              "type": "happy_path",
                              "steps": [
                                "Given A list of files and a FileFilter with specific file path",
                                "When filter_files() is called",
                                "Then Only the specific file is included"
                              ],
                              "test_method": "test_file_filter_handles_specific_file_paths"
                            },
                            {
                              "name": "File discovery and filtering work together",
                              "type": "happy_path",
                              "steps": [
                                "Given A FileDiscovery component and a FileFilter",
                                "When Files are discovered and then filtered",
                                "Then Only matching files are returned",
                                "Then This test verifies the integration between FileDiscovery and FileFilter,",
                                "Then which was the core fix for the validation scope bug."
                              ],
                              "test_method": "test_file_discovery_and_filtering_integration"
                            }
                          ]
                        },
                        {
                          "name": "Persist Scope",
                          "sequential_order": 999,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestPersistScope",
                          "scenarios": [
                            {
                              "name": "Scope persists across bot invocations",
                              "type": "happy_path",
                              "steps": [
                                "Given Bot with scope set",
                                "When Bot is reloaded",
                                "Then Scope is restored from workflow state"
                              ],
                              "test_method": "test_scope_persists_across_bot_invocations"
                            },
                            {
                              "name": "Scope persists after action execution",
                              "type": "happy_path",
                              "steps": [
                                "Given Bot with scope set",
                                "When Action executes and completes",
                                "Then Scope remains active for next action"
                              ],
                              "test_method": "test_scope_persists_after_action_execution"
                            }
                          ]
                        },
                        {
                          "name": "Clear Scope",
                          "sequential_order": 999,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestClearScope",
                          "scenarios": [
                            {
                              "name": "Clear scope with show_all parameter",
                              "type": "happy_path",
                              "steps": [
                                "Given Bot with scope set",
                                "When Scope cleared with show_all=True",
                                "Then Scope is cleared and all content is shown"
                              ],
                              "test_method": "test_clear_scope_with_show_all_parameter"
                            },
                            {
                              "name": "Clear scope without show_all parameter",
                              "type": "happy_path",
                              "steps": [
                                "Given Bot with scope set",
                                "When Scope cleared without show_all parameter",
                                "Then Scope is cleared"
                              ],
                              "test_method": "test_clear_scope_without_show_all_parameter"
                            },
                            {
                              "name": "Actions after clear process all content",
                              "type": "happy_path",
                              "steps": [
                                "Given Bot had scope set, then cleared",
                                "When Action executes",
                                "Then Action processes all content without filtering"
                              ],
                              "test_method": "test_actions_after_clear_process_all_content"
                            }
                          ]
                        },
                        {
                          "name": "Execute Actions With Scope",
                          "sequential_order": 999,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestExecuteActionsWithScope",
                          "scenarios": [
                            {
                              "name": "Build action includes scope in instructions",
                              "type": "happy_path",
                              "steps": [
                                "Given Build action with story scope",
                                "When Instructions are retrieved",
                                "Then Instructions contain scope configuration"
                              ],
                              "test_method": "test_build_action_includes_scope_in_instructions"
                            },
                            {
                              "name": "Validate action accepts scope context",
                              "type": "happy_path",
                              "steps": [
                                "Given Validate action with story scope and story graph file",
                                "When Instructions are retrieved",
                                "Then No errors occur and scope is processed"
                              ],
                              "test_method": "test_validate_action_accepts_scope_context"
                            },
                            {
                              "name": "Render action accepts scope context",
                              "type": "happy_path",
                              "steps": [
                                "Given Render action with story scope",
                                "When Instructions are retrieved",
                                "Then No errors occur (render supports ScopeActionContext)"
                              ],
                              "test_method": "test_render_action_accepts_scope_context"
                            },
                            {
                              "name": "Clarify action does not support scope",
                              "type": "happy_path",
                              "steps": [
                                "Given Clarify action",
                                "When Context is checked",
                                "Then Uses ClarifyActionContext (not ScopeActionContext)"
                              ],
                              "test_method": "test_clarify_action_does_not_support_scope"
                            },
                            {
                              "name": "Strategy action does not support scope",
                              "type": "happy_path",
                              "steps": [
                                "Given Strategy action",
                                "When Context is checked",
                                "Then Uses StrategyActionContext (not ScopeActionContext)"
                              ],
                              "test_method": "test_strategy_action_does_not_support_scope"
                            }
                          ]
                        },
                        {
                          "name": "Navigate Story Graph",
                          "sequential_order": 999,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestNavigateStoryGraph",
                          "scenarios": [
                            {
                              "name": "Story Map Loads Epics",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_story_map_loads_epics"
                            },
                            {
                              "name": "Epic Has Sub Epics",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_epic_has_sub_epics"
                            },
                            {
                              "name": "Sub Epic Has Story Groups",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_sub_epic_has_story_groups"
                            },
                            {
                              "name": "Story Group Has Stories",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_story_group_has_stories"
                            },
                            {
                              "name": "Story Has Properties",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_story_has_properties"
                            },
                            {
                              "name": "Story Has Scenarios",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_story_has_scenarios"
                            },
                            {
                              "name": "Scenario Has Properties",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_scenario_has_properties"
                            },
                            {
                              "name": "Scenario Default Test Method",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_scenario_default_test_method"
                            },
                            {
                              "name": "Story Has Scenario Outlines",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_story_has_scenario_outlines"
                            },
                            {
                              "name": "Scenario Outline Has Examples",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_scenario_outline_has_examples"
                            },
                            {
                              "name": "Story Default Test Class",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_story_default_test_class"
                            },
                            {
                              "name": "Story Map Walk Traverses All Nodes",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_story_map_walk_traverses_all_nodes"
                            },
                            {
                              "name": "Map Location For Epic",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_map_location_for_epic"
                            },
                            {
                              "name": "Map Location For Sub Epic",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_map_location_for_sub_epic"
                            },
                            {
                              "name": "Map Location For Story",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_map_location_for_story"
                            },
                            {
                              "name": "Scenario Map Location",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_scenario_map_location"
                            },
                            {
                              "name": "Scenario Outline Map Location",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_scenario_outline_map_location"
                            },
                            {
                              "name": "From Bot Loads Story Graph",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_from_bot_loads_story_graph"
                            },
                            {
                              "name": "From Bot With Path",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_from_bot_with_path"
                            },
                            {
                              "name": "Scenario Map Location",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_scenario_map_location_duplicate"
                            },
                            {
                              "name": "Scenario Outline Map Location",
                              "type": "happy_path",
                              "steps": [],
                              "test_method": "test_scenario_outline_map_location_duplicate"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Manage File Scope",
                  "sequential_order": 2,
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Filter File Scope",
                          "sequential_order": 1,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestFilterFileScope",
                          "scenarios": []
                        },
                        {
                          "name": "Get All Files For Behavior",
                          "sequential_order": 2,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestGetAllFilesForBehavior",
                          "scenarios": []
                        },
                        {
                          "name": "Add Filter Part To File Scope",
                          "sequential_order": 3,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestAddFilterPartToFileScope",
                          "scenarios": []
                        },
                        {
                          "name": "Remove Filter Part From File Scope",
                          "sequential_order": 4,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestRemoveFilterPartFromFileScope",
                          "scenarios": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Edit Story Graph",
                  "sequential_order": 3,
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Add Child Story Node To Parent",
                          "sequential_order": 1,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestAddChildStoryNodeToParent",
                          "scenarios": []
                        },
                        {
                          "name": "Delete Story Node From Parent",
                          "sequential_order": 2,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestDeleteStoryNodeFromParent",
                          "scenarios": []
                        },
                        {
                          "name": "Update Story Node name",
                          "sequential_order": 3,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestUpdateStoryNodename",
                          "scenarios": []
                        },
                        {
                          "name": "Move Story Node",
                          "sequential_order": 4,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestMoveStoryNode",
                          "scenarios": []
                        },
                        {
                          "name": "Submit Action Scoped To Story Scope",
                          "sequential_order": 5,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestSubmitActionScopedToStoryScope",
                          "scenarios": []
                        },
                        {
                          "name": "Update Story Graph Changes",
                          "sequential_order": 6,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestUpdateStoryGraphChanges",
                          "scenarios": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Edit Increments",
                  "sequential_order": 4,
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Add Increment",
                          "sequential_order": 1,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestAddIncrement",
                          "scenarios": []
                        },
                        {
                          "name": "Delete Increment",
                          "sequential_order": 2,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestDeleteIncrement",
                          "scenarios": []
                        },
                        {
                          "name": "Move Story to Increment",
                          "sequential_order": 3,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestMoveStorytoIncrement",
                          "scenarios": []
                        },
                        {
                          "name": "Show All Increment Scope",
                          "sequential_order": 4,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestShowAllIncrementScope",
                          "scenarios": []
                        },
                        {
                          "name": "Submit Action Scoped To Increment",
                          "sequential_order": 5,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestSubmitActionScopedToIncrement",
                          "scenarios": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "Perform Action",
              "sequential_order": 5,
              "test_file": "domain/test_perform_action.py",
              "domain_concepts": [
                {
                  "name": "GatherContextAction",
                  "module": "actions.clarify",
                  "responsibilities": [
                    {
                      "name": "Inject gather context instructions",
                      "collaborators": [
                        "Behavior",
                        "Guardrails",
                        "Required Clarifications"
                      ]
                    },
                    {
                      "name": "Inject questions and evidence",
                      "collaborators": [
                        "Behavior",
                        "Guardrails",
                        "Key Questions",
                        "Evidence"
                      ]
                    }
                  ]
                },
                {
                  "name": "Guardrails",
                  "module": "actions",
                  "responsibilities": [
                    {
                      "name": "Provide required context",
                      "collaborators": [
                        "Key Questions",
                        "Evidence"
                      ]
                    },
                    {
                      "name": "Guide planning decisions",
                      "collaborators": [
                        "Decision Criteria",
                        "Assumptions"
                      ]
                    },
                    {
                      "name": "Define recommended human activity",
                      "collaborators": [
                        "Human",
                        "Instructions"
                      ]
                    }
                  ]
                },
                {
                  "name": "PlanningAction",
                  "module": "actions.strategy",
                  "responsibilities": [
                    {
                      "name": "Inject planning instructions",
                      "collaborators": [
                        "Behavior",
                        "Guardrails",
                        "Planning"
                      ]
                    },
                    {
                      "name": "Inject decision criteria and assumptions",
                      "collaborators": [
                        "Behavior",
                        "Guardrails",
                        "Decision Criteria",
                        "Assumptions",
                        "Recommended Human Activity"
                      ]
                    }
                  ]
                },
                {
                  "name": "Guardrails",
                  "module": "actions",
                  "responsibilities": [
                    {
                      "name": "Provide required context",
                      "collaborators": [
                        "Key Questions",
                        "Evidence"
                      ]
                    },
                    {
                      "name": "Guide planning decisions",
                      "collaborators": [
                        "Decision Criteria",
                        "Assumptions"
                      ]
                    },
                    {
                      "name": "Define recommended human activity",
                      "collaborators": [
                        "Human",
                        "Instructions"
                      ]
                    }
                  ]
                },
                {
                  "name": "BuildKnowledgeAction",
                  "module": "actions.build",
                  "responsibilities": [
                    {
                      "name": "Inject knowledge graph template",
                      "collaborators": [
                        "Behavior",
                        "Content",
                        "Knowledge Graph Spec",
                        "Knowledge Graph"
                      ]
                    },
                    {
                      "name": "Inject builder instructions",
                      "collaborators": [
                        "Behavior",
                        "Content",
                        "Build Instructions"
                      ]
                    },
                    {
                      "name": "Save Knowledge graph",
                      "collaborators": [
                        "Behavior",
                        "Content",
                        "Knowledge Graph"
                      ]
                    }
                  ]
                },
                {
                  "name": "Content",
                  "module": "actions",
                  "responsibilities": [
                    {
                      "name": "Render outputs",
                      "collaborators": [
                        "Template",
                        "Renderer",
                        "Render Spec"
                      ]
                    },
                    {
                      "name": "Synchronize formats",
                      "collaborators": [
                        "Synchronizer",
                        "Extractor",
                        "Synchronizer Spec"
                      ]
                    },
                    {
                      "name": "Save knowledge graph",
                      "collaborators": [
                        "Knowledge Graph"
                      ]
                    },
                    {
                      "name": "Load rendered content",
                      "collaborators": [
                        "na"
                      ]
                    },
                    {
                      "name": "Present rendered content",
                      "collaborators": [
                        "na"
                      ]
                    }
                  ]
                },
                {
                  "name": "RenderOutputAction",
                  "module": "actions.render",
                  "responsibilities": [
                    {
                      "name": "Inject render output instructions",
                      "collaborators": [
                        "Behavior",
                        "Content",
                        "Render Spec",
                        "Renderer"
                      ]
                    },
                    {
                      "name": "Inject templates",
                      "collaborators": [
                        "Behavior",
                        "Content",
                        "Render Spec",
                        "Template"
                      ]
                    },
                    {
                      "name": "Inject transformers",
                      "collaborators": [
                        "Behavior",
                        "Content",
                        "Transformer"
                      ]
                    },
                    {
                      "name": "Load + inject structured content",
                      "collaborators": [
                        "Behavior",
                        "Content",
                        "Knowledge Graph"
                      ]
                    }
                  ]
                },
                {
                  "name": "Renderer",
                  "module": "actions.render",
                  "responsibilities": [
                    {
                      "name": "Render complex output",
                      "collaborators": [
                        "Template",
                        "Knowledge Graph",
                        "Transformer"
                      ]
                    },
                    {
                      "name": "Render outputs using components in context",
                      "collaborators": [
                        "AI Chat",
                        "Template",
                        "Content"
                      ]
                    }
                  ]
                },
                {
                  "name": "Template",
                  "module": "actions.render",
                  "responsibilities": [
                    {
                      "name": "Define output structure",
                      "collaborators": [
                        "Placeholder"
                      ]
                    },
                    {
                      "name": "Transform content",
                      "collaborators": [
                        "Transformer",
                        "Content"
                      ]
                    },
                    {
                      "name": "Load template",
                      "collaborators": [
                        "Behavior",
                        "Content"
                      ]
                    }
                  ]
                },
                {
                  "name": "Content",
                  "module": "actions",
                  "responsibilities": [
                    {
                      "name": "Render outputs",
                      "collaborators": [
                        "Template",
                        "Renderer",
                        "Render Spec"
                      ]
                    },
                    {
                      "name": "Synchronize formats",
                      "collaborators": [
                        "Synchronizer",
                        "Extractor",
                        "Synchronizer Spec"
                      ]
                    },
                    {
                      "name": "Save knowledge graph",
                      "collaborators": [
                        "Knowledge Graph"
                      ]
                    },
                    {
                      "name": "Load rendered content",
                      "collaborators": [
                        "na"
                      ]
                    },
                    {
                      "name": "Present rendered content",
                      "collaborators": [
                        "na"
                      ]
                    }
                  ]
                },
                {
                  "name": "ValidateRulesAction",
                  "module": "actions.rules",
                  "responsibilities": [
                    {
                      "name": "Inject common bot rules",
                      "collaborators": [
                        "Base Bot",
                        "Rules",
                        "Common Rules"
                      ]
                    },
                    {
                      "name": "Inject behavior specific rules",
                      "collaborators": [
                        "Behavior",
                        "Rules",
                        "Behavior Rules"
                      ]
                    },
                    {
                      "name": "Load + inject content for validation",
                      "collaborators": [
                        "Behavior",
                        "Content",
                        "Knowledge Graph",
                        "Rendered Outputs"
                      ]
                    }
                  ]
                },
                {
                  "name": "Rule",
                  "module": "actions.rules",
                  "responsibilities": [
                    {
                      "name": "Validate content",
                      "collaborators": [
                        "Knowledge Graph",
                        "Violations"
                      ]
                    },
                    {
                      "name": "Find behavior specific rules from context",
                      "collaborators": [
                        "Behavior"
                      ]
                    },
                    {
                      "name": "Find common bot rules from context",
                      "collaborators": [
                        "Base Bot"
                      ]
                    },
                    {
                      "name": "Load + inject diagnostics results",
                      "collaborators": [
                        "AI Chat",
                        "Violations",
                        "Corrections"
                      ]
                    },
                    {
                      "name": "Suggest corrections",
                      "collaborators": [
                        "Violations",
                        "Suggestions",
                        "Fixes"
                      ]
                    },
                    {
                      "name": "Provide examples - Do",
                      "collaborators": [
                        "Example",
                        "Description"
                      ]
                    },
                    {
                      "name": "Provide examples - Dont",
                      "collaborators": [
                        "Example",
                        "Description"
                      ]
                    },
                    {
                      "name": "Specialized examples",
                      "collaborators": [
                        "Language",
                        "Framework",
                        "Pattern"
                      ]
                    }
                  ]
                },
                {
                  "name": "CorrectBotAction",
                  "module": "actions.validate",
                  "responsibilities": [
                    {
                      "name": "Inject correct bot instructions",
                      "collaborators": [
                        "Behavior",
                        "Correct Bot Instructions"
                      ]
                    },
                    {
                      "name": "Load + inject diagnostics results",
                      "collaborators": [
                        "Content",
                        "Diagnostic Report",
                        "Violations",
                        "Suggestions"
                      ]
                    }
                  ]
                }
              ],
              "story_groups": [
                {
                  "type": "and",
                  "connector": null,
                  "stories": [
                    {
                      "name": "Build Story Graph",
                      "sequential_order": 999,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestBuildStoryGraph",
                      "scenarios": [
                        {
                          "name": "Action Injects Story Graph Template",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with shape behavior (has story graph templates)",
                            "When Action injects story graph template",
                            "Then Instructions contain template_path from existing templates"
                          ],
                          "test_method": "test_action_injects_story_graph_template"
                        },
                        {
                          "name": "Action Loads And Merges Instructions",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with shape behavior (has story graph templates)",
                            "When Action injects story graph and instructions",
                            "Then Instructions contain all BuildStoryGraphAction-specific fields"
                          ],
                          "test_method": "test_action_loads_and_merges_instructions"
                        },
                        {
                          "name": "All Template Variables Are Replaced In Instructions",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with shape behavior (has story graph templates)",
                            "When Action injects all template variables",
                            "Then Instructions contain all required BuildStoryGraphAction fields"
                          ],
                          "test_method": "test_all_template_variables_are_replaced_in_instructions"
                        },
                        {
                          "name": "Prioritization behavior updates existing story-graph.json",
                          "type": "happy_path",
                          "steps": [
                            "Given Production prioritization behavior with increments templates",
                            "When Action injects story graph template for increments",
                            "Then Instructions use production template (story_graph_increments.json) that updates existing file",
                            "Then And Existing story-graph.json in workspace"
                          ],
                          "test_method": "test_behavior_updates_existing_story_graph_json"
                        }
                      ]
                    },
                    {
                      "name": "Clarify Requirements",
                      "sequential_order": 999,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestClarifyRequirements",
                      "scenarios": [
                        {
                          "name": "Action injects questions and evidence from production guardrails",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with shape behavior (has guardrails)",
                            "When Action injects guardrails",
                            "Then Instructions contain questions and evidence from production files"
                          ],
                          "test_method": "test_action_injects_questions_and_evidence"
                        },
                        {
                          "name": "Save clarification data when parameters are provided",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot clarify action",
                            "When do_execute is called with key_questions_answered and evidence_provided",
                            "Then clarification.json file is created in docs/stories/ folder",
                            "Then And file contains behavior section with key_questions and evidence"
                          ],
                          "test_method": "test_save_clarification_data_when_parameters_provided"
                        },
                        {
                          "name": "Preserve existing clarification data when saving",
                          "type": "happy_path",
                          "steps": [
                            "Given clarification.json already exists with data for 'discovery' behavior",
                            "When do_execute is called with parameters",
                            "Then clarification.json contains both 'discovery' and 'shape' sections",
                            "Then And Production story_bot clarify action for 'shape' behavior",
                            "Then And existing 'discovery' data is preserved"
                          ],
                          "test_method": "test_preserve_existing_clarification_data_when_saving"
                        },
                        {
                          "name": "Skip saving when no clarification parameters are provided",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot clarify action",
                            "When do_execute is called with empty parameters",
                            "Then clarification.json file is not created"
                          ],
                          "test_method": "test_skip_saving_when_no_clarification_parameters_provided"
                        },
                        {
                          "name": "Guardrails loads required context from workspace",
                          "type": "happy_path",
                          "steps": [
                            "Given Workspace with guardrails files (questions and evidence)",
                            "When Behavior loads guardrails",
                            "Then Questions and evidence are loaded correctly"
                          ],
                          "test_method": "test_guardrails_loads_required_context_from_workspace"
                        },
                        {
                          "name": "Guardrails loads strategy assumptions from workspace",
                          "type": "happy_path",
                          "steps": [
                            "Given Workspace with strategy guardrails files",
                            "When Behavior loads guardrails",
                            "Then Strategy assumptions are loaded correctly"
                          ],
                          "test_method": "test_guardrails_loads_strategy_assumptions_from_workspace"
                        }
                      ]
                    },
                    {
                      "name": "Validate Rules",
                      "sequential_order": 999,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestValidateRules",
                      "scenarios": [
                        {
                          "name": "Story graph validation includes rule content in instructions",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with shape behavior (validates story graph)",
                            "When Validate action executes",
                            "Then Instructions contain rule descriptions, DO/DON'T sections, and priorities from rule files",
                            "Then And Story graph file exists"
                          ],
                          "test_method": "test_story_graph_rules_formatted_in_instructions"
                        },
                        {
                          "name": "File validation includes rule content in instructions",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with code behavior (validates files)",
                            "When Validate action executes",
                            "Then Instructions contain rule descriptions, DO/DON'T sections, and priorities from rule files",
                            "Then And Story graph file exists"
                          ],
                          "test_method": "test_file_rules_formatted_in_instructions"
                        },
                        {
                          "name": "Story graph scanners receive scoped story_graph data",
                          "type": "happy_path",
                          "steps": [
                            "Given Story graph with multiple epics (\"Build Knowledge\", \"Epic B\")",
                            "When Validate action executes with scope",
                            "Then Scanner receives filtered story graph (only \"Build Knowledge\" epic)",
                            "Then And Scope filtered to \"Build Knowledge\" epic",
                            "Then And Production story_bot with shape behavior",
                            "Then And Scanner executes successfully",
                            "Then And Instructions contain \"Build Knowledge\" in scope description"
                          ],
                          "test_method": "test_story_graph_scanner_receives_story_graph_data"
                        },
                        {
                          "name": "File scanners receive scoped file paths",
                          "type": "happy_path",
                          "steps": [
                            "Given Multiple Python files (test_foo.py, test_bar.py, main.py)",
                            "When Validate action executes with scope",
                            "Then Scanner receives filtered files (only test_foo.py, test_bar.py)",
                            "Then And Scope filtered to test files only (**/test*.py)",
                            "Then And Production story_bot with code behavior",
                            "Then And Scanner executes successfully",
                            "Then And Instructions reference test file scope"
                          ],
                          "test_method": "test_file_scanner_receives_file_data"
                        }
                      ]
                    },
                    {
                      "name": "Display Rules",
                      "sequential_order": 999,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestDisplayRules",
                      "scenarios": [
                        {
                          "name": "Action loads and formats rules digest",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with tests behavior (has rules)",
                            "When Rules action executes",
                            "Then Instructions contain formatted rules digest with descriptions, priorities, DO/DON'T sections"
                          ],
                          "test_method": "test_action_loads_and_formats_rules_digest"
                        },
                        {
                          "name": "Rules list includes file paths for each rule",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with tests behavior (has rules)",
                            "When Rules action executes",
                            "Then Display includes rule names with their file paths"
                          ],
                          "test_method": "test_rules_list_includes_file_paths"
                        },
                        {
                          "name": "All behavior rules are included in the digest",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with tests behavior (has multiple rules)",
                            "When Rules action executes",
                            "Then All rules from behavior are included in digest"
                          ],
                          "test_method": "test_all_behavior_rules_included_in_digest"
                        },
                        {
                          "name": "User message is included in instructions when provided",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with tests behavior",
                            "When Rules action executes with message",
                            "Then Instructions include user message",
                            "Then And User message requesting specific rule information"
                          ],
                          "test_method": "test_user_message_included_when_provided"
                        },
                        {
                          "name": "No user message section when message is empty",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with tests behavior",
                            "When Rules action executes without message",
                            "Then Instructions do not include user message section"
                          ],
                          "test_method": "test_no_user_message_section_when_empty"
                        }
                      ]
                    },
                    {
                      "name": "Decide Strategy",
                      "sequential_order": 999,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestDecideStrategy",
                      "scenarios": [
                        {
                          "name": "Action Injects Decision Criteria And Assumptions",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with shape behavior (has guardrails)",
                            "When Action injects strategy criteria and assumptions",
                            "Then Instructions contain all required strategy fields"
                          ],
                          "test_method": "test_action_injects_decision_criteria_and_assumptions"
                        },
                        {
                          "name": "Save strategy data when parameters are provided",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot strategy action",
                            "When do_execute is called with decisions_made and assumptions_made",
                            "Then strategy.json file is created in docs/stories/ folder",
                            "Then And file contains behavior section with decisions_made and assumptions_made"
                          ],
                          "test_method": "test_save_strategy_data_when_parameters_provided"
                        },
                        {
                          "name": "Preserve existing strategy data when saving",
                          "type": "happy_path",
                          "steps": [
                            "Given strategy.json already exists with data for 'discovery' behavior",
                            "When do_execute is called with parameters",
                            "Then strategy.json contains both 'discovery' and 'shape' sections",
                            "Then And Production story_bot strategy action for 'shape' behavior",
                            "Then And existing 'discovery' data is preserved"
                          ],
                          "test_method": "test_preserve_existing_strategy_data_when_saving"
                        },
                        {
                          "name": "Skip saving when no strategy parameters are provided",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot strategy action",
                            "When do_execute is called with empty parameters",
                            "Then strategy.json file is not created"
                          ],
                          "test_method": "test_skip_saving_when_no_strategy_parameters_provided"
                        }
                      ]
                    },
                    {
                      "name": "Render Output",
                      "sequential_order": 999,
                      "connector": "or",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestRenderOutput",
                      "scenarios": [
                        {
                          "name": "Action injects render configs and instructions",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with shape behavior (has render configs)",
                            "When Action injects render data",
                            "Then Instructions contain all required render fields"
                          ],
                          "test_method": "test_action_injects_render_configs_and_instructions"
                        },
                        {
                          "name": "Synchronizers are executed automatically during render action",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with shape behavior (has synchronizers)",
                            "When Render output action executes",
                            "Then Synchronizers are executed automatically"
                          ],
                          "test_method": "test_synchronizers_are_executed_automatically"
                        },
                        {
                          "name": "Template configs remain in instructions for AI handling",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with shape behavior (has templates)",
                            "When Render output action executes",
                            "Then Result includes instructions"
                          ],
                          "test_method": "test_template_configs_remain_in_instructions"
                        },
                        {
                          "name": "Executed synchronizers information is included in AI instructions",
                          "type": "happy_path",
                          "steps": [
                            "Given Production story_bot with shape behavior (has synchronizers)",
                            "When Render output action executes",
                            "Then Instructions include synchronizer execution info"
                          ],
                          "test_method": "test_executed_synchronizers_info_in_instructions"
                        }
                      ]
                    },
                    {
                      "name": "Save Guardrails",
                      "sequential_order": 7,
                      "connector": "and",
                      "users": [
                        "System"
                      ],
                      "story_type": "user",
                      "test_class": "TestSaveGuardrailsViaCLI",
                      "scenarios": [
                        {
                          "name": "Save answers to clarification file",
                          "steps": [
                            "Given Bot is at shape behavior",
                            "And Behavior has clarify action",
                            "When Action saves answers with question What is the scope of this work as Building bot system",
                            "Then System loads existing clarification.json for shape behavior",
                            "And System merges new answer with existing answers",
                            "And System saves updated clarification.json to workspace docs folder",
                            "And File contains shape behavior section with saved answer"
                          ],
                          "test_method": "test_save_guardrail_data_answers"
                        },
                        {
                          "name": "Save evidence to clarification file",
                          "steps": [
                            "Given Bot is at shape behavior",
                            "And Behavior has clarify action",
                            "When Action saves evidence with Requirements doc as spec.md and User interviews as notes.md",
                            "Then System loads existing clarification.json for shape behavior",
                            "And System merges new evidence with existing evidence",
                            "And System saves updated clarification.json to workspace docs folder",
                            "And File contains shape behavior section with saved evidence"
                          ],
                          "test_method": "test_save_guardrail_data_evidence"
                        },
                        {
                          "name": "Save decisions to strategy file",
                          "steps": [
                            "Given Bot is at shape behavior",
                            "And Behavior has strategy action",
                            "When Action saves decisions with drill_down_approach as Dig deep on system interactions",
                            "Then System loads existing strategy.json for shape behavior",
                            "And System merges new decision with existing decisions",
                            "And System saves updated strategy.json to workspace docs folder",
                            "And File contains shape behavior section with saved decision"
                          ],
                          "test_method": "test_save_guardrail_data_decisions"
                        },
                        {
                          "name": "Save assumptions to strategy file",
                          "steps": [
                            "Given Bot is at shape behavior",
                            "And Behavior has strategy action",
                            "When Action saves assumptions with Focus on user flow over internal systems",
                            "Then System loads existing strategy.json for shape behavior",
                            "And System merges new assumption with existing assumptions",
                            "And System saves updated strategy.json to workspace docs folder",
                            "And File contains shape behavior section with saved assumption"
                          ],
                          "test_method": "test_save_guardrail_data_assumptions"
                        },
                        {
                          "name": "Merge preserves existing answer fields",
                          "steps": [
                            "Given clarification.json contains existing answers for shape behavior",
                            "And Existing answers include What is the scope of this work as Building bot system",
                            "And Existing answers include Who are the target users as AI Agents",
                            "When Action saves updated answer Who are the target users as Developers and AI Agents",
                            "Then System preserves What is the scope of this work as Building bot system",
                            "And System overwrites Who are the target users to Developers and AI Agents",
                            "And clarification.json contains both answers with new value for updated field"
                          ],
                          "test_method": "test_merge_with_existing_answers"
                        },
                        {
                          "name": "Merge preserves existing decision fields",
                          "steps": [
                            "Given strategy.json contains existing decisions for shape behavior",
                            "And Existing decisions include drill_down_approach as High and wide across all epics",
                            "And Existing decisions include depth_of_shaping as Extensive",
                            "When Action saves updated decision drill_down_approach as Dig deep on system interactions",
                            "Then System preserves depth_of_shaping as Extensive",
                            "And System overwrites drill_down_approach to Dig deep on system interactions",
                            "And strategy.json contains both decisions with new value for updated field"
                          ],
                          "test_method": "test_merge_with_existing_decisions"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "Track Activity",
              "sequential_order": 6,
              "story_groups": [
                {
                  "type": "and",
                  "connector": null,
                  "stories": [
                    {
                      "name": "Track Action Start",
                      "sequential_order": 1,
                      "connector": "and",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestTrackActionStart",
                      "scenarios": [
                        {
                          "name": "Activity logging infrastructure exists",
                          "steps": "Given Bot is ready to execute action\nWhen Action starts execution\nThen Activity log file exists or activity is trackable",
                          "test_method": "test_activity_log_exists_after_action_execution"
                        }
                      ],
                      "acceptance_criteria": [
                        "WHEN Action starts execution",
                        "THEN Activity entry is created with timestamp and action state",
                        "AND Entry appended to activity_log.json"
                      ]
                    },
                    {
                      "name": "Track Action Completion",
                      "sequential_order": 2,
                      "connector": "and",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestTrackActionCompletion",
                      "scenarios": [
                        {
                          "name": "Action completion tracking",
                          "steps": "Given Action has executed\nWhen Action completes\nThen Completion is tracked in completed_actions",
                          "test_method": "test_action_completion_is_tracked"
                        }
                      ],
                      "acceptance_criteria": [
                        "WHEN Action completes execution",
                        "THEN Activity entry is updated with outputs and duration",
                        "AND Entry appended to activity_log.json"
                      ]
                    },
                    {
                      "name": "Record Activity Metrics And Paths",
                      "sequential_order": 3,
                      "connector": "and",
                      "users": [
                        "Bot Behavior"
                      ],
                      "story_type": "user",
                      "test_class": "TestRecordActivityMetricsAndPaths",
                      "scenarios": [],
                      "acceptance_criteria": [
                        "WHEN Activity is tracked",
                        "THEN Metrics include file counts and content types",
                        "AND Paths include file paths not content",
                        "AND Activity log captures metrics and paths"
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "story_groups": [],
          "test_file": "domain/test_navigate_and_execute_behaviors.py"
        },
        {
          "name": "Get Help",
          "sequential_order": 6,
          "test_file": "domain/test_get_help.py",
          "story_groups": [
            {
              "type": "and",
              "connector": null,
              "stories": [
                {
                  "name": "Get Help",
                  "sequential_order": 999,
                  "connector": "or",
                  "users": [
                    "Bot Behavior"
                  ],
                  "story_type": "user",
                  "test_class": "TestGetHelp",
                  "scenarios": [
                    {
                      "name": "Verify actions can provide instructions",
                      "type": "happy_path",
                      "steps": [
                        "Given Bot has behavior with action",
                        "When Action is accessed",
                        "Then Action has method to get instructions",
                        "Then Domain focus: Action instructions method availability"
                      ],
                      "test_method": "test_action_has_instructions_method"
                    },
                    {
                      "name": "Action provides parameter help via .help property",
                      "type": "happy_path",
                      "steps": [
                        "Given Bot has behavior with action",
                        "When Action.help is accessed",
                        "Then Returns dict with description and parameters list",
                        "Then Domain focus: Parameter help retrieval from Action.help"
                      ],
                      "test_method": "test_action_provides_parameter_help"
                    },
                    {
                      "name": "Action provides command examples",
                      "type": "happy_path",
                      "steps": [
                        "Given Bot has behavior with action",
                        "When Command examples are requested",
                        "Then Action returns usage examples",
                        "Then Domain focus: Command examples retrieval"
                      ],
                      "test_method": "test_action_provides_command_examples"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Invoke Bot Through Panel",
          "sequential_order": 4.0,
          "domain_concepts": [
            {
              "name": "PanelView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps JSON data",
                  "collaborators": [
                    "JSON"
                  ]
                },
                {
                  "name": "Spawns subprocess",
                  "collaborators": [
                    "CLI Client",
                    "Python Process"
                  ]
                },
                {
                  "name": "Sends command to CLI",
                  "collaborators": [
                    "Command",
                    "Stdin"
                  ]
                },
                {
                  "name": "Receives JSON from CLI",
                  "collaborators": [
                    "Stdout"
                  ]
                },
                {
                  "name": "Parses JSON",
                  "collaborators": [
                    "String",
                    "Dict"
                  ]
                },
                {
                  "name": "Provides element ID",
                  "collaborators": [
                    "String"
                  ]
                },
                {
                  "name": "Renders to HTML",
                  "collaborators": [
                    "HTML",
                    "JSON"
                  ]
                }
              ]
            },
            {
              "name": "Panel",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps bot JSON",
                  "collaborators": [
                    "Bot JSON"
                  ]
                },
                {
                  "name": "Displays BotHeaderView",
                  "collaborators": [
                    "BotHeaderView"
                  ]
                },
                {
                  "name": "Displays PathsSection",
                  "collaborators": [
                    "PathsSection"
                  ]
                },
                {
                  "name": "Displays BehaviorsSection",
                  "collaborators": [
                    "BehaviorsSection"
                  ]
                },
                {
                  "name": "Displays ScopeSection",
                  "collaborators": [
                    "ScopeSection"
                  ]
                },
                {
                  "name": "Displays InstructionsSection",
                  "collaborators": [
                    "InstructionsSection"
                  ]
                }
              ],
              "realization": [
                {
                  "scope": "Invoke Bot Through Panel.Manage Bot Information.Open Panel",
                  "scenario": "User activates panel command, extension creates panel and displays bot information by calling Python CLI, wrapping JSON response, and rendering all sections",
                  "walks": [
                    {
                      "covers": "Extension activation and panel creation",
                      "object_flow": [
                        "// VS Code Extension activated",
                        "panelData: JSON = CLI.execute('status')",
                        "  -> pythonProcess: Process = spawn('python', ['repl_main.py'])",
                        "  -> // Python process initialization",
                        "  -> main()",
                        "     -> bot: Bot = load_bot()",
                        "     -> session: REPLSession = REPLSession(bot)",
                        "        -> this.bot = bot",
                        "        -> // Detect output context and select adapter",
                        "        -> isTTY: bool = sys.stdout.isatty()",
                        "        -> isPiped: bool = not isTTY",
                        "        -> if isPiped: // Panel subprocess",
                        "           this.adapter = JSONBotAdapter(bot)",
                        "        -> elif isTTY: // Interactive terminal",
                        "           this.adapter = TTYBotAdapter(bot)",
                        "        -> // Store adapter for session lifecycle",
                        "     -> session.run()",
                        "  -> stdin.write('status')",
                        "  -> REPLSession.handle_command('status')",
                        "     -> // Use session's pre-initialized adapter",
                        "     -> output: String = this.adapter.serialize()",
                        "        -> // JSONBotAdapter.serialize() [piped mode]",
                        "        -> jsonDict: Dict = {}",
                        "        -> jsonDict['name'] = this.bot.name",
                        "        -> jsonDict['behaviors'] = []",
                        "        -> for behavior in this.bot.behaviors:",
                        "           behaviorAdapter: JSONBehaviorAdapter = JSONBehaviorAdapter(behavior)",
                        "           behaviorDict: Dict = behaviorAdapter.serialize()",
                        "              -> actions: Array = []",
                        "              -> for action in this.behavior.actions:",
                        "                 actionAdapter: JSONActionAdapter = JSONActionAdapter(action)",
                        "                 actionDict: Dict = actionAdapter.serialize()",
                        "                    return {name: action.name, is_completed: action.is_completed, is_current: ...}",
                        "                 actions.append(actionDict)",
                        "              return {name: behavior.name, actions: actions, is_completed: ..., is_current: ...}",
                        "           jsonDict['behaviors'].append(behaviorDict)",
                        "        return json.dumps(jsonDict)",
                        "     -> print(output) // stdout",
                        "  -> stdout: String = pythonProcess.stdout.read()",
                        "  -> panelData: JSON = JSON.parse(stdout)",
                        "  return panelData",
                        "panel: Panel = new Panel(panelData, cli)",
                        "return panel"
                      ]
                    },
                    {
                      "covers": "Panel constructor and section rendering",
                      "object_flow": [
                        "// Panel constructor",
                        "this.botJSON = panelData",
                        "this.cli = cli",
                        "headerView: BotHeaderView = new BotHeaderView(this.botJSON, this.cli)",
                        "pathsSection: PathsSection = new PathsSection(this.botJSON.paths, this.cli)",
                        "behaviorsSection: BehaviorsSection = new PathsSection(this.botJSON.behaviors, this.cli)",
                        "scopeSection: ScopeSection = new ScopeSection(this.botJSON.scope, this.cli)",
                        "instructionsSection: InstructionsSection = new InstructionsSection(this.botJSON.instructions, this.cli)",
                        "html: String = this.render()",
                        "  -> headerHTML: String = headerView.render()",
                        "     return `<div>${this.botJSON.name} v${this.botJSON.version}</div>`",
                        "  -> pathsHTML: String = pathsSection.render()",
                        "     return `<div>${this.botJSON.paths.workspace}</div>`",
                        "  -> behaviorsHTML: String = behaviorsSection.render()",
                        "  -> scopeHTML: String = scopeSection.render()",
                        "  -> instructionsHTML: String = instructionsSection.render()",
                        "  return `<div>${headerHTML}${pathsHTML}${behaviorsHTML}${scopeHTML}${instructionsHTML}</div>`",
                        "webview.html = html"
                      ]
                    }
                  ],
                  "model_updates": []
                },
                {
                  "scope": "Invoke Bot Through Panel.Manage Bot Information.Refresh Panel",
                  "scenario": "User clicks refresh button, panel calls CLI to get updated status, wraps new JSON, and re-renders all sections",
                  "walks": [
                    {
                      "covers": "User refresh action and CLI round-trip",
                      "object_flow": [
                        "// User clicks refresh button",
                        "BotHeaderView.onRefreshClick()",
                        "  -> newData: JSON = this.cli.execute('status')",
                        "     -> pythonProcess.stdin.write('status')",
                        "     -> REPLSession.handle_command('status', format='json')",
                        "        -> adapter: JSONBotAdapter = JSONBotAdapter(bot)",
                        "        -> jsonDict: Dict = adapter.serialize() // Delegates to JSONBehaviorAdapter, JSONActionAdapter",
                        "        -> jsonString: String = json.dumps(jsonDict)",
                        "        -> print(jsonString)",
                        "     -> stdout: String = pythonProcess.stdout.read()",
                        "     -> newData: JSON = JSON.parse(stdout)",
                        "     return newData",
                        "  -> this.botJSON = newData",
                        "  -> panel.update(newData)",
                        "     -> this.botJSON = newData",
                        "     -> html: String = this.render()",
                        "        // All sections re-render with new JSON",
                        "     -> webview.html = html",
                        "  return success"
                      ]
                    }
                  ],
                  "model_updates": []
                }
              ]
            },
            {
              "name": "BotHeaderView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps bot JSON",
                  "collaborators": [
                    "Bot JSON"
                  ]
                },
                {
                  "name": "Displays image",
                  "collaborators": [
                    "Image"
                  ]
                },
                {
                  "name": "Displays title",
                  "collaborators": [
                    "String",
                    "Bot JSON"
                  ]
                },
                {
                  "name": "Displays version number",
                  "collaborators": [
                    "String",
                    "Bot JSON"
                  ]
                },
                {
                  "name": "Refreshes panel",
                  "collaborators": [
                    "CLI Client"
                  ]
                }
              ]
            },
            {
              "name": "PanelHeader",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Displays header image",
                  "collaborators": [
                    "Image"
                  ]
                },
                {
                  "name": "Displays title",
                  "collaborators": [
                    "String"
                  ]
                }
              ]
            },
            {
              "name": "SectionView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Renders section header",
                  "collaborators": [
                    "PanelHeader"
                  ]
                },
                {
                  "name": "Toggles collapsed state",
                  "collaborators": [
                    "State"
                  ]
                },
                {
                  "name": "May contain subsections",
                  "collaborators": [
                    "SubSectionView"
                  ]
                }
              ]
            },
            {
              "name": "PathsSection",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps bot paths JSON",
                  "collaborators": [
                    "BotPaths JSON"
                  ]
                },
                {
                  "name": "Displays bot directory",
                  "collaborators": [
                    "String",
                    "BotPaths JSON"
                  ]
                },
                {
                  "name": "Edits workspace directory",
                  "collaborators": [
                    "CLI Client",
                    "BotPaths JSON"
                  ]
                },
                {
                  "name": "Displays available bots",
                  "collaborators": [
                    "AvailableBotsView"
                  ]
                }
              ]
            },
            {
              "name": "AvailableBotsView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps bot registry JSON",
                  "collaborators": [
                    "BotRegistry JSON"
                  ]
                },
                {
                  "name": "Displays available bots",
                  "collaborators": [
                    "List",
                    "BotRegistry JSON"
                  ]
                },
                {
                  "name": "Selects bot",
                  "collaborators": [
                    "CLI Client",
                    "Bot"
                  ]
                }
              ]
            },
            {
              "name": "SubSectionView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Toggles collapsed state",
                  "collaborators": [
                    "State"
                  ]
                }
              ]
            },
            {
              "name": "BehaviorsSection",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps behaviors JSON",
                  "collaborators": [
                    "Behaviors JSON"
                  ]
                },
                {
                  "name": "Displays behavior names list",
                  "collaborators": [
                    "List",
                    "Behavior JSON"
                  ]
                },
                {
                  "name": "Navigates to behavior",
                  "collaborators": [
                    "CLI Client",
                    "Behavior"
                  ]
                },
                {
                  "name": "Toggles collapsed",
                  "collaborators": [
                    "State",
                    "Behavior JSON"
                  ]
                },
                {
                  "name": "Displays tooltip",
                  "collaborators": [
                    "String",
                    "Behavior JSON"
                  ]
                },
                {
                  "name": "Displays actions",
                  "collaborators": [
                    "ActionsView"
                  ]
                },
                {
                  "name": "Executes behavior",
                  "collaborators": [
                    "CLI Client",
                    "Behavior"
                  ]
                },
                {
                  "name": "Displays completion progress",
                  "collaborators": [
                    "Status",
                    "Behavior JSON"
                  ]
                },
                {
                  "name": "Displays navigation",
                  "collaborators": [
                    "NavigationView"
                  ]
                }
              ],
              "realization": [
                {
                  "scope": "Invoke Bot Through Panel.Navigate Behavior Action Status.Display Hierarchy",
                  "scenario": "Panel displays behavior hierarchy with actions, user expands/collapses behaviors (instant), completion status from JSON",
                  "walks": [
                    {
                      "covers": "Rendering behavior hierarchy from JSON",
                      "object_flow": [
                        "// BehaviorsSection constructor",
                        "this.behaviorsJSON = behaviorsJSON",
                        "this.cli = cli",
                        "html: String = this.render()",
                        "  -> behaviorsHTML: String = ''",
                        "  -> for behavior in this.behaviorsJSON:",
                        "     behaviorView: BehaviorView = new BehaviorView(behavior, this.cli)",
                        "     behaviorHTML: String = behaviorView.render()",
                        "       -> name: String = this.behaviorJSON.name",
                        "       -> status: String = this.behaviorJSON.status // 'current', 'completed', 'pending'",
                        "       -> actionsView: ActionsView = new ActionsView(this.behaviorJSON.actions, this.cli)",
                        "       -> actionsHTML: String = actionsView.render()",
                        "          -> for action in this.actionsJSON:",
                        "             actionHTML: String = `<div>${action.name} [${action.status}]</div>`",
                        "          return actionsHTML",
                        "       return `<div class='behavior ${status}'>${name}${actionsHTML}</div>`",
                        "     behaviorsHTML += behaviorHTML",
                        "  return behaviorsHTML"
                      ]
                    },
                    {
                      "covers": "User expands behavior (client-side toggle)",
                      "object_flow": [
                        "// User clicks collapsed behavior",
                        "BehaviorView.onToggleClick()",
                        "  -> this.expanded = !this.expanded // Local state change",
                        "  -> elementHTML: String = this.render()",
                        "  -> document.getElementById(this.elementId).innerHTML = elementHTML",
                        "  return // No CLI call - instant UI update"
                      ]
                    }
                  ],
                  "model_updates": []
                },
                {
                  "scope": "Invoke Bot Through Panel.Navigate Behavior Action Status.Execute Behavior Action",
                  "scenario": "User clicks behavior to execute, system navigates to behavior and executes first action via CLI",
                  "walks": [
                    {
                      "covers": "User executes behavior via CLI",
                      "object_flow": [
                        "// User clicks behavior name",
                        "BehaviorView.onExecuteClick()",
                        "  -> behaviorName: String = this.behaviorJSON.name",
                        "  -> result: JSON = this.cli.execute(behaviorName)",
                        "     -> pythonProcess: Process = spawn('python', ['repl_main.py'])",
                        "     -> stdin.write(behaviorName)",
                        "     -> Bot.execute_behavior(behaviorName)",
                        "        -> behavior: Behavior = behaviors.get(behaviorName)",
                        "        -> action: Action = behavior.get_first_action()",
                        "        -> action.execute()",
                        "        -> BehaviorActionState.update_current(behavior, action)",
                        "        return {behavior: behaviorName, action: action.name, status: 'in_progress'}",
                        "     return statusJSON",
                        "  -> panel.update(result)",
                        "     -> this.behaviorsJSON = result.behaviors",
                        "     -> html: String = behaviorsSection.render()",
                        "     -> webview.postMessage({update: 'behaviors', html: html})",
                        "  return"
                      ]
                    }
                  ],
                  "model_updates": []
                }
              ]
            },
            {
              "name": "NavigationView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps current action JSON",
                  "collaborators": [
                    "Action JSON"
                  ]
                },
                {
                  "name": "Reruns action",
                  "collaborators": [
                    "CLI Client",
                    "Action"
                  ]
                },
                {
                  "name": "Navigates to next action",
                  "collaborators": [
                    "CLI Client",
                    "Action"
                  ]
                },
                {
                  "name": "Navigates to prev action",
                  "collaborators": [
                    "CLI Client",
                    "Action"
                  ]
                }
              ]
            },
            {
              "name": "ActionsView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps actions JSON",
                  "collaborators": [
                    "Actions JSON"
                  ]
                },
                {
                  "name": "Displays action names list",
                  "collaborators": [
                    "List",
                    "Action JSON"
                  ]
                },
                {
                  "name": "Navigates to action",
                  "collaborators": [
                    "CLI Client",
                    "Action"
                  ]
                },
                {
                  "name": "Displays status indicators",
                  "collaborators": [
                    "Status",
                    "Action JSON"
                  ]
                },
                {
                  "name": "Executes action",
                  "collaborators": [
                    "CLI Client",
                    "Action"
                  ]
                },
                {
                  "name": "Displays completion progress",
                  "collaborators": [
                    "Progress",
                    "Action JSON"
                  ]
                }
              ]
            },
            {
              "name": "ScopeSection",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps scope JSON",
                  "collaborators": [
                    "Scope JSON"
                  ]
                },
                {
                  "name": "Displays filtered files",
                  "collaborators": [
                    "FileListTabView"
                  ]
                },
                {
                  "name": "Filters story graph",
                  "collaborators": [
                    "CLI Client",
                    "Scope JSON"
                  ]
                },
                {
                  "name": "Filters files",
                  "collaborators": [
                    "CLI Client",
                    "Scope JSON"
                  ]
                },
                {
                  "name": "Clears filter",
                  "collaborators": [
                    "CLI Client",
                    "Scope JSON"
                  ]
                },
                {
                  "name": "Displays story graph",
                  "collaborators": [
                    "StoryGraphTabView"
                  ]
                }
              ]
            },
            {
              "name": "StoryGraphTabView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps story map JSON",
                  "collaborators": [
                    "StoryMap JSON"
                  ]
                },
                {
                  "name": "Displays epic hierarchy",
                  "collaborators": [
                    "EpicView",
                    "Epic JSON"
                  ]
                },
                {
                  "name": "Searches stories",
                  "collaborators": [
                    "Filter",
                    "StoryGraph JSON"
                  ]
                },
                {
                  "name": "Opens story graph file",
                  "collaborators": [
                    "CLI Client",
                    "File JSON"
                  ]
                },
                {
                  "name": "Opens story map file",
                  "collaborators": [
                    "CLI Client",
                    "File JSON"
                  ]
                }
              ],
              "realization": [
                {
                  "scope": "Invoke Bot Through Panel.Filter And Navigate Scope.Display Story Scope Hierarchy",
                  "scenario": "Panel displays nested epic/sub-epic/story/scenario hierarchy from story graph JSON, user can expand/collapse and navigate",
                  "walks": [
                    {
                      "covers": "Rendering 4-level nested hierarchy from JSON",
                      "object_flow": [
                        "// StoryGraphTabView constructor",
                        "this.storyMapJSON = storyMapJSON",
                        "this.cli = cli",
                        "html: String = this.render()",
                        "  -> epicsHTML: String = ''",
                        "  -> for epic in this.storyMapJSON.epics:",
                        "     epicView: EpicView = new EpicView(epic, this.cli)",
                        "     epicHTML: String = epicView.render()",
                        "       -> name: String = this.epicJSON.name",
                        "       -> icon: String = this.epicJSON.icon",
                        "       -> subEpicsHTML: String = ''",
                        "       -> for subEpic in this.epicJSON.sub_epics:",
                        "          subEpicView: SubEpicView = new SubEpicView(subEpic, this.cli)",
                        "          subEpicHTML: String = subEpicView.render()",
                        "            -> storiesHTML: String = ''",
                        "            -> for story in this.subEpicJSON.stories:",
                        "               storyView: StoryView = new StoryView(story, this.cli)",
                        "               storyHTML: String = storyView.render()",
                        "                 -> scenariosHTML: String = ''",
                        "                 -> for scenario in this.storyJSON.scenarios:",
                        "                    scenarioView: ScenarioView = new ScenarioView(scenario, this.cli)",
                        "                    scenarioHTML: String = scenarioView.render()",
                        "                      return `<div>${this.scenarioJSON.name}</div>`",
                        "                    scenariosHTML += scenarioHTML",
                        "                 return `<div>${this.storyJSON.name}${scenariosHTML}</div>`",
                        "               storiesHTML += storyHTML",
                        "            return `<div>${this.subEpicJSON.name}${storiesHTML}</div>`",
                        "          subEpicsHTML += subEpicHTML",
                        "       return `<div>${name}${subEpicsHTML}</div>`",
                        "     epicsHTML += epicHTML",
                        "  return epicsHTML"
                      ]
                    },
                    {
                      "covers": "User opens epic folder via CLI",
                      "object_flow": [
                        "// User clicks epic folder link",
                        "EpicView.onFolderClick()",
                        "  -> folderPath: String = this.epicJSON.folder_path",
                        "  -> this.cli.sendMessage({command: 'openScope', filePath: folderPath})",
                        "     -> vscode.commands.executeCommand('vscode.open', fileUri)",
                        "  return // No panel re-render needed"
                      ]
                    }
                  ],
                  "model_updates": []
                },
                {
                  "scope": "Invoke Bot Through Panel.Filter And Navigate Scope.Filter Story Scope",
                  "scenario": "User types story name in filter, system calls CLI to update scope filter, returns filtered JSON, view re-renders with filtered hierarchy",
                  "walks": [
                    {
                      "covers": "User filters scope via CLI",
                      "object_flow": [
                        "// User types 'Open Panel' in filter",
                        "ScopeSection.onFilterInput('Open Panel')",
                        "  -> filteredData: JSON = this.cli.execute('scope \"Open Panel\"')",
                        "     -> pythonProcess: Process = spawn('python', ['repl_main.py'])",
                        "     -> stdin.write('scope \"Open Panel\"')",
                        "     -> Bot.update_scope_filter('Open Panel')",
                        "        -> scope: Scope = Scope.filter_by_story('Open Panel')",
                        "        -> filteredStoryMap: JSON = scope.get_filtered_story_map()",
                        "        return {scope: {filter: 'Open Panel', storyMap: filteredStoryMap}}",
                        "     return scopeJSON",
                        "  -> this.scopeJSON = filteredData.scope",
                        "  -> storyGraphView: StoryGraphTabView = new StoryGraphTabView(filteredData.scope.storyMap, this.cli)",
                        "  -> html: String = storyGraphView.render()",
                        "     // Renders only matching epic/sub-epic/story",
                        "  -> document.getElementById('scope-display').innerHTML = html",
                        "  return"
                      ]
                    }
                  ],
                  "model_updates": []
                }
              ]
            },
            {
              "name": "EpicView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps epic JSON",
                  "collaborators": [
                    "Epic JSON"
                  ]
                },
                {
                  "name": "Displays epic name",
                  "collaborators": [
                    "String",
                    "Epic JSON"
                  ]
                },
                {
                  "name": "Displays epic icon",
                  "collaborators": [
                    "Image"
                  ]
                },
                {
                  "name": "Displays sub epics",
                  "collaborators": [
                    "SubEpicView",
                    "SubEpic JSON"
                  ]
                },
                {
                  "name": "Toggles collapsed",
                  "collaborators": [
                    "State"
                  ]
                },
                {
                  "name": "Opens epic folder",
                  "collaborators": [
                    "CLI Client",
                    "Epic JSON"
                  ]
                },
                {
                  "name": "Opens epic test file",
                  "collaborators": [
                    "CLI Client",
                    "Epic JSON"
                  ]
                }
              ]
            },
            {
              "name": "SubEpicView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps sub epic JSON",
                  "collaborators": [
                    "SubEpic JSON"
                  ]
                },
                {
                  "name": "Displays sub epic name",
                  "collaborators": [
                    "String",
                    "SubEpic JSON"
                  ]
                },
                {
                  "name": "Displays sub epic icon",
                  "collaborators": [
                    "Image"
                  ]
                },
                {
                  "name": "Displays nested sub epics",
                  "collaborators": [
                    "SubEpicView",
                    "SubEpic JSON"
                  ]
                },
                {
                  "name": "Displays stories",
                  "collaborators": [
                    "StoryView",
                    "Story JSON"
                  ]
                },
                {
                  "name": "Toggles collapsed",
                  "collaborators": [
                    "State"
                  ]
                },
                {
                  "name": "Opens sub epic folder",
                  "collaborators": [
                    "CLI Client",
                    "SubEpic JSON"
                  ]
                },
                {
                  "name": "Opens sub epic test file",
                  "collaborators": [
                    "CLI Client",
                    "SubEpic JSON"
                  ]
                }
              ]
            },
            {
              "name": "StoryView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps story JSON",
                  "collaborators": [
                    "Story JSON"
                  ]
                },
                {
                  "name": "Displays story name",
                  "collaborators": [
                    "String",
                    "Story JSON"
                  ]
                },
                {
                  "name": "Displays story icon",
                  "collaborators": [
                    "Image"
                  ]
                },
                {
                  "name": "Displays scenarios",
                  "collaborators": [
                    "ScenarioView",
                    "Scenario JSON"
                  ]
                },
                {
                  "name": "Toggles collapsed",
                  "collaborators": [
                    "State"
                  ]
                },
                {
                  "name": "Opens test at class",
                  "collaborators": [
                    "CLI Client",
                    "Story JSON"
                  ]
                }
              ]
            },
            {
              "name": "ScenarioView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps scenario JSON",
                  "collaborators": [
                    "Scenario JSON"
                  ]
                },
                {
                  "name": "Displays scenario name",
                  "collaborators": [
                    "String",
                    "Scenario JSON"
                  ]
                },
                {
                  "name": "Displays scenario icon",
                  "collaborators": [
                    "Image"
                  ]
                },
                {
                  "name": "Opens test at scenario",
                  "collaborators": [
                    "CLI Client",
                    "Scenario JSON"
                  ]
                }
              ]
            },
            {
              "name": "FileListTabView",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps file list JSON",
                  "collaborators": [
                    "Path JSON"
                  ]
                },
                {
                  "name": "Displays file names",
                  "collaborators": [
                    "List",
                    "Path JSON"
                  ]
                },
                {
                  "name": "Searches files",
                  "collaborators": [
                    "Filter",
                    "Path JSON"
                  ]
                },
                {
                  "name": "Opens file",
                  "collaborators": [
                    "CLI Client",
                    "Path JSON"
                  ]
                }
              ]
            },
            {
              "name": "InstructionsSection",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps instructions JSON",
                  "collaborators": [
                    "Instructions JSON"
                  ]
                },
                {
                  "name": "Wraps action JSON",
                  "collaborators": [
                    "Action JSON"
                  ]
                },
                {
                  "name": "Displays base instructions",
                  "collaborators": [
                    "String",
                    "Instructions JSON"
                  ]
                },
                {
                  "name": "Displays action data",
                  "collaborators": [
                    "Object",
                    "Action JSON"
                  ]
                },
                {
                  "name": "Displays raw format",
                  "collaborators": [
                    "String",
                    "Instructions JSON"
                  ]
                },
                {
                  "name": "Submits to AI chat",
                  "collaborators": [
                    "CLI Client",
                    "Instructions JSON"
                  ]
                }
              ]
            },
            {
              "name": "ClarifyInstructionsSection",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps key questions JSON",
                  "collaborators": [
                    "KeyQuestions JSON"
                  ]
                },
                {
                  "name": "Displays key questions",
                  "collaborators": [
                    "List",
                    "KeyQuestion JSON"
                  ]
                },
                {
                  "name": "Updates evidence",
                  "collaborators": [
                    "CLI Client",
                    "Evidence JSON"
                  ]
                },
                {
                  "name": "Edits answer",
                  "collaborators": [
                    "CLI Client",
                    "KeyQuestion JSON"
                  ]
                }
              ],
              "realization": [
                {
                  "scope": "Invoke Bot Through Panel.Display Instructions.Display Clarify Instructions",
                  "scenario": "When current action is clarify, panel displays ClarifyInstructionsSection with key questions in editable textareas, user edits answer, system saves via CLI",
                  "walks": [
                    {
                      "covers": "Rendering clarify-specific instructions from JSON",
                      "object_flow": [
                        "// InstructionsSection determines which subclass to use",
                        "InstructionsSection.create(instructionsJSON, actionJSON, cli)",
                        "  -> actionType: String = actionJSON.type // 'clarify'",
                        "  -> if actionType == 'clarify':",
                        "     section: ClarifyInstructionsSection = new ClarifyInstructionsSection(instructionsJSON, actionJSON, cli)",
                        "       -> this.keyQuestionsJSON = instructionsJSON.clarify.key_questions",
                        "       -> this.cli = cli",
                        "     return section",
                        "html: String = section.render()",
                        "  -> baseHTML: String = this.renderBase()",
                        "     return `<div>${this.instructionsJSON.behavior_name}.${this.actionJSON.name}</div>`",
                        "  -> questionsHTML: String = ''",
                        "  -> for question in this.keyQuestionsJSON:",
                        "     questionHTML: String = `",
                        "       <div class='question'>",
                        "         <label>${question.question}</label>",
                        "         <textarea id='answer-${question.id}' ",
                        "                   onchange='updateAnswer(${question.id})'>${question.answer}</textarea>",
                        "       </div>`",
                        "     questionsHTML += questionHTML",
                        "  return `${baseHTML}${questionsHTML}`"
                      ]
                    },
                    {
                      "covers": "User edits answer and saves via CLI",
                      "object_flow": [
                        "// User edits answer in textarea and blur triggers save",
                        "ClarifyInstructionsSection.onAnswerChange(questionId, newAnswer)",
                        "  -> question: Object = this.keyQuestionsJSON.find(q => q.id == questionId)",
                        "  -> result: JSON = this.cli.execute(`update_answer \"${question.question}\" \"${newAnswer}\"`)",
                        "     -> pythonProcess: Process = spawn('python', ['repl_main.py'])",
                        "     -> stdin.write('update_answer ...')",
                        "     -> Bot.update_question_answer(question, newAnswer)",
                        "        -> clarificationFile: Path = behavior.get_clarification_file()",
                        "        -> clarificationData: JSON = load_json(clarificationFile)",
                        "        -> clarificationData.answers[question] = newAnswer",
                        "        -> save_json(clarificationFile, clarificationData)",
                        "        return {status: 'saved', question: question, answer: newAnswer}",
                        "     return resultJSON",
                        "  -> question.answer = newAnswer",
                        "  -> // Local update complete, no re-render needed",
                        "  return"
                      ]
                    }
                  ],
                  "model_updates": []
                }
              ]
            },
            {
              "name": "StrategyInstructionsSection",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps strategy JSON",
                  "collaborators": [
                    "Strategy JSON"
                  ]
                },
                {
                  "name": "Displays decision criteria",
                  "collaborators": [
                    "List",
                    "DecisionCriteria JSON"
                  ]
                },
                {
                  "name": "Displays assumptions",
                  "collaborators": [
                    "String",
                    "Assumptions JSON"
                  ]
                },
                {
                  "name": "Edits decision criterion",
                  "collaborators": [
                    "CLI Client",
                    "DecisionCriterion JSON"
                  ]
                },
                {
                  "name": "Edits assumption",
                  "collaborators": [
                    "CLI Client",
                    "Assumption JSON"
                  ]
                }
              ]
            },
            {
              "name": "BuildInstructionsSection",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps build JSON",
                  "collaborators": [
                    "Build JSON"
                  ]
                },
                {
                  "name": "Displays knowledge graph spec",
                  "collaborators": [
                    "Object",
                    "KnowledgeGraphSpec JSON"
                  ]
                },
                {
                  "name": "Displays graph structure",
                  "collaborators": [
                    "Object",
                    "KnowledgeGraphSpec JSON"
                  ]
                },
                {
                  "name": "Displays builder instructions",
                  "collaborators": [
                    "String",
                    "BuilderInstructions JSON"
                  ]
                },
                {
                  "name": "Opens graph file",
                  "collaborators": [
                    "CLI Client",
                    "Path JSON"
                  ]
                }
              ]
            },
            {
              "name": "ValidateInstructionsSection",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps validate JSON",
                  "collaborators": [
                    "Validate JSON"
                  ]
                },
                {
                  "name": "Displays rules",
                  "collaborators": [
                    "List",
                    "Rule JSON"
                  ]
                },
                {
                  "name": "Displays rule descriptions",
                  "collaborators": [
                    "String",
                    "Rule JSON"
                  ]
                },
                {
                  "name": "Displays rule examples",
                  "collaborators": [
                    "List",
                    "Rule JSON"
                  ]
                },
                {
                  "name": "Opens rule file",
                  "collaborators": [
                    "CLI Client",
                    "Path JSON"
                  ]
                }
              ]
            },
            {
              "name": "RenderInstructionsSection",
              "module": "display_panel.extension",
              "responsibilities": [
                {
                  "name": "Wraps render JSON",
                  "collaborators": [
                    "Render JSON"
                  ]
                },
                {
                  "name": "Displays render spec",
                  "collaborators": [
                    "Object",
                    "RenderSpec JSON"
                  ]
                },
                {
                  "name": "Displays templates",
                  "collaborators": [
                    "List",
                    "Template JSON"
                  ]
                },
                {
                  "name": "Displays render instructions",
                  "collaborators": [
                    "String",
                    "RenderInstructions JSON"
                  ]
                },
                {
                  "name": "Opens template file",
                  "collaborators": [
                    "CLI Client",
                    "Path JSON"
                  ]
                }
              ]
            }
          ],
          "sub_epics": [
            {
              "name": "Manage Panel Session",
              "sequential_order": 1,
              "test_file": "test_manage_panel_session.js",
              "story_groups": [
                {
                  "type": "and",
                  "connector": null,
                  "stories": [
                    {
                      "name": "Open Panel",
                      "sequential_order": 1,
                      "connector": null,
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestOpenPanel",
                      "acceptance_criteria": [
                        "WHEN User activates panel command",
                        "THEN System displays bot name",
                        "AND System displays workspace path",
                        "AND System displays bot path",
                        "AND System displays available botss",
                        "AND System displays behavior action section",
                        "AND System displays scope section",
                        "AND System displays instructions section"
                      ],
                      "scenarios": [
                        {
                          "title": "User opens panel via command palette",
                          "test_method": "test_user_opens_panel_via_command_palette_happy_path",
                          "steps": [
                            "Given VS Code workspace with bot installed",
                            "When User executes 'Open Status Panel' command",
                            "Then Panel webview appears",
                            "And Panel displays bot name",
                            "And Panel displays workspace path",
                            "And Panel displays behavior action section",
                            "And Panel displays scope section",
                            "And Panel displays instructions section"
                          ]
                        },
                        {
                          "title": "User opens panel when already open",
                          "steps": [
                            "Given Panel is already open in VS Code",
                            "When User executes 'Open Status Panel' command again",
                            "Then Existing panel is brought to front",
                            "And No duplicate panel is created"
                          ]
                        },
                        {
                          "title": "User opens panel with no bots configured",
                          "steps": [
                            "Given VS Code workspace with no bots installed",
                            "When User executes 'Open Status Panel' command",
                            "Then Panel displays error message",
                            "And Error message indicates no bots found"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Display Session Status",
                      "sequential_order": 2,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestDisplaySessionStatus",
                      "acceptance_criteria": [
                        "WHEN User clicks refresh button",
                        "THEN System displays bot name",
                        "AND System displays updated workspace path",
                        "AND System displays updated bot path",
                        "AND System displays updated available botss",
                        "AND System displays updated behavior action section",
                        "AND System displays updated scope section",
                        "AND System displays updated instructions section"
                      ],
                      "scenarios": [
                        {
                          "title": "User refreshes panel to see updated status",
                          "steps": [
                            "Given Panel is open displaying current bot status",
                            "And Bot state has changed since panel was opened",
                            "When User clicks refresh button",
                            "Then Panel displays updated bot name",
                            "And Panel displays updated workspace path",
                            "And Panel displays updated behavior action section",
                            "And Panel displays updated scope",
                            "And Panel displays updated instructions"
                          ]
                        },
                        {
                          "title": "User views session status on panel load",
                          "steps": [
                            "Given Bot is at behavior shape and action clarify",
                            "When Panel opens",
                            "Then Panel displays current bot name",
                            "And Panel displays current workspace path",
                            "And Panel displays shape.clarify as current action"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Change Workspace Path",
                      "sequential_order": 3,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestChangeWorkspacePath",
                      "acceptance_criteria": [
                        "WHEN User changes workspace path",
                        "THEN System displays updated workspace path",
                        "AND System displays behavior action state of new workspace",
                        "WHEN User sets workspace path",
                        "THEN System persists workspace path value",
                        "WHEN Panel refreshes",
                        "THEN System restores previously set workspace path"
                      ],
                      "scenarios": [
                        {
                          "title": "User changes to different workspace directory",
                          "steps": [
                            "Given Panel is open showing workspace at c:/dev/project_a",
                            "And Workspace at c:/dev/project_b exists with different bot state",
                            "When User changes workspace path to c:/dev/project_b",
                            "Then Panel displays c:/dev/project_b as current workspace",
                            "And Panel displays behavior action state from project_b",
                            "And Panel refreshes all sections with project_b data"
                          ]
                        },
                        {
                          "title": "User changes to invalid workspace directory",
                          "steps": [
                            "Given Panel is open showing valid workspace",
                            "When User changes workspace path to non-existent directory",
                            "Then Panel displays error message",
                            "And Error message indicates directory not found",
                            "And Panel retains previous valid workspace"
                          ]
                        },
                        {
                          "title": "Workspace path persists across panel refreshes",
                          "steps": [
                            "Given Panel is open showing default workspace c:/dev/project_a",
                            "When User changes workspace path to c:/dev/project_b",
                            "And Panel displays project_b workspace and state",
                            "And User refreshes panel",
                            "Then Panel displays c:/dev/project_b as current workspace",
                            "And Workspace path was persisted and restored"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Switch Bot",
                      "sequential_order": 4,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestSwitchBot",
                      "acceptance_criteria": [
                        "WHEN User switches bot",
                        "THEN System displays updated bot name",
                        "AND System displays behavior action section for new bot",
                        "AND System displays behavior action stateof workspace for new bot"
                      ],
                      "scenarios": [
                        {
                          "name": "Panel shows story_bot and multiple bots available",
                          "type": "happy_path",
                          "title": "User selects different bot from dropdown",
                          "test_method": "test_panel_shows_story_bot_and_multiple_bots_available",
                          "steps": [
                            "Given Panel is open showing story_bot",
                            "And Multiple bots are available (story_bot, crc_bot)",
                            "When User selects crc_bot from bot selector dropdown",
                            "Then Panel displays crc_bot as current bot",
                            "And Panel displays crc_bot's behaviors",
                            "And Panel displays crc_bot's current action",
                            "And Panel refreshes all sections with crc_bot data"
                          ]
                        },
                        {
                          "name": "User switches to crc_bot",
                          "type": "happy_path",
                          "title": "User switches bot and panel preserves workspace",
                          "test_method": "test_user_switches_to_crc_bot",
                          "steps": [
                            "Given Panel is open with story_bot at workspace c:/dev/project_a",
                            "When User switches to crc_bot",
                            "Then Panel displays crc_bot",
                            "And Panel retains workspace c:/dev/project_a",
                            "And Panel displays crc_bot state for that workspace"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Toggle Panel Section",
                      "sequential_order": 5,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestTogglePanelSection",
                      "acceptance_criteria": [
                        "WHEN User clicks section header",
                        "THEN System expands or collapses section"
                      ],
                      "scenarios": [
                        {
                          "title": "User expands collapsed section",
                          "steps": [
                            "Given Panel is open with behaviors section collapsed",
                            "When User clicks behaviors section header",
                            "Then Behaviors section expands",
                            "And User sees behavior tree content"
                          ]
                        },
                        {
                          "title": "User collapses expanded section",
                          "steps": [
                            "Given Panel is open with instructions section expanded",
                            "When User clicks instructions section header",
                            "Then Instructions section collapses",
                            "And User no longer sees instructions content"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "Navigate And Execute Behaviors Through Panel",
              "sequential_order": 2,
              "test_file": "test_navigate_and_execute.js",
              "story_groups": [
                {
                  "type": "and",
                  "connector": null,
                  "stories": [
                    {
                      "name": "Display Hierarchy",
                      "sequential_order": 1,
                      "connector": null,
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestDisplayHierarchy",
                      "acceptance_criteria": [
                        "WHEN User views panel",
                        "THEN System displays behavior list with actions",
                        "WHEN Action is current",
                        "THEN System displays current action in-progress indicator",
                        "WHEN Action is completed",
                        "THEN System displays completed indicator",
                        "WHEN Action is pending",
                        "THEN System displays pending indicator",
                        "WHEN User clicks collapsed behavior",
                        "THEN System expands behavior showing actions",
                        "WHEN User clicks expanded behavior",
                        "THEN System collapses behavior hiding actions",
                        "WHEN User clicks collapsed action",
                        "THEN System expands action showing operations",
                        "WHEN User clicks expanded action",
                        "THEN System collapses action hiding operations",
                        "WHEN User views behavior list",
                        "THEN System displays all behaviors expandable regardless of current position",
                        "WHEN User views behavior list",
                        "THEN System displays behaviors in correct sequential order"
                      ],
                      "scenarios": [
                        {
                          "title": "Panel displays behavior tree with progress indicators",
                          "steps": [
                            "Given Bot has multiple behaviors with completed and pending actions",
                            "And Bot is currently at shape.clarify",
                            "When Panel renders hierarchy section",
                            "Then User sees behavior names (shape, discovery)",
                            "And User sees action names under behaviors",
                            "And Current action (clarify) shows in-progress indicator",
                            "And Completed actions show checkmark indicator",
                            "And Pending actions show empty indicator"
                          ]
                        },
                        {
                          "title": "User expands and collapses behaviors",
                          "steps": [
                            "Given Panel displays collapsed behavior tree",
                            "When User clicks collapsed shape behavior",
                            "Then Shape behavior expands showing actions (clarify, strategy)",
                            "When User clicks expanded shape behavior again",
                            "Then Shape behavior collapses hiding actions"
                          ]
                        },
                        {
                          "title": "User expands and collapses actions",
                          "steps": [
                            "Given Shape behavior is expanded showing actions",
                            "And Clarify action is collapsed",
                            "When User clicks collapsed clarify action",
                            "Then Clarify action expands showing operations (instructions, execute, confirm)",
                            "When User clicks expanded clarify action again",
                            "Then Clarify action collapses hiding operations"
                          ]
                        },
                        {
                          "title": "All behaviors are expandable not just current behavior",
                          "steps": [
                            "Given Panel displays behavior tree",
                            "And Bot is currently at shape.clarify",
                            "When User clicks collapsed discovery behavior",
                            "Then Discovery behavior expands showing actions",
                            "And Discovery actions are visible even though bot is at shape",
                            "When User clicks collapsed scenarios behavior",
                            "Then Scenarios behavior expands showing actions",
                            "And Scenarios actions are visible even though bot is at shape"
                          ]
                        },
                        {
                          "title": "Behaviors display in correct sequential order",
                          "steps": [
                            "Given Bot has behaviors with defined sequential order",
                            "When Panel renders behavior tree",
                            "Then Behaviors appear in order (shape, prioritization, discovery, exploration, scenarios, tests, code)",
                            "And Actions under each behavior appear in their configured order",
                            "And Order matches behavior configuration JSON"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Navigate Behavior Action",
                      "sequential_order": 2,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestNavigateBehaviorAction",
                      "acceptance_criteria": [
                        "WHEN User clicks back button",
                        "THEN System  sets previous action as current",
                        "AND System displays previous action in-progress indicator",
                        "AND System reruns previous action details",
                        "WHEN User clicks next button",
                        "THEN System sets next action as current",
                        "AND System displays next action in-progress indicator",
                        "AND System reruns next action details",
                        "WHEN User clicks current button",
                        "THEN System reruns current action details",
                        "WHEN User is on the last operation of an action",
                        "THEN System moves to the next action and selects its first operation",
                        "WHEN User is on the last action of a behavior",
                        "THEN System moves to the next behavior and selects its first action and first operation",
                        "WHEN User is on the last behavior of a bot",
                        "THEN System disables next behavior navigation"
                      ],
                      "scenarios": [
                        {
                          "title": "User clicks action and bot navigates to that action",
                          "steps": [
                            "Given Panel displays behavior hierarchy",
                            "And Bot is at shape.clarify",
                            "When User clicks on discovery.build action link",
                            "Then Bot navigates to discovery.build",
                            "And Panel refreshes to show new current position",
                            "And discovery.build is highlighted as current action"
                          ]
                        },
                        {
                          "title": "User navigates forward through actions with next button",
                          "steps": [
                            "Given Bot is at shape.clarify",
                            "When User clicks next button",
                            "Then Bot navigates to shape.strategy",
                            "And Panel displays shape.strategy as current",
                            "And Panel displays shape.strategy in-progress indicator"
                          ]
                        },
                        {
                          "title": "User navigates backward through actions with back button",
                          "steps": [
                            "Given Bot is at shape.strategy",
                            "When User clicks back button",
                            "Then Bot navigates to shape.clarify",
                            "And Panel displays shape.clarify as current",
                            "And Panel displays shape.clarify in-progress indicator"
                          ]
                        },
                        {
                          "title": "User at last action cannot navigate forward",
                          "steps": [
                            "Given Bot is at last action of last behavior",
                            "When User views next button",
                            "Then Next button is disabled"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Execute Behavior Action",
                      "sequential_order": 3,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestExecuteBehaviorAction",
                      "acceptance_criteria": [
                        "WHEN User clicks behavior",
                        "THEN System displays that behavior as current",
                        "AND System expands behavior",
                        "AND System expands first action to display operations",
                        "AND System sets first action as current",
                        "AND System sets first operation as current",
                        "AND System executes first operation of first action of that behavior",
                        "WHEN User clicks action",
                        "THEN System displays that action as current",
                        "AND System expands action to display operations",
                        "AND System sets first operation as current",
                        "AND System executes first operation of that action"
                      ],
                      "scenarios": [
                        {
                          "title": "User clicks behavior to execute",
                          "steps": [
                            "Given Panel displays behavior hierarchy",
                            "And Bot is at shape.clarify",
                            "When User clicks discovery behavior",
                            "Then Bot navigates to discovery.clarify (first action)",
                            "And Panel displays discovery behavior as current",
                            "And Panel expands discovery behavior",
                            "And Panel displays discovery.clarify as current action",
                            "And Bot executes discovery.clarify.instructions operation"
                          ]
                        },
                        {
                          "title": "User clicks action to execute",
                          "steps": [
                            "Given Panel displays expanded shape behavior",
                            "And Bot is at shape.clarify",
                            "When User clicks shape.strategy action",
                            "Then Bot navigates to shape.strategy",
                            "And Panel displays shape.strategy as current action",
                            "And Panel expands shape.strategy showing operations",
                            "And Bot executes shape.strategy.instructions operation"
                          ]
                        },
                        {
                          "title": "User clicks operation to execute",
                          "steps": [
                            "Given Panel displays expanded shape.clarify action",
                            "And Operations are visible (instructions, execute, confirm)",
                            "When User clicks clarify.confirm operation",
                            "Then Bot executes clarify.confirm operation",
                            "And Panel displays confirm operation as current"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "Manage Story Graph Through Panel",
              "sequential_order": 3,
              "sub_epics": [
                {
                  "name": "Manage Story Scope Through Panel",
                  "sequential_order": 3,
                  "test_file": "test_manage_scope.js",
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Filter Story Scope",
                          "sequential_order": 1,
                          "connector": null,
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_class": "TestFilterStoryScope",
                          "acceptance_criteria": [
                            "WHEN User types story name in filter",
                            "THEN System refreshes story hierarchy based on new story scope",
                            "WHEN Filter matches epic",
                            "THEN System displays epic with all sub-epics and stories collapsed beneath it",
                            "WHEN Filter matches sub-epic",
                            "THEN System displays sub-epic with all stories collapsed beneath it",
                            "WHEN Filter matches story",
                            "THEN System displays that story with its acceptance criteria",
                            "WHEN User clicks story with acceptance criteria",
                            "THEN System expands story showing acceptance criteria list",
                            "WHEN Filter matches multiple items",
                            "THEN System displays all matches in hierarchical format preserving parent-child relationships",
                            "WHEN User clicks clear filter button",
                            "THEN System displays all stories",
                            "WHEN User sets scope filter",
                            "THEN System persists scope filter value",
                            "WHEN Panel refreshes",
                            "THEN System restores previously set scope filter"
                          ],
                          "scenarios": [
                            {
                              "title": "User filters scope by story name",
                              "steps": [
                                "Given Panel displays scope section with full story hierarchy",
                                "When User types Open Panel in scope filter",
                                "Then Panel displays filtered hierarchy showing Open Panel story",
                                "And Panel displays Open Panel parent sub-epic (Manage Panel Session)",
                                "And Panel displays parent epic (Invoke Bot Through Panel)"
                              ]
                            },
                            {
                              "title": "User filters scope by epic name",
                              "steps": [
                                "Given Panel displays full story hierarchy",
                                "When User types Invoke Bot in scope filter",
                                "Then Panel displays Invoke Bot epic",
                                "And Panel displays all sub-epics under Invoke Bot",
                                "And Sub-epics are initially collapsed"
                              ]
                            },
                            {
                              "title": "User clears story scope filter",
                              "steps": [
                                "Given Panel displays filtered scope showing only Open Panel story",
                                "When User clicks clear filter button",
                                "Then Panel displays all stories in full hierarchy",
                                "And All epics are visible"
                              ]
                            },
                            {
                              "title": "Scope filter persists across panel refreshes",
                              "steps": [
                                "Given Panel is open",
                                "When User types Open Panel in scope filter",
                                "And Panel displays filtered hierarchy",
                                "And User refreshes panel",
                                "Then Panel displays same filtered hierarchy",
                                "And Scope filter input shows Open Panel",
                                "And Filter value was persisted and restored"
                              ]
                            }
                          ]
                        },
                        {
                          "name": "Show All Scope Through Panel",
                          "sequential_order": 1.5,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_class": "TestShowAllScopeThroughPanel",
                          "acceptance_criteria": [
                            "WHEN User has filtered scope",
                            "THEN System displays Show All button",
                            "WHEN User clicks Show All button",
                            "THEN System calls scope showall command via CLI",
                            "AND System clears scope filter",
                            "AND Panel displays complete unfiltered story hierarchy"
                          ],
                          "scenarios": [
                            {
                              "title": "User clicks show all to clear filter",
                              "test_method": "test_user_clicks_show_all_to_clear_filter",
                              "steps": [
                                "Given Panel displays filtered scope showing only Open Panel story",
                                "And Show All button is visible",
                                "When User clicks Show All button",
                                "Then Panel calls scope showall via CLI",
                                "And Scope filter is cleared",
                                "And Panel displays all epics, sub-epics, and stories",
                                "And Filter input is empty"
                              ]
                            },
                            {
                              "title": "Show all button is visible when scope is filtered",
                              "test_method": "test_show_all_button_is_visible_when_scope_is_filtered",
                              "steps": [
                                "Given Panel has no scope filter applied",
                                "When User views scope section",
                                "Then Show All button is not visible",
                                "When User applies filter to scope",
                                "Then Show All button becomes visible"
                              ]
                            }
                          ]
                        },
                        {
                          "name": "Display Story Scope Hierarchy",
                          "sequential_order": 2,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_class": "TestDisplayStoryScopeHierarchy",
                          "acceptance_criteria": [
                            "WHEN User views story scope",
                            "THEN System displays epic list collapsed",
                            "WHEN User clicks collapsed epic expand icon",
                            "AND epic has sub-epics",
                            "THEN System expands epic showing sub-epics collapsed beneath it",
                            "WHEN User clicks epic name",
                            "AND matching epic folder exists",
                            "THEN System opens epic folder in IDE explorer",
                            "WHEN Epic has test file",
                            "THEN System displays test tube icon next to epic name",
                            "WHEN User clicks epic test link",
                            "THEN System opens test file in editor",
                            "WHEN User clicks collapsed sub-epic expand icon",
                            "AND matching sub-epic has stories",
                            "THEN System expands sub-epic showing stories collapsed beneath it",
                            "WHEN Sub-epic has test file",
                            "THEN System displays test tube icon next to sub-epic name",
                            "WHEN User clicks sub-epic test link",
                            "THEN System opens test file in editor",
                            "WHEN User clicks sub-epic name",
                            "THEN System opens sub-epic folder in IDE explorer",
                            "WHEN User clicks collapsed story expand icon",
                            "AND matching sub-epic has stories",
                            "THEN System expands story showing scenarios collapsed beneath it",
                            "WHEN User clicks story name",
                            "THEN System opens story markdown file in editor",
                            "WHEN Story has test file",
                            "THEN System displays test tube icon next to story name",
                            "WHEN User clicks story test link",
                            "THEN System opens test file at test class",
                            "WHEN User clicks collapsed story expand icon",
                            "THEN System expands story showing scenarios",
                            "WHEN User clicks scenario name",
                            "THEN System opens story markdown file at scenario anchor",
                            "WHEN Scenario has test method",
                            "THEN System displays test tube icon next to scenario name",
                            "WHEN User clicks scenario test link",
                            "THEN System opens test file at scenario test method line",
                            "WHEN Test tube icon is displayed",
                            "THEN System shows correct test tube image",
                            "WHEN User clicks epic or sub-epic or story name",
                            "THEN System opens corresponding file or folder"
                          ],
                          "scenarios": [
                            {
                              "title": "User views nested story tree with epics features and stories",
                              "steps": [
                                "Given Story graph has epics with nested sub-epics",
                                "When User views scope section",
                                "Then Panel displays epic names (Invoke Bot)",
                                "When User expands Invoke Bot epic",
                                "Then Panel displays sub-epics (Invoke Bot Through Panel, Invoke Bot Through REPL)",
                                "When User expands Invoke Bot Through Panel sub-epic",
                                "Then Panel displays nested sub-epics (Manage Panel Session, Navigate Behaviors)",
                                "When User expands Manage Panel Session sub-epic",
                                "Then Panel displays stories (Open Panel, Display Session Status)"
                              ]
                            },
                            {
                              "title": "User clicks test link and file opens at correct location",
                              "steps": [
                                "Given Story has test link displayed",
                                "And Test file is test_manage_panel_session.spec.js",
                                "And Test class is TestOpenPanel",
                                "When User clicks test link for Open Panel story",
                                "Then VS Code opens test_manage_panel_session.spec.js file",
                                "And Editor scrolls to TestOpenPanel class"
                              ]
                            },
                            {
                              "title": "User clicks story file link and story markdown opens",
                              "steps": [
                                "Given Story has story file link displayed",
                                "And Story file is Open Panel.md",
                                "When User clicks story link for Open Panel",
                                "Then VS Code opens Open Panel.md file in editor"
                              ]
                            },
                            {
                              "title": "User clicks test link for missing file",
                              "steps": [
                                "Given Story has test link displayed",
                                "And Test file does not exist",
                                "When User clicks test link",
                                "Then Panel displays error message",
                                "And Error message indicates file not found"
                              ]
                            },
                            {
                              "title": "Test tube icons display with correct image for all items",
                              "steps": [
                                "Given Epic has test file",
                                "And Sub-epic has test file",
                                "And Story has test class",
                                "And Scenario has test method",
                                "When Panel renders scope hierarchy",
                                "Then Test tube icon appears next to epic name",
                                "And Test tube icon appears next to sub-epic name",
                                "And Test tube icon appears next to story name",
                                "And Test tube icon appears next to scenario name",
                                "And All test tube icons show correct test_tube.png image",
                                "And Test tube icons are large enough to see clearly"
                              ]
                            },
                            {
                              "title": "Epic and sub-epic names are clickable hyperlinks",
                              "steps": [
                                "Given Panel displays scope hierarchy with epics and sub-epics",
                                "When User clicks epic name",
                                "Then VS Code reveals epic folder in explorer",
                                "When User clicks sub-epic name",
                                "Then VS Code reveals sub-epic folder in explorer"
                              ]
                            },
                            {
                              "title": "Story names are clickable hyperlinks",
                              "steps": [
                                "Given Panel displays scope hierarchy with stories",
                                "And Story has matching markdown file",
                                "When User clicks story name",
                                "Then VS Code opens story markdown file in editor"
                              ]
                            },
                            {
                              "title": "Scenario test links navigate to exact test method line",
                              "steps": [
                                "Given Story has scenarios with test methods",
                                "And Scenario test method is at line 145 in test file",
                                "When User clicks scenario test tube icon",
                                "Then VS Code opens test file",
                                "And Editor scrolls to line 145",
                                "And Test method definition is visible at cursor"
                              ]
                            },
                            {
                              "title": "Scenario name links navigate to scenario anchor in story file",
                              "steps": [
                                "Given Story markdown file has scenario sections with anchors",
                                "And Scenario is named User expands collapsed section",
                                "When User clicks scenario name in panel",
                                "Then VS Code opens story markdown file",
                                "And Editor scrolls to scenario anchor",
                                "And Scenario section is visible with heading"
                              ]
                            },
                            {
                              "title": "Folder links open in explorer",
                              "steps": [
                                "Given Epic has matching folder in docs/stories/map",
                                "And Sub-epic has matching folder",
                                "When User clicks epic name link",
                                "Then VS Code reveals folder in explorer view",
                                "When User clicks sub-epic name link",
                                "Then VS Code reveals sub-epic folder in explorer view"
                              ]
                            }
                          ]
                        },
                        {
                          "name": "Filter File Scope",
                          "sequential_order": 3,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_class": "TestFilterFileScope",
                          "acceptance_criteria": [
                            "WHEN User types file pattern in filter",
                            "THEN System displays filtered file list",
                            "AND System displays file list with monospace paths"
                          ],
                          "scenarios": [
                            {
                              "title": "User filters scope by file pattern",
                              "steps": [
                                "Given Panel displays scope section",
                                "When User types file:src/**/*.py in scope filter",
                                "Then Panel displays file scope mode",
                                "And Panel displays list of Python files in src directory",
                                "And File paths are displayed in monospace font"
                              ]
                            },
                            {
                              "title": "User filters scope by specific file extension",
                              "steps": [
                                "Given Panel displays scope section",
                                "When User types file:**/*.spec.js in scope filter",
                                "Then Panel displays all JavaScript test files",
                                "And Files are displayed with full relative paths"
                              ]
                            }
                          ]
                        },
                        {
                          "name": "Open Story Files",
                          "sequential_order": 9,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_class": "TestOpenStoryFiles",
                          "acceptance_criteria": [
                            "WHEN User clicks graph link",
                            "THEN System opens story-graph.json in editor",
                            "WHEN User clicks map link",
                            "THEN System opens story-map.drawio in diagram viewer",
                            "WHEN System cannot open file",
                            "THEN System displays error message"
                          ],
                          "scenarios": [
                            {
                              "title": "User opens story graph JSON file",
                              "steps": [
                                "Given Panel displays scope section with graph link",
                                "When User clicks Graph link",
                                "Then VS Code opens story-graph.json in editor",
                                "And File is displayed with JSON syntax highlighting"
                              ]
                            },
                            {
                              "title": "User opens story map diagram",
                              "steps": [
                                "Given Panel displays scope section with map link",
                                "When User clicks map link",
                                "Then VS Code opens story-map.drawio in diagram viewer",
                                "And Diagram is displayed with Draw.io extension"
                              ]
                            },
                            {
                              "title": "System cannot open missing file",
                              "steps": [
                                "Given Panel displays link to non-existent file",
                                "When User clicks link",
                                "Then Panel displays error message",
                                "And Error message indicates file not found"
                              ]
                            },
                            {
                              "title": "Story graph and story map links always visible",
                              "test_method": "test_story_graph_and_story_map_links_always_visible",
                              "steps": [
                                "Given Panel displays scope section",
                                "And Scope may be filtered or showing all stories",
                                "When User views scope header",
                                "Then story-graph.json link is always visible",
                                "And story-map.md link is always visible",
                                "And Links persist regardless of filter state",
                                "And Links are positioned consistently in header"
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Manage File Scope Through Panel",
                  "sequential_order": 2,
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Filter File Scope",
                          "sequential_order": 1,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestFilterFileScope",
                          "scenarios": []
                        },
                        {
                          "name": "Display All Files For Behavior",
                          "sequential_order": 2,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestDisplayAllFilesForBehavior",
                          "scenarios": []
                        },
                        {
                          "name": "Add Filter Part To File Scope",
                          "sequential_order": 3,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestAddFilterPartToFileScope",
                          "scenarios": []
                        },
                        {
                          "name": "Remove Filter Part From File Scope",
                          "sequential_order": 4,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestRemoveFilterPartFromFileScope",
                          "scenarios": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Edit Story Graph In Panel",
                  "sequential_order": 3,
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Add Child Story Node To Parent",
                          "sequential_order": 1,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestAddChildStoryNodeToParent",
                          "scenarios": []
                        },
                        {
                          "name": "Delete Story Node From Parent",
                          "sequential_order": 2,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestDeleteStoryNodeFromParent",
                          "scenarios": []
                        },
                        {
                          "name": "Update Story Node name",
                          "sequential_order": 3,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestUpdateStoryNodename",
                          "scenarios": []
                        },
                        {
                          "name": "Move Story Node",
                          "sequential_order": 4,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestMoveStoryNode",
                          "scenarios": []
                        },
                        {
                          "name": "Submit Action Scoped To Story Scope",
                          "sequential_order": 5,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestSubmitActionScopedToStoryScope",
                          "scenarios": []
                        },
                        {
                          "name": "Automatically Refresh Story Graph Changes",
                          "sequential_order": 6,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestAutomaticallyRefreshStoryGraphChanges",
                          "scenarios": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Edit Increments In Panel",
                  "sequential_order": 4,
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Add Increment",
                          "sequential_order": 1,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestAddIncrement",
                          "scenarios": []
                        },
                        {
                          "name": "Delete Increment",
                          "sequential_order": 2,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestDeleteIncrement",
                          "scenarios": []
                        },
                        {
                          "name": "Move Story to Increment",
                          "sequential_order": 3,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestMoveStorytoIncrement",
                          "scenarios": []
                        },
                        {
                          "name": "Show All Increment Scope Through Panel",
                          "sequential_order": 4,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestShowAllIncrementScopeThroughPanel",
                          "scenarios": []
                        },
                        {
                          "name": "Submit Action Scoped To Increment",
                          "sequential_order": 5,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestSubmitActionScopedToIncrement",
                          "scenarios": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "Display Action Instructions Through Panel",
              "sequential_order": 4,
              "test_file": "test_display_instructions.js",
              "story_groups": [
                {
                  "type": "and",
                  "connector": null,
                  "stories": [
                    {
                      "name": "Display Base Instructions",
                      "sequential_order": 1,
                      "connector": null,
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestDisplayBaseInstructions",
                      "acceptance_criteria": [
                        "WHEN User views panel",
                        "THEN System displays base instructions section",
                        "AND System displays behavior name",
                        "AND System displays action name"
                      ],
                      "scenarios": [
                        {
                          "title": "User views base instructions for current action",
                          "steps": [
                            "Given Bot is at shape.clarify",
                            "When Panel displays instructions section",
                            "Then Panel displays base instructions",
                            "And Panel displays behavior name (shape)",
                            "And Panel displays action name (clarify)",
                            "And Instructions are scrollable"
                          ]
                        },
                        {
                          "title": "User copies base instructions to clipboard",
                          "steps": [
                            "Given Panel displays base instructions",
                            "When User clicks copy button",
                            "Then Instructions are copied to clipboard",
                            "And Panel displays confirmation message"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Display Clarify Instructions",
                      "sequential_order": 2,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestDisplayClarifyInstructions",
                      "acceptance_criteria": [
                        "WHEN Current action is clarify",
                        "THEN System displays key questions with editable answer textareas",
                        "AND System displays evidence list",
                        "WHEN User edits answer textarea",
                        "THEN System updates answer",
                        "WHEN saved key questions and answers exists",
                        "THEN System displays saved key questions and answers",
                        "WHEN User is on non-clarify actions and has previously made strategy decisions",
                        "THEN System displays saved strategy decisions and criteria as read-only"
                      ],
                      "scenarios": [
                        {
                          "title": "User views clarify instructions with key questions",
                          "steps": [
                            "Given Bot is at shape.clarify",
                            "And Guardrails define key questions and evidence",
                            "When Panel displays instructions section",
                            "Then Panel displays key questions list",
                            "And Panel displays evidence requirements",
                            "And Each question has editable textarea for answers"
                          ]
                        },
                        {
                          "title": "User edits answer to key question",
                          "steps": [
                            "Given Panel displays clarify instructions with questions",
                            "When User types answer in question textarea",
                            "Then System saves answer",
                            "And Answer persists across panel refreshes"
                          ]
                        },
                        {
                          "title": "User views saved clarification answers",
                          "steps": [
                            "Given User has previously answered clarify questions",
                            "And Answers are saved in clarification.json",
                            "When Panel displays clarify instructions",
                            "Then Panel displays saved answers in textareas"
                          ]
                        },
                        {
                          "title": "User views strategy guardrails in clarify action",
                          "test_method": "test_user_views_strategy_guardrails_in_clarify_action",
                          "steps": [
                            "Given Bot is at shape.clarify",
                            "And User has previously made strategy decisions",
                            "When Panel displays clarify instructions",
                            "Then Panel displays Strategy section",
                            "And Strategy section shows all decision criteria with selected options",
                            "And Strategy section shows saved assumptions",
                            "And Strategy data is read-only (not editable in clarify action)"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Display Strategy Instructions",
                      "sequential_order": 3,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestDisplayStrategyInstructions",
                      "acceptance_criteria": [
                        "WHEN Current action is strategy",
                        "THEN System displays decision criteria with radio button options",
                        "AND System displays assumptions textarea",
                        "WHEN Saved strategy exists",
                        "THEN System displays selected option for each decision criterion",
                        "AND Assumptions textarea remains editable",
                        "AND Textarea is pre-filled with saved assumptions",
                        "WHEN User edits assumptions textarea",
                        "THEN System updates assumptions",
                        "WHEN User is on non-strategy actions (clarify, build, validate, render)",
                        "THEN System displays saved strategy decisions and criteria as read-only"
                      ],
                      "scenarios": [
                        {
                          "title": "User views strategy instructions with decision criteria",
                          "steps": [
                            "Given Bot is at shape.strategy",
                            "When Panel displays instructions section",
                            "Then Panel displays decision criteria with radio options",
                            "And Panel displays assumptions textarea",
                            "And User can select option for each criterion"
                          ]
                        },
                        {
                          "title": "User selects strategy decision criterion",
                          "steps": [
                            "Given Panel displays strategy instructions",
                            "When User selects radio option for decision criterion",
                            "Then System saves selected option",
                            "And Selection persists across panel refreshes"
                          ]
                        },
                        {
                          "title": "Assumptions textarea remains editable after being saved",
                          "test_method": "test_assumptions_textarea_remains_editable_after_being_saved",
                          "steps": [
                            "Given Bot is at shape.strategy",
                            "And User has previously saved assumptions",
                            "When Panel displays strategy instructions",
                            "Then Assumptions textarea is displayed as editable input",
                            "And Textarea is pre-filled with saved assumptions",
                            "And User can edit and update assumptions"
                          ]
                        },
                        {
                          "title": "User views clarify answers in strategy action",
                          "test_method": "test_user_views_clarify_answers_in_strategy_action",
                          "steps": [
                            "Given Bot is at shape.strategy",
                            "And User has previously answered clarify questions",
                            "When Panel displays strategy instructions",
                            "Then Panel displays Clarify section",
                            "And Clarify section shows answered questions",
                            "And Clarify data is read-only (not editable in strategy action)"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Display Build Instructions",
                      "sequential_order": 4,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestDisplayBuildInstructions",
                      "acceptance_criteria": [
                        "WHEN Current action is build",
                        "THEN System displays knowledge graph section with template path link",
                        "AND System displays knowledge graph output file link",
                        "AND System displays knowledge graph directory path",
                        "AND System displays rules list with clickable rule file links"
                      ],
                      "scenarios": [
                        {
                          "title": "User views build instructions with knowledge graph info",
                          "steps": [
                            "Given Bot is at shape.build",
                            "When Panel displays instructions section",
                            "Then Panel displays knowledge graph template link",
                            "And Panel displays knowledge graph output file link",
                            "And Panel displays rules list with clickable links"
                          ]
                        },
                        {
                          "title": "User clicks knowledge graph template link",
                          "steps": [
                            "Given Panel displays build instructions",
                            "When User clicks template path link",
                            "Then VS Code opens knowledge graph template file in editor"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Display Validate Instructions",
                      "sequential_order": 5,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestDisplayValidateInstructions",
                      "acceptance_criteria": [
                        "WHEN Current action is validate",
                        "THEN System displays rules list",
                        "WHEN User clicks rule file link",
                        "THEN System opens rule file in editor"
                      ],
                      "scenarios": [
                        {
                          "title": "User views validate instructions with rules list",
                          "steps": [
                            "Given Bot is at shape.validate",
                            "When Panel displays instructions section",
                            "Then Panel displays validation rules list",
                            "And Each rule has clickable file link"
                          ]
                        },
                        {
                          "title": "User clicks validation rule file link",
                          "steps": [
                            "Given Panel displays validate instructions with rules",
                            "When User clicks rule file link",
                            "Then VS Code opens validation rule file in editor"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Display Render Instructions",
                      "sequential_order": 6,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestDisplayRenderInstructions",
                      "acceptance_criteria": [
                        "WHEN Current action is render",
                        "THEN System displays config file paths as clickable links",
                        "AND System displays template file paths as clickable links",
                        "AND System displays output file paths as clickable links",
                        "WHEN User clicks on any of these links",
                        "THEN System opens the corresponding file in the editor"
                      ],
                      "scenarios": [
                        {
                          "title": "User views render instructions with config and template links",
                          "steps": [
                            "Given Bot is at shape.render",
                            "When Panel displays instructions section",
                            "Then Panel displays config file paths as clickable links",
                            "And Panel displays template file paths as clickable links",
                            "And Panel displays output file paths as clickable links"
                          ]
                        },
                        {
                          "title": "User clicks render config file link",
                          "steps": [
                            "Given Panel displays render instructions",
                            "When User clicks config file link",
                            "Then VS Code opens render config file in editor"
                          ]
                        },
                        {
                          "title": "User clicks template file link",
                          "steps": [
                            "Given Panel displays render instructions",
                            "When User clicks template file link",
                            "Then VS Code opens template file in editor"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Submit Behavior Rules Through Panel",
                      "sequential_order": 6.5,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestSubmitBehaviorRulesThroughPanel",
                      "acceptance_criteria": [
                        "WHEN User clicks Get Rules button for a behavior",
                        "THEN System executes behavior.rules command",
                        "AND System submits rules digest to AI chat",
                        "AND Rules include formatted descriptions with DO/DON'T sections",
                        "AND Rules include file paths for each rule",
                        "AND All behavior rules are included in digest"
                      ],
                      "scenarios": [
                        {
                          "title": "User clicks get rules button for behavior",
                          "steps": [
                            "Given Panel displays behavior hierarchy",
                            "And Behavior has rules defined",
                            "When User clicks Get Rules button for behavior",
                            "Then System executes behavior.rules command via CLI",
                            "And System submits formatted rules digest to AI chat",
                            "And Rules digest includes descriptions, priorities, DO/DON'T sections",
                            "And Rules digest includes file paths for each rule"
                          ],
                          "test_method": "test_user_clicks_get_rules_button_for_behavior"
                        },
                        {
                          "title": "Get rules button visible for behaviors with rules",
                          "steps": [
                            "Given Panel displays behavior hierarchy",
                            "And Behavior has rules defined",
                            "When User views behavior in hierarchy",
                            "Then Get Rules button is visible next to behavior name"
                          ],
                          "test_method": "test_get_rules_button_visible_for_behaviors_with_rules"
                        },
                        {
                          "title": "System confirms rules submission to chat",
                          "steps": [
                            "Given Panel displays behavior hierarchy",
                            "When User clicks Get Rules button",
                            "And Rules are successfully submitted to chat",
                            "Then System displays success confirmation message",
                            "And Message indicates rules were submitted to chat"
                          ],
                          "test_method": "test_system_confirms_rules_submission_to_chat"
                        }
                      ]
                    },
                    {
                      "name": "Display Instructions In Raw Format",
                      "sequential_order": 7,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestDisplayInstructionsInRawFormat",
                      "acceptance_criteria": [
                        "WHEN User clicks action instruction in Behavior Action Hierarchy",
                        "THEN System displays entire instructions exactly as it should be sent to the AI chat"
                      ],
                      "scenarios": [
                        {
                          "title": "User views instructions in raw format",
                          "steps": [
                            "Given Panel displays formatted instructions",
                            "When User clicks raw format toggle button",
                            "Then Panel displays instructions in raw text format",
                            "And Instructions show exactly as they would be sent to AI",
                            "And Raw format is scrollable"
                          ]
                        },
                        {
                          "title": "User switches from raw to formatted view",
                          "steps": [
                            "Given Panel displays instructions in raw format",
                            "When User clicks formatted view toggle button",
                            "Then Panel displays instructions in formatted view",
                            "And Instructions show with sections and styling"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Submit Instructions To AI Agent",
                      "sequential_order": 8,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestSubmitInstructionsToAIAgent",
                      "acceptance_criteria": [
                        "When user has clicked on a Behavior Action's Instructions",
                        "AND User clicks submit button",
                        "THEN System sends instructions to AI chat",
                        "WHEN User clicks submit button",
                        "THEN Submitted instructions include scope section",
                        "AND Scope section includes scope type (story/files/all)",
                        "AND Scope section includes scope filter values",
                        "AND Scope section includes complete story graph tree when scope is story-based",
                        "WHEN User has answered clarify questions or made strategy decisions",
                        "THEN Submitted instructions include all saved guardrails"
                      ],
                      "scenarios": [
                        {
                          "title": "User submits instructions to AI chat",
                          "steps": [
                            "Given Panel displays instructions for current action",
                            "When User clicks submit button",
                            "Then System sends instructions to Cursor AI chat",
                            "And Panel displays success confirmation message",
                            "And AI chat receives instructions"
                          ]
                        },
                        {
                          "title": "User submits instructions when chat is not available",
                          "steps": [
                            "Given Panel displays instructions",
                            "And Cursor AI chat is not available",
                            "When User clicks submit button",
                            "Then Panel displays error message",
                            "And Error message indicates chat unavailable"
                          ]
                        },
                        {
                          "title": "User copies instructions before submitting",
                          "steps": [
                            "Given Panel displays instructions",
                            "When User clicks copy button",
                            "Then Instructions are copied to clipboard",
                            "When User clicks submit button",
                            "Then Instructions are also sent to AI chat"
                          ]
                        },
                        {
                          "title": "Submitted instructions include complete scope with story tree",
                          "test_method": "test_submitted_instructions_include_complete_scope_with_story_tree",
                          "steps": [
                            "Given Bot has scope set to story Open Panel",
                            "And Scope.results contains full story graph hierarchy",
                            "When User clicks submit in panel",
                            "Then Submitted instructions contain Scope section at top",
                            "And Scope section shows Story Scope: Open Panel",
                            "And Scope section shows complete epic/sub-epic/story hierarchy"
                          ]
                        },
                        {
                          "title": "Submitted instructions include all guardrails",
                          "test_method": "test_submitted_instructions_include_all_guardrails",
                          "steps": [
                            "Given Bot is at shape.build",
                            "And User has answered clarify questions",
                            "And User has made strategy decisions",
                            "When User clicks submit in panel",
                            "Then Submitted instructions include Clarify section with answers",
                            "And Submitted instructions include Strategy section with decisions and assumptions",
                            "And All saved guardrails are visible in submitted markdown"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "Save Guardrails Through Panel",
                      "sequential_order": 9,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestSaveGuardrailsThroughPanel",
                      "acceptance_criteria": [
                        "WHEN User fills in answers in panel form",
                        "THEN System validates input format",
                        "AND System enables submit button",
                        "WHEN User clicks submit for answers",
                        "THEN System saves answers to clarification.json under current behavior",
                        "AND System merges with existing answers",
                        "AND System displays success message"
                      ],
                      "scenarios": [
                        {
                          "title": "Panel displays save button for clarify action",
                          "steps": [
                            "Given Bot is at shape.clarify",
                            "When Panel renders clarify instructions",
                            "Then Panel displays save button for answers",
                            "And Panel displays save button for evidence"
                          ],
                          "test_method": "test_panel_displays_save_button_for_clarify_action"
                        },
                        {
                          "title": "Panel displays save button for strategy action",
                          "steps": [
                            "Given Bot is at shape.strategy",
                            "When Panel renders strategy instructions",
                            "Then Panel displays save button for decisions",
                            "And Panel displays save button for assumptions"
                          ],
                          "test_method": "test_panel_displays_save_button_for_strategy_action"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Invoke Bot Through REPL",
          "sequential_order": 10.0,
          "domain_concepts": [
            {
              "name": "REPLSession",
              "module": "repl_cli",
              "responsibilities": [
                {
                  "name": "Runs REPL loop",
                  "collaborators": []
                },
                {
                  "name": "Reads input from stdin or terminal",
                  "collaborators": []
                },
                {
                  "name": "Determine channel adapter",
                  "collaborators": [
                    "ChannelAdapter"
                  ]
                },
                {
                  "name": "Read and execute command",
                  "collaborators": [
                    "Command String",
                    "REPLCommandResponse"
                  ]
                },
                {
                  "name": "Parse command",
                  "collaborators": [
                    "Command String",
                    "Command Verb",
                    "Params"
                  ]
                },
                {
                  "name": "Route to bot domain methods",
                  "collaborators": [
                    "Bot",
                    "Command Verb",
                    "Params",
                    "BotResult"
                  ]
                },
                {
                  "name": "Serializes via channel adapter",
                  "collaborators": [
                    "ChannelAdapter",
                    "String"
                  ]
                },
                {
                  "name": "Displays serialized output",
                  "collaborators": [
                    "Stdout"
                  ]
                }
              ]
            },
            {
              "name": "ChannelAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize domain object to format",
                  "collaborators": [
                    "Domain Object",
                    "Format"
                  ]
                },
                {
                  "name": "Deserialize format to domain object",
                  "collaborators": [
                    "Format",
                    "Domain Object"
                  ]
                }
              ]
            },
            {
              "name": "JSONAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize to JSON dict",
                  "collaborators": [
                    "Dict"
                  ]
                },
                {
                  "name": "Deserialize JSON dict",
                  "collaborators": [
                    "Dict",
                    "Domain Object"
                  ]
                },
                {
                  "name": "Convert to JSON string",
                  "collaborators": [
                    "Dict",
                    "String"
                  ]
                },
                {
                  "name": "Parse JSON string",
                  "collaborators": [
                    "String",
                    "Dict"
                  ]
                },
                {
                  "name": "Validate JSON structure",
                  "collaborators": [
                    "Dict",
                    "Schema"
                  ]
                }
              ]
            },
            {
              "name": "JSONStatusAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Include status fields",
                  "collaborators": [
                    "Is Completed",
                    "Is Current"
                  ]
                },
                {
                  "name": "Include completion markers",
                  "collaborators": [
                    "Status String"
                  ]
                }
              ]
            },
            {
              "name": "JSONBotAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize bot to JSON dict",
                  "collaborators": [
                    "Bot",
                    "Dict"
                  ]
                },
                {
                  "name": "Include bot metadata",
                  "collaborators": [
                    "Name",
                    "Directory",
                    "Paths"
                  ]
                },
                {
                  "name": "Include behaviors",
                  "collaborators": [
                    "Behaviors",
                    "Array"
                  ]
                },
                {
                  "name": "Wraps domain bot",
                  "collaborators": [
                    "Bot"
                  ]
                }
              ]
            },
            {
              "name": "JSONBehaviorAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize behavior to JSON dict",
                  "collaborators": [
                    "Behavior",
                    "Dict"
                  ]
                },
                {
                  "name": "Include behavior metadata",
                  "collaborators": [
                    "Name",
                    "Description",
                    "Status"
                  ]
                },
                {
                  "name": "Include actions",
                  "collaborators": [
                    "Actions",
                    "Array"
                  ]
                },
                {
                  "name": "Wraps domain behavior",
                  "collaborators": [
                    "Behavior"
                  ]
                }
              ]
            },
            {
              "name": "JSONActionAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize action to JSON dict",
                  "collaborators": [
                    "Action",
                    "Dict"
                  ]
                },
                {
                  "name": "Include action metadata",
                  "collaborators": [
                    "Name",
                    "Description",
                    "Status"
                  ]
                },
                {
                  "name": "Wraps domain action",
                  "collaborators": [
                    "Action"
                  ]
                }
              ]
            },
            {
              "name": "JSONScopeAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize scope to JSON dict",
                  "collaborators": [
                    "Scope",
                    "Dict"
                  ]
                },
                {
                  "name": "Include scope type",
                  "collaborators": [
                    "Scope Type",
                    "String"
                  ]
                },
                {
                  "name": "Include scope values",
                  "collaborators": [
                    "List",
                    "Array"
                  ]
                },
                {
                  "name": "Include filtered files",
                  "collaborators": [
                    "Files",
                    "Array"
                  ]
                },
                {
                  "name": "Wraps domain scope",
                  "collaborators": [
                    "Scope"
                  ]
                }
              ]
            },
            {
              "name": "JSONInstructionsAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize instructions to JSON",
                  "collaborators": [
                    "Instructions",
                    "Dict"
                  ]
                },
                {
                  "name": "Include instruction sections",
                  "collaborators": [
                    "Sections",
                    "Array"
                  ]
                },
                {
                  "name": "Wraps domain instructions",
                  "collaborators": [
                    "Instructions"
                  ]
                }
              ]
            },
            {
              "name": "JSONHelpAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize help to JSON",
                  "collaborators": [
                    "Help",
                    "Dict"
                  ]
                },
                {
                  "name": "Include help sections",
                  "collaborators": [
                    "Sections",
                    "Array"
                  ]
                },
                {
                  "name": "Wraps domain help",
                  "collaborators": [
                    "Help"
                  ]
                }
              ]
            },
            {
              "name": "TextAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Parse command text",
                  "collaborators": [
                    "Text String",
                    "Command",
                    "Params"
                  ]
                }
              ]
            },
            {
              "name": "TTYAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize to TTY text",
                  "collaborators": [
                    "Domain Object",
                    "String"
                  ]
                },
                {
                  "name": "Deserialize TTY text",
                  "collaborators": [
                    "String",
                    "Domain Object"
                  ]
                },
                {
                  "name": "Add color",
                  "collaborators": [
                    "Text",
                    "Color"
                  ]
                },
                {
                  "name": "Format indentation",
                  "collaborators": [
                    "Indent Level",
                    "Spaces"
                  ]
                }
              ]
            },
            {
              "name": "TTYStatusAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Format line with marker",
                  "collaborators": [
                    "Marker",
                    "Text",
                    "Indent"
                  ]
                },
                {
                  "name": "Render marker",
                  "collaborators": [
                    "Status",
                    "Completion"
                  ]
                }
              ]
            },
            {
              "name": "TTYBotAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize bot to TTY",
                  "collaborators": [
                    "Bot",
                    "String"
                  ]
                },
                {
                  "name": "Format bot header",
                  "collaborators": [
                    "Bot Name",
                    "String"
                  ]
                },
                {
                  "name": "Format behaviors",
                  "collaborators": [
                    "Behaviors",
                    "String"
                  ]
                },
                {
                  "name": "Wraps domain bot",
                  "collaborators": [
                    "Bot"
                  ]
                }
              ]
            },
            {
              "name": "TTYBehaviorAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize behavior to TTY",
                  "collaborators": [
                    "Behavior",
                    "String"
                  ]
                },
                {
                  "name": "Format behavior line",
                  "collaborators": [
                    "Behavior Name",
                    "Marker",
                    "Color"
                  ]
                },
                {
                  "name": "Format actions",
                  "collaborators": [
                    "Actions",
                    "String"
                  ]
                },
                {
                  "name": "Wraps domain behavior",
                  "collaborators": [
                    "Behavior"
                  ]
                }
              ]
            },
            {
              "name": "TTYActionAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize action to TTY",
                  "collaborators": [
                    "Action",
                    "String"
                  ]
                },
                {
                  "name": "Format action line",
                  "collaborators": [
                    "Action Name",
                    "Marker",
                    "Indent"
                  ]
                },
                {
                  "name": "Wraps domain action",
                  "collaborators": [
                    "Action"
                  ]
                }
              ]
            },
            {
              "name": "TTYScopeAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize scope to TTY",
                  "collaborators": [
                    "Scope",
                    "String"
                  ]
                },
                {
                  "name": "Format scope type",
                  "collaborators": [
                    "Scope Type",
                    "String"
                  ]
                },
                {
                  "name": "Format scope values",
                  "collaborators": [
                    "List",
                    "String"
                  ]
                },
                {
                  "name": "Wraps domain scope",
                  "collaborators": [
                    "Scope"
                  ]
                }
              ]
            },
            {
              "name": "TTYInstructionsAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize instructions to TTY",
                  "collaborators": [
                    "Instructions",
                    "String"
                  ]
                },
                {
                  "name": "Format instruction sections",
                  "collaborators": [
                    "Sections",
                    "String"
                  ]
                },
                {
                  "name": "Wraps domain instructions",
                  "collaborators": [
                    "Instructions"
                  ]
                }
              ]
            },
            {
              "name": "TTYHelpAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize help to TTY",
                  "collaborators": [
                    "Help",
                    "String"
                  ]
                },
                {
                  "name": "Format help sections",
                  "collaborators": [
                    "Sections",
                    "String"
                  ]
                },
                {
                  "name": "Wraps domain help",
                  "collaborators": [
                    "Help"
                  ]
                }
              ]
            },
            {
              "name": "MarkdownAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize to Markdown",
                  "collaborators": [
                    "String"
                  ]
                },
                {
                  "name": "Deserialize Markdown",
                  "collaborators": [
                    "String",
                    "Domain Object"
                  ]
                },
                {
                  "name": "Parse markdown sections",
                  "collaborators": [
                    "Markdown",
                    "Sections"
                  ]
                },
                {
                  "name": "Format header",
                  "collaborators": [
                    "Level",
                    "Text"
                  ]
                },
                {
                  "name": "Format list item",
                  "collaborators": [
                    "Marker",
                    "Text",
                    "Indent"
                  ]
                },
                {
                  "name": "Format code block",
                  "collaborators": [
                    "Language",
                    "Content"
                  ]
                }
              ]
            },
            {
              "name": "MarkdownStatusAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Render status marker",
                  "collaborators": [
                    "Status",
                    "Marker String"
                  ]
                },
                {
                  "name": "Format status line",
                  "collaborators": [
                    "Name",
                    "Status",
                    "String"
                  ]
                }
              ]
            },
            {
              "name": "MarkdownBotAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize bot to Markdown",
                  "collaborators": [
                    "Bot",
                    "String"
                  ]
                },
                {
                  "name": "Format bot documentation",
                  "collaborators": [
                    "Bot Name",
                    "Description",
                    "Header"
                  ]
                },
                {
                  "name": "Format behaviors",
                  "collaborators": [
                    "Behaviors",
                    "Markdown Sections"
                  ]
                },
                {
                  "name": "Wraps domain bot",
                  "collaborators": [
                    "Bot"
                  ]
                }
              ]
            },
            {
              "name": "MarkdownBehaviorAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize behavior to Markdown",
                  "collaborators": [
                    "Behavior",
                    "String"
                  ]
                },
                {
                  "name": "Format behavior documentation",
                  "collaborators": [
                    "Behavior Name",
                    "Description",
                    "Section"
                  ]
                },
                {
                  "name": "Format actions",
                  "collaborators": [
                    "Actions",
                    "Markdown Subsections"
                  ]
                },
                {
                  "name": "Wraps domain behavior",
                  "collaborators": [
                    "Behavior"
                  ]
                }
              ]
            },
            {
              "name": "MarkdownActionAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize action to Markdown",
                  "collaborators": [
                    "Action",
                    "String"
                  ]
                },
                {
                  "name": "Format action documentation",
                  "collaborators": [
                    "Action Name",
                    "Description",
                    "Subsection"
                  ]
                },
                {
                  "name": "Wraps domain action",
                  "collaborators": [
                    "Action"
                  ]
                }
              ]
            },
            {
              "name": "MarkdownScopeAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize scope to Markdown",
                  "collaborators": [
                    "Scope",
                    "String"
                  ]
                },
                {
                  "name": "Format scope documentation",
                  "collaborators": [
                    "Scope Type",
                    "Values",
                    "Section"
                  ]
                },
                {
                  "name": "Wraps domain scope",
                  "collaborators": [
                    "Scope"
                  ]
                }
              ]
            },
            {
              "name": "MarkdownInstructionsAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize instructions to Markdown",
                  "collaborators": [
                    "Instructions",
                    "String"
                  ]
                },
                {
                  "name": "Format instruction sections",
                  "collaborators": [
                    "Sections",
                    "Markdown"
                  ]
                },
                {
                  "name": "Wraps domain instructions",
                  "collaborators": [
                    "Instructions"
                  ]
                }
              ]
            },
            {
              "name": "MarkdownHelpAdapter",
              "module": "repl_cli.adapters",
              "responsibilities": [
                {
                  "name": "Serialize help to Markdown",
                  "collaborators": [
                    "Help",
                    "String"
                  ]
                },
                {
                  "name": "Format help sections",
                  "collaborators": [
                    "Sections",
                    "Markdown"
                  ]
                },
                {
                  "name": "Wraps domain help",
                  "collaborators": [
                    "Help"
                  ]
                }
              ]
            },
            {
              "name": "CLIBot",
              "module": "repl_cli.cli_bot",
              "responsibilities": [
                {
                  "name": "Get name: str",
                  "collaborators": []
                },
                {
                  "name": "Get workspace directory: Path",
                  "collaborators": []
                },
                {
                  "name": "Get behaviors: CLIBehaviors",
                  "collaborators": [
                    "CLIBehaviors"
                  ]
                },
                {
                  "name": "Get status text: str",
                  "collaborators": [
                    "CLIBehaviors",
                    "CLIBehavior",
                    "CLIActions",
                    "CLIAction"
                  ]
                },
                {
                  "name": "Wraps domain bot",
                  "collaborators": [
                    "Bot"
                  ]
                }
              ]
            },
            {
              "name": "CLIBehaviors",
              "module": "repl_cli.cli_bot",
              "responsibilities": [
                {
                  "name": "Get all: List[CLIBehavior]",
                  "collaborators": [
                    "CLIBehavior"
                  ]
                },
                {
                  "name": "Get current: CLIBehavior",
                  "collaborators": [
                    "CLIBehavior"
                  ]
                },
                {
                  "name": "Find by name: CLIBehavior",
                  "collaborators": [
                    "CLIBehavior"
                  ]
                },
                {
                  "name": "Wraps domain behaviors",
                  "collaborators": [
                    "Behaviors"
                  ]
                }
              ]
            },
            {
              "name": "CLIBehavior",
              "module": "repl_cli.cli_bot",
              "responsibilities": [
                {
                  "name": "Get name: str",
                  "collaborators": []
                },
                {
                  "name": "Get description: str",
                  "collaborators": []
                },
                {
                  "name": "Get actions: CLIActions",
                  "collaborators": [
                    "CLIActions"
                  ]
                },
                {
                  "name": "Is current: bool",
                  "collaborators": []
                },
                {
                  "name": "Wraps domain behavior",
                  "collaborators": [
                    "Behavior"
                  ]
                }
              ]
            },
            {
              "name": "CLIActions",
              "module": "repl_cli.cli_bot",
              "responsibilities": [
                {
                  "name": "Get all: List[CLIAction]",
                  "collaborators": [
                    "CLIAction"
                  ]
                },
                {
                  "name": "Get current: CLIAction",
                  "collaborators": [
                    "CLIAction"
                  ]
                },
                {
                  "name": "Find by name: CLIAction",
                  "collaborators": [
                    "CLIAction"
                  ]
                },
                {
                  "name": "Wraps domain actions",
                  "collaborators": [
                    "Actions"
                  ]
                }
              ]
            },
            {
              "name": "CLIAction",
              "module": "repl_cli.cli_bot",
              "responsibilities": [
                {
                  "name": "Get name: str",
                  "collaborators": []
                },
                {
                  "name": "Get description: str",
                  "collaborators": []
                },
                {
                  "name": "Is current: bool",
                  "collaborators": []
                },
                {
                  "name": "Is completed: bool",
                  "collaborators": []
                },
                {
                  "name": "Executes: ActionResult",
                  "collaborators": [
                    "Action"
                  ]
                },
                {
                  "name": "Wraps domain action",
                  "collaborators": [
                    "Action"
                  ]
                }
              ]
            }
          ],
          "background": {},
          "sub_epics": [
            {
              "name": "Initialize CLI Session",
              "sequential_order": 1,
              "test_file": "test_initialize_cli_session.py",
              "story_groups": [
                {
                  "type": "and",
                  "connector": null,
                  "stories": [
                    {
                      "name": "Launch CLI in Interactive Mode",
                      "sequential_order": 1,
                      "connector": null,
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestStartCLISessionInTTYMode",
                      "scenarios": [
                        {
                          "name": "CLI launches in interactive mode",
                          "steps": "GIVEN: CLISession is configured for interactive mode (TTY detected)\nWHEN: user runs CLI\nTHEN: CLISession wraps Bot\nAND: CLI can execute commands\nAND: CLI uses TTY adapters for output",
                          "test_method": "test_cli_launches_in_interactive_mode"
                        },
                        {
                          "name": "CLI loads existing behavior action state on launch",
                          "steps": "GIVEN: CLISession is configured for interactive mode\nAND: behavior action state file exists\nWHEN: user runs CLI\nTHEN: Bot loads stored behavior action state",
                          "test_method": "test_cli_loads_existing_behavior_action_state_on_launch"
                        },
                        {
                          "name": "CLI displays status on launch",
                          "steps": "GIVEN: CLISession is initialized in interactive mode\nWHEN: user executes 'status' command\nTHEN: CLI displays complete status output with all required sections in correct order\nAND: Output format matches TTY adapter format (hard-coded expectations)",
                          "test_method": "test_cli_displays_status_on_launch"
                        },
                        {
                          "name": "CLI displays header section",
                          "steps": "GIVEN: CLISession is initialized\nWHEN: user executes 'status' command\nTHEN: CLI displays header section with exact format\nAND: Header includes separator lines, centered bold text, description, and warning",
                          "test_method": "test_cli_displays_header_section"
                        },
                        {
                          "name": "CLI displays bot section",
                          "steps": "GIVEN: CLISession is initialized\nWHEN: user executes 'status' command\nTHEN: CLI displays bot section with exact format\nAND: Bot section includes bot name, bot path, workspace path, and change path instructions",
                          "test_method": "test_cli_displays_bot_section"
                        }
                      ]
                    },
                    {
                      "name": "Launch CLI in Pipe Mode",
                      "sequential_order": 2,
                      "connector": "and",
                      "users": [
                        "AI Agent",
                        "Automation"
                      ],
                      "story_type": "user",
                      "test_class": "TestStartCLISessionInPipeMode",
                      "scenarios": [
                        {
                          "name": "CLI launches in pipe mode",
                          "steps": "GIVEN: CLISession is configured for pipe mode (non-TTY detected)\nWHEN: commands are piped\nTHEN: CLISession creates session without interactive prompts\nAND: CLI can execute commands in pipe mode\nAND: CLI uses markdown adapters for output",
                          "test_method": "test_cli_launches_in_pipe_mode"
                        },
                        {
                          "name": "CLI displays status in markdown format",
                          "steps": "GIVEN: CLISession is initialized in pipe mode\nWHEN: user executes 'status' command\nTHEN: CLI displays complete status output in markdown format\nAND: Output includes markdown syntax (headers, bold, code blocks, lists)",
                          "test_method": "test_cli_displays_status_in_markdown_format"
                        },
                        {
                          "name": "CLI displays header section in markdown",
                          "steps": "GIVEN: CLISession is initialized in pipe mode\nWHEN: user executes 'status' command\nTHEN: CLI displays header section with markdown formatting\nAND: Header uses markdown separators and headers",
                          "test_method": "test_cli_displays_header_section_in_markdown"
                        },
                        {
                          "name": "CLI displays bot section in markdown",
                          "steps": "GIVEN: CLISession is initialized in pipe mode\nWHEN: user executes 'status' command\nTHEN: CLI displays bot section with markdown formatting\nAND: Bot section uses markdown headers, bold, and code blocks",
                          "test_method": "test_cli_displays_bot_section_in_markdown"
                        }
                      ]
                    },
                    {
                      "name": "Launch CLI in JSON Mode",
                      "sequential_order": 3,
                      "connector": "and",
                      "users": [
                        "Web View",
                        "API Client"
                      ],
                      "story_type": "user",
                      "test_class": "TestStartCLISessionInJSONMode",
                      "scenarios": [
                        {
                          "name": "CLI launches in JSON mode",
                          "steps": "GIVEN: CLISession is configured for JSON mode (mode='json' set explicitly)\nWHEN: commands are executed\nTHEN: CLISession creates session\nAND: CLI can execute commands in JSON mode\nAND: CLI uses JSON adapters for output",
                          "test_method": "test_cli_launches_in_json_mode"
                        },
                        {
                          "name": "CLI displays status in JSON format",
                          "steps": "GIVEN: CLISession is initialized in JSON mode\nWHEN: user executes 'status' command\nTHEN: CLI displays complete status output in JSON format\nAND: Output is valid JSON with required fields (name, bot_directory, workspace_directory, behavior_names, current_behavior)",
                          "test_method": "test_cli_displays_status_in_json_format"
                        },
                        {
                          "name": "CLI displays header section in JSON",
                          "steps": "GIVEN: CLISession is initialized in JSON mode\nWHEN: user executes 'status' command\nTHEN: CLI displays header section with JSON structure\nAND: Output is valid JSON dictionary",
                          "test_method": "test_cli_displays_header_section_in_json"
                        },
                        {
                          "name": "CLI displays bot section in JSON",
                          "steps": "GIVEN: CLISession is initialized in JSON mode\nWHEN: user executes 'status' command\nTHEN: CLI displays bot section with JSON structure\nAND: JSON includes bot name and directory fields",
                          "test_method": "test_cli_displays_bot_section_in_json"
                        }
                      ]
                    },
                    {
                      "name": "Display Piped Mode Instructions for AI Agents",
                      "sequential_order": 3,
                      "connector": "and",
                      "users": [
                        "CLI"
                      ],
                      "story_type": "system",
                      "test_class": "TestDisplayPipedModeInstructionsForAIAgents",
                      "scenarios": [
                        {
                          "name": "CLI displays piped mode instructions in pipe mode",
                          "steps": "GIVEN: REPLSession detects piped input\nWHEN: CLI initializes\nTHEN: CLI displays piped mode instructions header",
                          "test_method": "test_cli_displays_piped_mode_instructions_in_pipe_mode"
                        },
                        {
                          "name": "CLI omits piped mode instructions in interactive mode",
                          "steps": "GIVEN: REPLSession detects interactive TTY\nWHEN: CLI initializes\nTHEN: CLI does not display piped mode instructions",
                          "test_method": "test_cli_omits_piped_mode_instructions_in_interactive_mode"
                        }
                      ]
                    },
                    {
                      "name": "Detect and Configure TTY/Non-TTY Input",
                      "sequential_order": 4,
                      "connector": "and",
                      "users": [
                        "TTYDetector"
                      ],
                      "story_type": "system",
                      "test_class": "TestDetectAndConfigureTTYNonTTYInput",
                      "scenarios": [
                        {
                          "name": "TTY detector identifies interactive terminal",
                          "steps": "GIVEN: stdin is connected to a TTY terminal\nWHEN: CLI detects TTY status\nTHEN: Interactive mode is detected\nAND: TTY adapters are used",
                          "test_method": "test_tty_detector_identifies_interactive_terminal"
                        },
                        {
                          "name": "TTY detector identifies piped input",
                          "steps": "GIVEN: stdin is piped from another process\nWHEN: CLI detects TTY status\nTHEN: Pipe mode is detected\nAND: Markdown adapters are used",
                          "test_method": "test_tty_detector_identifies_piped_input"
                        }
                      ]
                    },
                    {
                      "name": "Load and Display Workspace Context in CLI",
                      "sequential_order": 5,
                      "connector": "and",
                      "users": [
                        "CLI"
                      ],
                      "story_type": "system",
                      "test_class": "TestLoadWorkspaceContext",
                      "scenarios": [
                        {
                          "name": "CLI loads and displays workspace context",
                          "steps": "GIVEN: Bot has workspace path\nAND: workspace contains story-graph.json\nWHEN: REPLSession initializes CLIBot\nTHEN: CLIBot loads workspace context from bot paths",
                          "test_method": "test_cli_loads_and_displays_workspace_context"
                        }
                      ]
                    },
                    {
                      "name": "Switch Registered Bots",
                      "sequential_order": 6,
                      "connector": "and",
                      "users": [
                        "CLI"
                      ],
                      "story_type": "system",
                      "test_class": "TestSwitchRegisteredBots",
                      "acceptance_criteria": [
                        "WHEN CLI STATUS section is displayed\nTHEN CLI shows current bot name followed by pipe-separated list of all registered bots AND format is: Bot: <current_bot> | Registered: <bot1> | <bot2> | <bot3>",
                        "WHEN CLI STATUS section is displayed\nTHEN CLI shows bot switching instructions AND format is: To change bots: bot <name>",
                        "WHEN user enters bot <name> command AND bot name is registered\nTHEN CLI switches to the specified bot AND updates CLI STATUS section to show new current bot",
                        "WHEN user enters bot <name> command AND bot name is not registered\nTHEN CLI displays error message AND shows list of available registered bots AND keeps current bot active",
                        "WHEN bot is switched\nTHEN CLI loads bot configuration from bot_config.json AND makes bot behaviors and actions available"
                      ],
                      "scenarios": [
                        {
                          "name": "Display Registered Bots in CLI STATUS",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_display_registered_bots_in_cli_status"
                        },
                        {
                          "name": "Switch to Valid Registered Bot",
                          "type": "happy_path",
                          "steps": [],
                          "test_method": "test_switch_to_valid_registered_bot"
                        },
                        {
                          "name": "Attempt to Switch to Unregistered Bot",
                          "type": "error_path",
                          "steps": [],
                          "test_method": "test_attempt_to_switch_to_unregistered_bot"
                        }
                      ],
                      "optional": false,
                      "priority": 1
                    }
                  ]
                }
              ]
            },
            {
              "name": "Navigate Behaviors Using REPL Commands",
              "sequential_order": 2,
              "test_file": "test_navigate_behaviors_using_repl_commands.py",
              "story_groups": [
                {
                  "type": "and",
                  "connector": null,
                  "stories": [
                    {
                      "name": "Navigate Using CLI Dot Notation",
                      "sequential_order": 1,
                      "connector": null,
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_file": "test_navigate_behaviors_using_repl_commands.py",
                      "test_class": "TestNavigateToBehaviorActionAndExecute",
                      "scenarios": [
                        {
                          "name": "User navigates with behavior only (no dots)",
                          "steps": "GIVEN: CLI is at shape.clarify.instructions\nWHEN: user enters 'discovery'\nTHEN: CLI navigates to discovery.clarify (first action)",
                          "test_method": "test_user_navigates_with_behavior_only"
                        },
                        {
                          "name": "User navigates with behavior.action (one dot)",
                          "steps": "GIVEN: CLI is at shape.clarify.instructions\nWHEN: user enters 'discovery.build'\nTHEN: CLI navigates to discovery.build.instructions",
                          "test_method": "test_user_navigates_with_behavior_dot_action"
                        },
                        {
                          "name": "User navigates with behavior.action.operation (two dots)",
                          "steps": "GIVEN: CLI is at shape.clarify.instructions\nWHEN: user enters 'discovery.build.instructions'\nTHEN: CLI executes discovery.build.instructions",
                          "test_method": "test_user_navigates_with_full_dot_notation"
                        },
                        {
                          "name": "User enters invalid behavior in dot notation",
                          "steps": "GIVEN: CLI is at shape.clarify.instructions\nWHEN: user enters 'invalid_behavior.build.instructions'\nTHEN: CLI displays error message",
                          "test_method": "test_user_enters_invalid_behavior_in_dot_notation"
                        }
                      ]
                    },
                    {
                      "name": "Navigate Sequentially Using CLI Commands",
                      "sequential_order": 2,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_file": "test_navigate_behaviors_using_repl_commands.py",
                      "test_class": "TestNavigateSequentially",
                      "scenarios": [
                        {
                          "name": "User navigates with next command",
                          "steps": "GIVEN: CLI is at shape.clarify.instructions\nWHEN: user enters 'next'\nTHEN: CLI navigates to shape.strategy",
                          "test_method": "test_user_navigates_with_next_command"
                        },
                        {
                          "name": "User navigates with back command",
                          "steps": "GIVEN: CLI is at shape.strategy.instructions\nWHEN: user enters 'back'\nTHEN: CLI navigates to shape.clarify",
                          "test_method": "test_user_navigates_with_back_command"
                        }
                      ]
                    },
                    {
                      "name": "Exit CLI REPL",
                      "sequential_order": 3,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_file": "test_navigate_behaviors_using_repl_commands.py",
                      "test_class": "TestExitREPL",
                      "scenarios": [
                        {
                          "name": "User exits REPL with exit command",
                          "steps": "GIVEN: CLI is running\nWHEN: user enters 'exit'\nTHEN: CLI terminates REPL loop",
                          "test_method": "test_user_exits_repl_with_exit_command"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "Navigate Behaviors Using Domain Model",
              "sequential_order": 2.5,
              "test_file": "test_navigate_behaviors_using_domain_model.py",
              "story_groups": [
                {
                  "type": "and",
                  "connector": null,
                  "stories": [
                    {
                      "name": "Navigate To First Behavior Action",
                      "sequential_order": 1,
                      "connector": null,
                      "users": [
                        "System"
                      ],
                      "story_type": "system",
                      "scenarios": [
                        {
                          "name": "Navigate sets current behavior and first action",
                          "steps": "GIVEN: Bot has behaviors configured\nWHEN: bot.behaviors.navigate_to('shape') is called\nTHEN: bot.behaviors.current.name == 'shape'\nAND: bot.behaviors.current.actions.current_action_name == 'clarify'",
                          "test_method": "test_navigate_sets_current_behavior_and_first_action"
                        }
                      ]
                    },
                    {
                      "name": "Advance Action And Persist State",
                      "sequential_order": 2,
                      "connector": "and",
                      "users": [
                        "System"
                      ],
                      "story_type": "system",
                      "scenarios": [
                        {
                          "name": "Close current advances and persists state",
                          "steps": "GIVEN: bot.behaviors.current is at clarify action\nWHEN: actions.close_current() is called\nTHEN: actions.current_action_name == 'strategy'\nAND: 'story_bot.shape.clarify' in completed_actions\nAND: state.current_action == 'story_bot.shape.strategy'",
                          "test_method": "test_close_current_advances_and_persists_state"
                        }
                      ]
                    },
                    {
                      "name": "Show Remaining Actions After Completion",
                      "sequential_order": 3,
                      "connector": "and",
                      "users": [
                        "System"
                      ],
                      "story_type": "system",
                      "scenarios": [
                        {
                          "name": "Remaining actions respects completion",
                          "steps": "GIVEN: bot.behaviors.current is at clarify action\nWHEN: actions.close_current() is called\nTHEN: 'clarify' not in actions.remaining_actions\nAND: actions.remaining_actions == ['validate', 'render']",
                          "test_method": "test_remaining_actions_respects_completion"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "Display Action Instructions Using REPL",
              "sequential_order": 3,
              "test_file": "test_execute_actions_using_repl.py",
              "story_groups": [],
              "sub_epics": [
                {
                  "name": "Display Common Instructions Through REPL",
                  "sequential_order": 1,
                  "test_file": "test_execute_actions_using_repl.py",
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Get Action Instructions Through CLI",
                          "sequential_order": 1,
                          "connector": null,
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_execute_actions_using_repl.py",
                          "test_class": "TestGetActionInstructionsThroughCLI",
                          "acceptance_criteria": [
                            "WHEN user navigates to behavior.action.instructions\nTHEN CLI displays formatted instructions for that action",
                            "WHEN user enters action name only as shortcut\nTHEN CLI executes instructions on current behavior's action"
                          ],
                          "scenarios": [
                            {
                              "name": "User gets instructions using full path",
                              "steps": "GIVEN: CLI is at shape.build.instructions\nWHEN: user enters 'shape.build.instructions'\nTHEN: CLI displays formatted instructions",
                              "test_method": "test_user_gets_instructions_using_full_path"
                            },
                            {
                              "name": "User calls action by name shortcut",
                              "steps": "GIVEN: CLI is at shape.build.instructions\nWHEN: user enters just 'build'\nTHEN: CLI executes instructions operation on current behavior's build action",
                              "test_method": "test_user_calls_action_by_name_shortcut"
                            }
                          ]
                        },
                        {
                          "name": "Confirm Action Completion Through CLI",
                          "sequential_order": 2,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_execute_actions_using_repl.py",
                          "test_class": "TestConfirmActionCompletionThroughCLI",
                          "scenarios": [
                            {
                              "name": "User confirms action completion",
                              "steps": "GIVEN: CLI is at shape.build.instructions\nWHEN: user enters 'confirm'\nTHEN: CLI advances to next action",
                              "test_method": "test_user_confirms_action_completion"
                            }
                          ]
                        },
                        {
                          "name": "Re-execute Current Operation Using CLI",
                          "sequential_order": 3,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_execute_actions_using_repl.py",
                          "test_class": "TestReExecuteCurrentOperationUsingCLI",
                          "scenarios": [
                            {
                              "name": "User re-executes current instructions",
                              "steps": "GIVEN: CLI is at shape.build.instructions\nWHEN: user enters 'current'\nTHEN: CLI re-executes current instructions",
                              "test_method": "test_user_re_executes_current_instructions"
                            }
                          ]
                        },
                        {
                          "name": "Handle Operation Errors and Validation in CLI",
                          "sequential_order": 4,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_execute_actions_using_repl.py",
                          "test_class": "TestHandleOperationErrorsAndValidationInCLI",
                          "scenarios": [
                            {
                              "name": "Handle operation errors gracefully",
                              "steps": "GIVEN: CLI executes operation that fails\nWHEN: error occurs\nTHEN: CLI displays error message and remains operational",
                              "test_method": "test_handle_operation_errors_gracefully"
                            }
                          ]
                        },
                        {
                          "name": "Submit Instructions Through CLI",
                          "sequential_order": 5,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_execute_actions_using_repl.py",
                          "test_class": "TestSubmitInstructionsThroughCLI",
                          "acceptance_criteria": [
                            "WHEN User executes submit command",
                            "THEN System tracks instruction submission",
                            "AND System returns success status with timestamp"
                          ],
                          "scenarios": [
                            {
                              "name": "User submits current action instructions",
                              "steps": "GIVEN: CLI is at shape.clarify\nWHEN: user enters 'submit'\nTHEN: CLI tracks instruction submission\nAND: CLI returns success message with behavior and action\nAND: CLI includes timestamp of submission",
                              "test_method": "test_user_submits_current_action_instructions"
                            },
                            {
                              "name": "Submit command fails when no current action",
                              "steps": "GIVEN: CLI has no current action set\nWHEN: user enters 'submit'\nTHEN: CLI displays error message\nAND: Error indicates no current action",
                              "test_method": "test_submit_command_fails_when_no_current_action"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Display Clarify Instructions Through REPL",
                  "sequential_order": 2,
                  "test_file": "test_display_clarify_instructions_using_repl.py",
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Display Clarification Data Through CLI",
                          "sequential_order": 1,
                          "connector": null,
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_clarify_instructions_using_repl.py",
                          "test_class": "TestDisplayClarificationDataThroughCLI",
                          "scenarios": [
                            {
                              "name": "Display stored clarification data",
                              "steps": "GIVEN: Clarification data exists\nWHEN: user views clarify instructions\nTHEN: CLI displays stored clarification data",
                              "test_method": "test_display_stored_clarification_data"
                            }
                          ]
                        },
                        {
                          "name": "Display Guardrails Through CLI",
                          "sequential_order": 2,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_clarify_instructions_using_repl.py",
                          "test_class": "TestDisplayGuardrailsThroughCLI",
                          "scenarios": [
                            {
                              "name": "Display key questions from guardrails",
                              "steps": "GIVEN: CLI is at shape.clarify.instructions\nWHEN: instructions are displayed\nTHEN: CLI shows key questions from guardrails",
                              "test_method": "test_display_key_questions_from_guardrails"
                            }
                          ]
                        },
                        {
                          "name": "Get Clarify Instructions Through CLI",
                          "sequential_order": 3,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_clarify_instructions_using_repl.py",
                          "test_class": "TestGetClarifyInstructionsThroughCLI",
                          "scenarios": [
                            {
                              "name": "Get clarify instructions with questions",
                              "steps": "GIVEN: CLI is at shape.clarify.instructions\nWHEN: user enters 'shape.clarify.instructions'\nTHEN: CLI displays key questions and required evidence",
                              "test_method": "test_get_clarify_instructions_with_questions"
                            }
                          ]
                        },
                        {
                          "name": "Confirm Clarify With Answers Through CLI",
                          "sequential_order": 4,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_clarify_instructions_using_repl.py",
                          "test_class": "TestConfirmClarifyWithAnswersThroughCLI",
                          "scenarios": [
                            {
                              "name": "User confirms clarify with answers",
                              "steps": "GIVEN: CLI is at shape.clarify.instructions\nWHEN: user enters 'confirm' with answers parameter\nTHEN: CLI saves clarification data and advances",
                              "test_method": "test_user_confirms_clarify_with_answers"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Display Strategy Instructions Through REPL",
                  "sequential_order": 3,
                  "test_file": "test_display_strategy_instructions_using_repl.py",
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Display Strategy Data Through CLI",
                          "sequential_order": 1,
                          "connector": null,
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_strategy_instructions_using_repl.py",
                          "test_class": "TestDisplayStrategyDataThroughCLI",
                          "scenarios": [
                            {
                              "name": "Display stored strategy data",
                              "steps": "GIVEN: Strategy data exists\nWHEN: user views strategy instructions\nTHEN: CLI displays stored strategy decisions and assumptions",
                              "test_method": "test_display_stored_strategy_data"
                            }
                          ]
                        },
                        {
                          "name": "Get Strategy Instructions Through CLI",
                          "sequential_order": 2,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_strategy_instructions_using_repl.py",
                          "test_class": "TestGetStrategyInstructionsThroughCLI",
                          "scenarios": [
                            {
                              "name": "Get strategy instructions with criteria",
                              "steps": "GIVEN: CLI is at shape.strategy.instructions\nWHEN: user enters 'shape.strategy.instructions'\nTHEN: CLI displays planning criteria and assumptions",
                              "test_method": "test_get_strategy_instructions_with_criteria"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Execute Actions Through REPL",
                  "sequential_order": 3.5,
                  "test_file": "test_execute_actions_using_cli.py",
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Save Guardrails Through CLI",
                          "sequential_order": 1,
                          "connector": null,
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_class": "TestSaveGuardrailsUsingCLI",
                          "acceptance_criteria": [
                            "WHEN user runs save command with answers parameter",
                            "THEN CLI saves answers to clarification.json under current behavior",
                            "AND CLI merges with existing answers",
                            "WHEN user runs save command with decisions parameter",
                            "THEN CLI saves decisions to strategy.json under current behavior"
                          ],
                          "scenarios": [
                            {
                              "name": "Save answers via CLI command",
                              "steps": "GIVEN: CLI is at shape.clarify\nWHEN: user runs 'save --answers {\"What is the scope?\": \"Bot system\"}'\nTHEN: CLI shows success message\nAND: clarification.json is updated",
                              "test_method": "test_save_answers_via_cli_command"
                            },
                            {
                              "name": "Save decisions via CLI command",
                              "steps": "GIVEN: CLI is at shape.strategy\nWHEN: user runs 'save --decisions {\"drill_down\": \"Deep\"}'\nTHEN: CLI shows success message\nAND: strategy.json is updated",
                              "test_method": "test_save_decisions_via_cli_command"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Display Build Instructions Through REPL",
                  "sequential_order": 4,
                  "test_file": "test_display_build_instructions_using_repl.py",
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Display Story Graph Through CLI",
                          "sequential_order": 1,
                          "connector": null,
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_build_instructions_using_repl.py",
                          "test_class": "TestDisplayStoryGraphThroughCLI",
                          "scenarios": [
                            {
                              "name": "Display loaded story graph",
                              "steps": "GIVEN: Story graph is loaded\nWHEN: user views build instructions\nTHEN: CLI displays story graph structure",
                              "test_method": "test_display_loaded_story_graph"
                            }
                          ]
                        },
                        {
                          "name": "Display Build Scope Through CLI",
                          "sequential_order": 2,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_build_instructions_using_repl.py",
                          "test_class": "TestDisplayBuildScopeThroughCLI",
                          "scenarios": [
                            {
                              "name": "Display active build scope",
                              "steps": "GIVEN: Build scope is set\nWHEN: user views build instructions\nTHEN: CLI displays active scope filter",
                              "test_method": "test_display_active_build_scope"
                            }
                          ]
                        },
                        {
                          "name": "Display Filtered Knowledge Graph Through CLI",
                          "sequential_order": 3,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_build_instructions_using_repl.py",
                          "test_class": "TestDisplayFilteredKnowledgeGraphThroughCLI",
                          "scenarios": [
                            {
                              "name": "Display knowledge graph with scope filter",
                              "steps": "GIVEN: Scope filter is active\nWHEN: user views build instructions\nTHEN: CLI displays filtered knowledge graph",
                              "test_method": "test_display_knowledge_graph_with_scope_filter"
                            }
                          ]
                        },
                        {
                          "name": "Get Build Instructions Through CLI",
                          "sequential_order": 4,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_build_instructions_using_repl.py",
                          "test_class": "TestGetBuildInstructionsThroughCLI",
                          "scenarios": [
                            {
                              "name": "Get build instructions without scope",
                              "steps": "GIVEN: CLI is at shape.build.instructions\nWHEN: user enters 'shape.build.instructions'\nTHEN: CLI displays build instructions with full knowledge graph",
                              "test_method": "test_get_build_instructions_without_scope"
                            },
                            {
                              "name": "Get build instructions with scope",
                              "steps": "GIVEN: CLI is at shape.build.instructions\nWHEN: user enters 'shape.build.instructions scope=\"Story1\"'\nTHEN: CLI displays build instructions filtered to Story1",
                              "test_method": "test_get_build_instructions_with_scope"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Display Validate Instructions Through REPL",
                  "sequential_order": 5,
                  "test_file": "test_display_validate_instructions_using_repl.py",
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Display Validation Scanners Through CLI",
                          "sequential_order": 1,
                          "connector": null,
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_validate_instructions_using_repl.py",
                          "test_class": "TestDisplayValidationScannersThroughCLI",
                          "scenarios": [
                            {
                              "name": "Display discovered scanners",
                              "steps": "GIVEN: Validation scanners exist\nWHEN: user views validate instructions\nTHEN: CLI displays list of available scanners",
                              "test_method": "test_display_discovered_scanners"
                            }
                          ]
                        },
                        {
                          "name": "Display Validation Results Through CLI",
                          "sequential_order": 2,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_validate_instructions_using_repl.py",
                          "test_class": "TestDisplayValidationResultsThroughCLI",
                          "scenarios": [
                            {
                              "name": "Display validation violations",
                              "steps": "GIVEN: Validation has run\nWHEN: user views validate instructions\nTHEN: CLI displays violation report",
                              "test_method": "test_display_validation_violations"
                            }
                          ]
                        },
                        {
                          "name": "Get Validate Instructions Through CLI",
                          "sequential_order": 3,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_validate_instructions_using_repl.py",
                          "test_class": "TestGetValidateInstructionsThroughCLI",
                          "scenarios": [
                            {
                              "name": "Get validate instructions with rules",
                              "steps": "GIVEN: CLI is at shape.validate.instructions\nWHEN: user enters 'shape.validate.instructions'\nTHEN: CLI displays validation rules and scanners",
                              "test_method": "test_get_validate_instructions_with_rules"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Display Render Instructions Through REPL",
                  "sequential_order": 6,
                  "test_file": "test_display_render_instructions_using_repl.py",
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Display Render Configurations Through CLI",
                          "sequential_order": 1,
                          "connector": null,
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_render_instructions_using_repl.py",
                          "test_class": "TestDisplayRenderConfigurationsThroughCLI",
                          "scenarios": [
                            {
                              "name": "Display loaded render configurations",
                              "steps": "GIVEN: Render configurations exist\nWHEN: user views render instructions\nTHEN: CLI displays templates and synchronizers",
                              "test_method": "test_display_loaded_render_configurations"
                            }
                          ]
                        },
                        {
                          "name": "Display Synchronizer Output Through CLI",
                          "sequential_order": 2,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_render_instructions_using_repl.py",
                          "test_class": "TestDisplaySynchronizerOutputThroughCLI",
                          "scenarios": [
                            {
                              "name": "Display rendered output locations",
                              "steps": "GIVEN: Synchronizers have run\nWHEN: user views render instructions\nTHEN: CLI displays output file paths",
                              "test_method": "test_display_rendered_output_locations"
                            }
                          ]
                        },
                        {
                          "name": "Get Render Instructions Through CLI",
                          "sequential_order": 3,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_display_render_instructions_using_repl.py",
                          "test_class": "TestGetRenderInstructionsThroughCLI",
                          "scenarios": [
                            {
                              "name": "Get render instructions with templates",
                              "steps": "GIVEN: CLI is at shape.render.instructions\nWHEN: user enters 'shape.render.instructions'\nTHEN: CLI displays render instructions with templates and synchronizers",
                              "test_method": "test_get_render_instructions_with_templates"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Display Rules Through REPL",
                  "sequential_order": 7,
                  "test_file": "test_display_rules_through_repl.py",
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Get Rules Instructions Through CLI",
                          "sequential_order": 1,
                          "connector": null,
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_class": "TestGetRulesInstructionsThroughCLI",
                          "acceptance_criteria": [
                            "WHEN User navigates to behavior.rules",
                            "THEN CLI displays formatted rules digest with descriptions and DO/DON'T sections",
                            "AND CLI includes rule names with their file paths",
                            "AND CLI includes all rules from the behavior"
                          ],
                          "scenarios": [
                            {
                              "name": "User gets rules instructions for behavior",
                              "type": "happy_path",
                              "steps": [
                                "Given Production story_bot with tests behavior (has rules)",
                                "When User enters 'tests.rules' in CLI",
                                "Then CLI displays formatted rules digest with descriptions, priorities, DO/DON'T sections",
                                "And Display includes rule names with their file paths",
                                "And All rules from behavior are included in digest"
                              ],
                              "test_method": "test_user_gets_rules_instructions_for_behavior"
                            },
                            {
                              "name": "User gets rules with message parameter",
                              "type": "happy_path",
                              "steps": [
                                "Given Production story_bot with tests behavior",
                                "When User enters 'tests.rules \"explain parameterized tests\"' in CLI",
                                "Then CLI displays rules digest",
                                "And Instructions include user message requesting specific rule information"
                              ],
                              "test_method": "test_user_gets_rules_with_message_parameter"
                            },
                            {
                              "name": "User gets rules without message parameter",
                              "type": "happy_path",
                              "steps": [
                                "Given Production story_bot with tests behavior",
                                "When User enters 'tests.rules' without message",
                                "Then CLI displays rules digest",
                                "And Instructions do not include user message section"
                              ],
                              "test_method": "test_user_gets_rules_without_message_parameter"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "Manage Story Graph Using REPL",
              "sequential_order": 4,
              "sub_epics": [
                {
                  "name": "Manage Story Scope Using REPL",
                  "sequential_order": 4,
                  "test_file": "test_manage_scope_using_repl.py",
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Filter Work Using Knowledge Graph Scope in CLI",
                          "sequential_order": 1,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_class": "TestSetStoryScope",
                          "acceptance_criteria": [
                            "WHEN user sets epic scope filter\nTHEN CLI displays active scope filters",
                            "WHEN user sets story scope filter\nTHEN CLI displays active scope filters",
                            "WHEN user executes build with active knowledge graph scope\nTHEN CLI displays instructions filtered to specified stories",
                            "WHEN user clears scope\nTHEN CLI removes all scope filters AND displays unfiltered content"
                          ],
                          "scenarios": [
                            {
                              "name": "User sets knowledge graph scope filter",
                              "steps": "GIVEN: CLI is at shape.build.instructions\nWHEN: user enters 'scope <filter>'\nTHEN: CLI displays active scope filters",
                              "test_method": "test_user_sets_knowledge_graph_scope_filter"
                            },
                            {
                              "name": "User executes build with active knowledge graph scope",
                              "steps": "GIVEN: CLI is at shape.build.instructions\nAND: active scope filter is story=\"Story1\"\nWHEN: user enters 'shape.build.instructions'\nTHEN: CLIAction passes scope filter to action.get_instructions()\nAND: CLI displays instructions filtered to Story1",
                              "test_method": "test_user_executes_build_with_active_knowledge_graph_scope"
                            }
                          ],
                          "optional": false,
                          "priority": 1
                        },
                        {
                          "name": "Filter Work Using Files Scope in CLI",
                          "sequential_order": 2,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "acceptance_criteria": [
                            "WHEN user sets files scope filter\nTHEN CLI displays active scope filters",
                            "WHEN user executes validate with active files scope\nTHEN CLI displays validation filtered to matched files",
                            "WHEN user provides glob pattern for files\nTHEN CLI matches files using glob pattern",
                            "WHEN user clears files scope\nTHEN CLI removes files filter AND displays unfiltered content"
                          ],
                          "optional": false,
                          "priority": 1,
                          "test_class": "TestSetFileScope",
                          "scenarios": [
                            {
                              "name": "User sets files scope filter",
                              "steps": "GIVEN: CLI is at code.validate.instructions\nWHEN: user enters 'scope files=\"src/**/*.py\"'\nTHEN: CLIScope parses files scope string\nAND: REPLSession stores files filter in context\nAND: CLI displays active scope filters",
                              "test_method": "test_user_sets_files_scope_filter"
                            },
                            {
                              "name": "User executes validate with active files scope",
                              "steps": "GIVEN: CLI is at code.validate.instructions\nAND: active scope filter is files=\"src/**/*.py\"\nWHEN: user enters 'code.validate.instructions'\nTHEN: CLIAction passes files filter to action.get_instructions()\nAND: CLI displays validation filtered to matched files",
                              "test_method": "test_user_executes_validate_with_active_files_scope"
                            }
                          ]
                        },
                        {
                          "name": "Enforce Mutually Exclusive Scope Types",
                          "sequential_order": 3,
                          "connector": "and",
                          "users": [
                            "CLI"
                          ],
                          "story_type": "system",
                          "acceptance_criteria": [
                            "WHEN user sets file scope while story scope is active\nTHEN CLI replaces story scope with file scope",
                            "WHEN user sets story scope while file scope is active\nTHEN CLI replaces file scope with story scope",
                            "WHEN checking stored scope\nTHEN only one filter type is active",
                            "WHEN user clears scope\nTHEN CLI removes all scope filters"
                          ],
                          "optional": false,
                          "priority": 2,
                          "test_class": "TestScopeTypesMutuallyExclusive",
                          "scenarios": [
                            {
                              "name": "Setting file scope replaces existing story scope",
                              "steps": "GIVEN: CLI has story scope set\nWHEN: user enters file scope\nTHEN: file scope replaces story scope (not combined)",
                              "test_method": "test_setting_file_scope_replaces_story_scope"
                            },
                            {
                              "name": "Setting story scope replaces existing file scope",
                              "steps": "GIVEN: CLI has file scope set\nWHEN: user enters story scope\nTHEN: story scope replaces file scope (not combined)",
                              "test_method": "test_setting_story_scope_replaces_file_scope"
                            },
                            {
                              "name": "Scope object can only have one type at a time",
                              "steps": "GIVEN: Any scope is set\nWHEN: checking the stored scope\nTHEN: only one filter type is active (knowledge_graph_filter OR file_filter, never both)",
                              "test_method": "test_scope_only_has_one_type"
                            }
                          ]
                        },
                        {
                          "name": "View Current Scope in CLI",
                          "sequential_order": 4,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_file": "test_manage_scope_using_repl.py",
                          "test_class": "TestViewCurrentScopeInCLI",
                          "acceptance_criteria": [
                            "WHEN user enters 'scope' command with no filters set\nTHEN CLI displays \"No scope filters active\"",
                            "WHEN user enters 'scope' command with story scope set\nTHEN CLI displays active story scope filter",
                            "WHEN user enters 'scope' command with file scope set\nTHEN CLI displays active file scope filter"
                          ],
                          "scenarios": [
                            {
                              "name": "View scope with no filters set",
                              "steps": "GIVEN: CLI is initialized with no scope filters\nWHEN: user enters 'scope' command\nTHEN: CLI displays \"No scope filters active\"",
                              "test_method": "test_view_scope_with_no_filters_set"
                            },
                            {
                              "name": "View story scope filter",
                              "steps": "GIVEN: Story scope filter is set to \"Story1\"\nWHEN: user enters 'scope' command\nTHEN: CLI displays active story scope filter",
                              "test_method": "test_view_story_scope_filter"
                            },
                            {
                              "name": "View file scope filter",
                              "steps": "GIVEN: File scope filter is set to \"*.py\"\nWHEN: user enters 'scope' command\nTHEN: CLI displays active file scope filter",
                              "test_method": "test_view_file_scope_filter"
                            }
                          ]
                        },
                        {
                          "name": "Clear Scope Through CLI",
                          "sequential_order": 5,
                          "connector": "and",
                          "users": [
                            "User"
                          ],
                          "story_type": "user",
                          "test_class": "TestClearScope",
                          "scenarios": [
                            {
                              "name": "User clears all scope filters",
                              "steps": "GIVEN: CLI is at shape.build.instructions\nAND: active scope filters are story=\"Story1\" AND files=\"docs/**/*.md\"\nWHEN: user enters 'scope clear'\nTHEN: REPLSession clears all scope filters from context\nAND: CLI displays 'All scope filters cleared'\nAND: StatusDisplay shows no active scope",
                              "test_method": "test_user_clears_all_scope_filters"
                            },
                            {
                              "name": "User executes build after clearing scope",
                              "steps": "GIVEN: CLI is at shape.build.instructions\nAND: user has cleared all scope filters\nWHEN: user enters 'shape.build.instructions'\nTHEN: CLIAction passes no scope filters to action\nAND: CLI displays unfiltered instructions",
                              "test_method": "test_user_executes_build_after_clearing_scope"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Manage File Scope Using REPL",
                  "sequential_order": 2,
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Filter File Scope",
                          "sequential_order": 1,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestFilterFileScope",
                          "scenarios": []
                        },
                        {
                          "name": "Display All Files For Behavior",
                          "sequential_order": 2,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestDisplayAllFilesForBehavior",
                          "scenarios": []
                        },
                        {
                          "name": "Add Filter Part To File Scope",
                          "sequential_order": 3,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestAddFilterPartToFileScope",
                          "scenarios": []
                        },
                        {
                          "name": "Remove Filter Part From File Scope",
                          "sequential_order": 4,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestRemoveFilterPartFromFileScope",
                          "scenarios": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Edit Story Graph In CLI",
                  "sequential_order": 3,
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Add Child Story Node To Parent",
                          "sequential_order": 1,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestAddChildStoryNodeToParent",
                          "scenarios": []
                        },
                        {
                          "name": "Delete Story Node From Parent",
                          "sequential_order": 2,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestDeleteStoryNodeFromParent",
                          "scenarios": []
                        },
                        {
                          "name": "Update Story Node name",
                          "sequential_order": 3,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestUpdateStoryNodename",
                          "scenarios": []
                        },
                        {
                          "name": "Move Story Node",
                          "sequential_order": 4,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestMoveStoryNode",
                          "scenarios": []
                        },
                        {
                          "name": "Submit Action Scoped To Story Scope",
                          "sequential_order": 5,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestSubmitActionScopedToStoryScope",
                          "scenarios": []
                        },
                        {
                          "name": "Automatically Refresh Story Graph Changes",
                          "sequential_order": 6,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestAutomaticallyRefreshStoryGraphChanges",
                          "scenarios": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "Edit Increments In CLI",
                  "sequential_order": 4,
                  "story_groups": [
                    {
                      "type": "and",
                      "connector": null,
                      "stories": [
                        {
                          "name": "Add Increment",
                          "sequential_order": 1,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestAddIncrement",
                          "scenarios": []
                        },
                        {
                          "name": "Delete Increment",
                          "sequential_order": 2,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestDeleteIncrement",
                          "scenarios": []
                        },
                        {
                          "name": "Move Story to Increment",
                          "sequential_order": 3,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestMoveStorytoIncrement",
                          "scenarios": []
                        },
                        {
                          "name": "Show All Increment Scope Through CLI",
                          "sequential_order": 4,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestShowAllIncrementScopeThroughCLI",
                          "scenarios": []
                        },
                        {
                          "name": "Submit Action Scoped To Increment",
                          "sequential_order": 5,
                          "connector": "or",
                          "users": [
                            "Bot Behavior"
                          ],
                          "story_type": "user",
                          "test_class": "TestSubmitActionScopedToIncrement",
                          "scenarios": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "Display State Using REPL",
              "sequential_order": 5,
              "test_file": "test_display_state_using_repl.py",
              "story_groups": [
                {
                  "type": "and",
                  "connector": null,
                  "stories": [
                    {
                      "name": "Display CLI Header",
                      "sequential_order": 1,
                      "connector": null,
                      "users": [
                        "CLI"
                      ],
                      "story_type": "system",
                      "test_class": "TestViewSessionHeader",
                      "acceptance_criteria": [
                        "WHEN CLI displays status\nTHEN CLI shows header with bot name AND workspace path",
                        "WHEN displaying header in terminal mode\nTHEN CLI uses plain text formatting",
                        "WHEN displaying header in piped mode\nTHEN CLI uses markdown formatting",
                        "WHEN header is displayed\nTHEN CLI includes separator line after header"
                      ],
                      "scenarios": [
                        {
                          "name": "CLI displays CLI STATUS section header when status command is run",
                          "steps": "Given: CLI is initialized\nWhen: user enters 'status' command\nThen: CLI displays CLI STATUS section header\nAND: CLI shows section separator line\nAND: CLI shows '*** CLI STATUS section ***' header text\nAND: CLI shows description text explaining what the section contains\nAND: CLI shows warning text: 'You MUST DISPLAY this entire section in your response to the user exactly as you see it'\nAND: CLI shows subsection separator\nAND: CLI shows section separator after header",
                          "test_method": "test_cli_displays_cli_status_section_header_when_status_command_is_run",
                          "notes": "Based on implementation in repl_session.py _handle_status_command() lines 397-406 and screen example from repl-cli-display-refactoring.md lines 27-33"
                        },
                        {
                          "name": "CLI displays bot name with robot emoji in header",
                          "steps": "Given CLI is initialized with story_bot\nAnd CLI is in piped mode\nWhen CLI renders the dashboard header\nThen output contains heading with robot emoji and bot name\nAnd output shows Bot: story_bot",
                          "test_method": "test_cli_displays_bot_name_with_robot_emoji_in_header",
                          "notes": "Test method referenced but not found in test files - may need to be implemented"
                        },
                        {
                          "name": "CLI displays bot path in code block",
                          "steps": "Given CLI is initialized with story_bot at path C:/dev/augmented-teams/agile_bot/bots/story_bot\nWhen CLI renders the dashboard header\nThen output contains '**Bot Path:**' label\nAnd output shows code block with three backticks\nAnd output shows the full bot directory path: 'C:\\dev\\augmented-teams\\agile_bot\\bots\\story_bot'\nAnd output closes code block with three backticks",
                          "test_method": "test_cli_displays_bot_path_in_code_block",
                          "notes": "Test method referenced but not found in test files - may need to be implemented. Based on screen example lines 35-36 and implementation in repl_session.py display_current_state() lines 169-172"
                        },
                        {
                          "name": "CLI displays workspace name and path",
                          "steps": "Given CLI is initialized with workspace base_bot\nAnd workspace path is C:/dev/augmented-teams/agile_bot/bots/base_bot\nWhen CLI renders the dashboard header\nThen output contains ' **Workspace:** base_bot' with folder emoji\nAnd output shows code block with three backticks\nAnd output shows full workspace path: 'C:\\dev\\augmented-teams\\agile_bot\\bots\\base_bot'\nAnd output closes code block with three backticks",
                          "test_method": "test_cli_displays_workspace_name_and_path",
                          "notes": "Test method referenced but not found in test files - may need to be implemented. Based on screen example lines 38-39 and implementation in repl_session.py display_current_state() lines 177-179"
                        },
                        {
                          "name": "CLI displays path change instructions",
                          "steps": "Given CLI is in piped mode\nWhen CLI renders the dashboard header\nThen output contains 'To change path:' label\nAnd output shows code block with three backticks\nAnd output shows path command example: 'path demo/mob_minion              # Change to specific project'\nAnd output shows path command example: 'path ../another_bot               # Change to relative path'\nAnd output closes code block with three backticks",
                          "test_method": "test_cli_displays_path_change_instructions",
                          "notes": "Test method referenced but not found in test files - may need to be implemented. Based on screen example lines 41-43 and implementation in repl_session.py display_current_state() lines 181-182"
                        },
                        {
                          "name": "CLI applies separator after header section",
                          "steps": "Given CLI is in piped mode\nWhen CLI renders the dashboard header\nThen output ends with horizontal separator line (subsection separator)",
                          "test_method": "test_cli_applies_separator_after_header_section",
                          "notes": "Test method referenced but not found in test files - may need to be implemented. Based on screen example line 44"
                        },
                        {
                          "name": "CLI displays headless mode section when configured",
                          "steps": "Given: Headless mode is configured with API key\nWhen: CLI renders status display\nThen: CLI displays 'Headless Mode:' label\nAND: CLI shows 'Status: Available (configured)'\nAND: CLI shows API key prefix\nAND: CLI shows Usage section with headless command format\nAND: CLI shows Examples section with headless command examples\nAND: CLI applies subsection separator after headless section",
                          "test_method": "test_cli_displays_headless_mode_section_when_configured",
                          "notes": "Based on implementation in repl_session.py display_current_state() lines 184-188 and HeadlessModeStatusDisplay.render() lines 120-148, screen example lines 45-60"
                        },
                        {
                          "name": "CLI displays active headless session when running",
                          "steps": "Given: Headless mode is configured\nAND: Active headless session is running\nWhen: CLI renders status display\nThen: CLI displays 'Active Session:' section\nAND: CLI shows Session ID\nAND: CLI shows session Status (running)\nAND: CLI shows Log file path",
                          "test_method": "test_cli_displays_active_headless_session_when_running",
                          "notes": "Based on HeadlessModeStatusDisplay.render() lines 135-140 and screen example lines 57-60"
                        },
                        {
                          "name": "CLI displays headless mode unavailable when not configured",
                          "steps": "Given: Headless mode is not configured\nWhen: CLI renders status display\nThen: CLI displays 'Headless Mode:' label\nAND: CLI shows 'Status: Unavailable (not configured)'\nAND: CLI shows configuration instructions",
                          "test_method": "test_cli_displays_headless_mode_unavailable_when_not_configured",
                          "notes": "Based on HeadlessModeStatusDisplay.render() lines 141-146"
                        }
                      ],
                      "optional": false,
                      "priority": 1
                    },
                    {
                      "name": "Display Bot Hierarchy Tree with Progress Indicators",
                      "sequential_order": 2,
                      "connector": "and",
                      "users": [
                        "CLI"
                      ],
                      "story_type": "system",
                      "test_class": "TestViewBehaviorHierarchy",
                      "acceptance_criteria": [
                        "WHEN user views status\nTHEN CLI displays bot hierarchy tree with behaviors and actions",
                        "WHEN displaying hierarchy\nTHEN CLI shows progress indicators for each action",
                        "WHEN action is completed\nTHEN CLI displays action with completed marker",
                        "WHEN action is current\nTHEN CLI displays action with current marker",
                        "WHEN action is pending\nTHEN CLI displays action with pending marker"
                      ],
                      "scenarios": [
                        {
                          "name": "User views bot hierarchy with status command",
                          "steps": "GIVEN: CLI is at discovery.build.instructions\nWHEN: user enters 'status'\nTHEN: CLI displays bot hierarchy tree",
                          "test_method": "test_user_views_bot_hierarchy_with_status_command"
                        },
                        {
                          "name": "CLI shows completed actions with [x] indicator",
                          "steps": "GIVEN: CLI is at discovery.build.instructions\nWHEN: user views status\nTHEN: CLI displays clarify action with [x] indicator",
                          "test_method": "test_cli_shows_completed_actions_with_x_indicator"
                        }
                      ],
                      "optional": false,
                      "priority": 1
                    },
                    {
                      "name": "Display Current Position in CLI",
                      "sequential_order": 3,
                      "connector": "and",
                      "users": [
                        "CLI"
                      ],
                      "story_type": "system",
                      "test_class": "TestViewCurrentPosition",
                      "acceptance_criteria": [
                        "WHEN user views status\nTHEN CLI displays current behavior, action, and operation",
                        "WHEN user navigates to different action\nTHEN CLI updates current position display",
                        "WHEN displaying position\nTHEN CLI shows behavior.action.operation format",
                        "WHEN position is at first action\nTHEN CLI indicates start of workflow"
                      ],
                      "scenarios": [
                        {
                          "name": "User views current position in status",
                          "steps": "GIVEN: CLI is at <behavior>.<action>.<operation>\nWHEN: user enters 'status'\nTHEN: CLI displays current position",
                          "test_method": "test_user_views_current_position_in_status"
                        },
                        {
                          "name": "Current position updates after navigation",
                          "steps": "GIVEN: CLI is at shape.clarify.instructions\nWHEN: user navigates to discovery behavior\nTHEN: CLI updates current position display to show discovery",
                          "test_method": "test_current_position_updates_after_navigation"
                        }
                      ],
                      "optional": false,
                      "priority": 1
                    },
                    {
                      "name": "Display Active Scope in CLI Status",
                      "sequential_order": 4,
                      "connector": "and",
                      "users": [
                        "CLI"
                      ],
                      "story_type": "system",
                      "test_class": "TestViewActiveScope",
                      "acceptance_criteria": [
                        "WHEN user views status with active scope\nTHEN CLI displays active scope section",
                        "WHEN no scope is active\nTHEN CLI displays no active scope filters message",
                        "WHEN multiple scope filters are active\nTHEN CLI displays all active filters",
                        "WHEN scope is cleared\nTHEN CLI updates status to show no active scope"
                      ],
                      "scenarios": [
                        {
                          "name": "User views active scope in status",
                          "steps": "GIVEN: CLI is at shape.build.instructions\nWHEN: user enters 'status'\nTHEN: CLI displays active scope section",
                          "test_method": "test_user_views_active_scope_in_status"
                        },
                        {
                          "name": "Status shows no active scope when cleared",
                          "steps": "GIVEN: CLI is at shape.build.instructions\nWHEN: user enters 'status'\nTHEN: CLI displays 'No active scope filters'",
                          "test_method": "test_status_shows_no_active_scope_when_cleared"
                        },
                        {
                          "name": "Status shows combined scope filters",
                          "steps": "GIVEN: CLI is at code.validate.instructions\nWHEN: user enters 'status'\nTHEN: CLI displays both knowledge graph and files scope",
                          "test_method": "test_status_shows_combined_scope_filters"
                        }
                      ],
                      "optional": false,
                      "priority": 1
                    },
                    {
                      "name": "Display CLI Navigation Menu Footer",
                      "sequential_order": 5,
                      "connector": "and",
                      "users": [
                        "CLI"
                      ],
                      "story_type": "system",
                      "test_class": "TestViewNavigationCommands",
                      "acceptance_criteria": [
                        "WHEN CLI displays status\nTHEN CLI shows footer with available commands",
                        "WHEN displaying footer\nTHEN CLI lists navigation commands AND action commands",
                        "WHEN in terminal mode\nTHEN CLI uses plain text formatting for footer",
                        "WHEN in piped mode\nTHEN CLI uses markdown formatting for footer"
                      ],
                      "scenarios": [
                        {
                          "name": "CLI displays commands menu footer",
                          "steps": "Given: CLI displays status\nWhen: CLI renders commands menu footer\nThen: CLI displays Commands section header\nAND: CLI shows command list: status | back | current | next | path [dir] | scope [filter] | headless \"msg\" | help | exit\nAND: CLI shows command usage example with echo syntax\nAND: CLI shows behaviors list: shape | prioritization | discovery | exploration | scenarios | tests | code\nAND: CLI shows actions list: clarify | strategy | build | validate | render\nAND: CLI applies section separator after footer",
                          "test_method": "test_cli_displays_commands_menu_footer",
                          "notes": "Based on screen example from repl-cli-display-refactoring.md lines 338-350"
                        }
                      ],
                      "optional": false,
                      "priority": 1
                    },
                    {
                      "name": "Display Headless Mode Status in CLI",
                      "sequential_order": 6,
                      "connector": "and",
                      "users": [
                        "CLI"
                      ],
                      "story_type": "system",
                      "test_class": "TestViewHeadlessModeStatus",
                      "acceptance_criteria": [
                        "WHEN CLI displays status\nTHEN CLI shows headless mode section",
                        "WHEN headless mode is configured\nTHEN CLI shows headless mode status as Available\nAND: CLI shows configured API key prefix\nAND: CLI shows usage examples\nAND: CLI shows command examples",
                        "WHEN headless mode is not configured\nTHEN CLI shows headless mode status as unavailable",
                        "WHEN active headless session exists\nTHEN CLI shows active session section\nAND: CLI shows session ID\nAND: CLI shows session status\nAND: CLI shows log file path"
                      ],
                      "scenarios": [
                        {
                          "name": "CLI displays headless mode section when configured",
                          "steps": "Given: CLI is initialized\nAnd: headless mode is configured with API key\nWhen: user enters 'status'\nThen: CLI displays headless mode section\nAND: CLI shows 'Headless Mode:' label\nAND: CLI shows 'Status: Available (configured)'\nAND: CLI shows 'API Key: key_2780b8...' (masked)\nAND: CLI shows 'Usage:' section with headless command format\nAND: CLI shows 'Examples:' section with example commands\nAND: CLI shows subsection separator after headless mode section",
                          "test_method": "test_cli_displays_headless_mode_section_when_configured",
                          "notes": "Based on screen example from repl-cli-display-refactoring.md lines 212-228 and implementation in repl_session.py display_current_state() lines 184-188"
                        },
                        {
                          "name": "CLI displays active headless session when running",
                          "steps": "Given: CLI is initialized\nAnd: headless mode is configured\nAnd: active headless session is running\nWhen: user enters 'status'\nThen: CLI displays 'Active Session:' section\nAND: CLI shows 'Session ID: 2025-12-30-01-31-17'\nAND: CLI shows 'Status: running'\nAND: CLI shows 'Log:' with log file path",
                          "test_method": "test_cli_displays_active_headless_session_when_running",
                          "notes": "Based on screen example from repl-cli-display-refactoring.md lines 224-227"
                        }
                      ],
                      "optional": false,
                      "priority": 2
                    },
                    {
                      "name": "Display Available Bot in Tree Hierarchy",
                      "sequential_order": 7,
                      "connector": "and",
                      "users": [
                        "CLI"
                      ],
                      "story_type": "system",
                      "test_class": "TestViewAvailableBots",
                      "acceptance_criteria": [
                        "WHEN CLI displays status\nTHEN CLI shows current bot name in header",
                        "WHEN displaying bot hierarchy\nTHEN CLI shows bot name AND available behaviors",
                        "WHEN displaying hierarchy\nTHEN CLI shows behaviors with actions in tree structure",
                        "WHEN displaying hierarchy\nTHEN CLI uses indentation to show structure"
                      ],
                      "scenarios": [
                        {
                          "name": "CLI displays bot name in header",
                          "steps": "Given: CLI displays status\nWhen: CLI renders bot hierarchy\nThen: CLI shows current bot name in header",
                          "test_method": "test_cli_displays_bot_name_in_header"
                        }
                      ],
                      "optional": false,
                      "priority": 2
                    },
                    {
                      "name": "Display CLI Bot Command in Navigation Menu Footer",
                      "sequential_order": 8,
                      "connector": "and",
                      "users": [
                        "CLI"
                      ],
                      "story_type": "system",
                      "test_class": "TestDisplayCLIBotCommandInNavigationMenuFooter",
                      "acceptance_criteria": [
                        "WHEN CLI displays footer\nTHEN CLI shows available navigation commands",
                        "WHEN displaying footer\nTHEN CLI shows command syntax for navigation and actions",
                        "WHEN displaying footer\nTHEN CLI includes examples of dot notation commands",
                        "WHEN displaying commands\nTHEN CLI shows behavior.action.operation format examples"
                      ],
                      "scenarios": [
                        {
                          "name": "CLI displays bot command in footer",
                          "steps": "Given: CLI displays footer\nWhen: CLI renders footer\nThen: CLI shows available navigation commands",
                          "test_method": "test_cli_displays_bot_command_in_footer"
                        }
                      ],
                      "optional": false,
                      "priority": 2
                    }
                  ]
                }
              ]
            },
            {
              "name": "Get Help Using REPL",
              "sequential_order": 6,
              "test_file": "test_get_help_using_repl.py",
              "story_groups": [
                {
                  "type": "and",
                  "connector": null,
                  "stories": [
                    {
                      "name": "Display Action Help Using CLI",
                      "sequential_order": 1,
                      "connector": null,
                      "users": [
                        "User"
                      ],
                      "story_type": "user",
                      "test_class": "TestDisplayActionHelpUsingCLI",
                      "acceptance_criteria": [
                        "WHEN user enters help command\nTHEN CLI displays available commands AND their descriptions",
                        "WHEN user requests help for specific action\nTHEN CLI displays detailed help for that action",
                        "WHEN displaying help\nTHEN CLI shows command syntax AND parameter descriptions",
                        "WHEN help is requested for non-existent command\nTHEN CLI displays error message with available commands"
                      ],
                      "scenarios": [
                        {
                          "name": "User views all available commands",
                          "steps": "GIVEN: CLI is running\nWHEN: user enters 'help'\nTHEN: CLI displays help menu with commands",
                          "test_method": "test_user_views_all_available_commands"
                        }
                      ],
                      "optional": false,
                      "priority": 1
                    },
                    {
                      "name": "Display Parameter Help Using CLI",
                      "sequential_order": 2,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user"
                    },
                    {
                      "name": "Display Command Examples Using CLI",
                      "sequential_order": 3,
                      "connector": "and",
                      "users": [
                        "User"
                      ],
                      "story_type": "user"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Initialize Bot",
          "sequential_order": 999,
          "test_file": "domain/test_initialize_bot.py",
          "story_groups": [
            {
              "type": "and",
              "connector": null,
              "stories": [
                {
                  "name": "Load Bot",
                  "sequential_order": 1,
                  "connector": "or",
                  "users": [
                    "Bot Behavior"
                  ],
                  "story_type": "user",
                  "test_class": "TestLoadBot",
                  "scenarios": [
                    {
                      "name": "Bot can be instantiated with bot_name and workspace (BotConfig merged into Bot).",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_bot_instantiation_with_bot_name_and_workspace"
                    },
                    {
                      "name": "Bot.name property returns bot name from config (BotConfig merged into Bot).",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_bot_name_property"
                    }
                  ]
                },
                {
                  "name": "Load Bot Behaviors",
                  "sequential_order": 2,
                  "connector": "or",
                  "users": [
                    "Bot Behavior"
                  ],
                  "story_type": "user",
                  "test_class": "TestLoadBotBehaviors",
                  "scenarios": [
                    {
                      "name": "Bot behaviors are loaded from BotConfig.",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_load_behaviors_from_bot_config"
                    },
                    {
                      "name": "When behaviors are loaded, first behavior is set as current.",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_load_behaviors_sets_first_as_current"
                    },
                    {
                      "name": "Loaded behavior provides access to all config properties",
                      "type": "happy_path",
                      "steps": [
                        "Given Behavior loaded from production config",
                        "When Config properties accessed",
                        "Then All properties accessible with correct structure"
                      ],
                      "test_method": "test_behavior_provides_access_to_all_config_properties"
                    }
                  ]
                },
                {
                  "name": "Resolve Bot Path",
                  "sequential_order": 4,
                  "connector": "or",
                  "users": [
                    "Bot Behavior"
                  ],
                  "story_type": "user",
                  "test_class": "TestResolveBotPath",
                  "scenarios": [
                    {
                      "name": "BotPath resolves directories from environment variables",
                      "type": "happy_path",
                      "steps": [
                        "Given BOT_DIRECTORY and WORKING_AREA environment variables set",
                        "When BotPath accessed from bot",
                        "Then Both directory properties return paths from environment"
                      ],
                      "test_method": "test_bot_paths_resolves_bot_and_workspace_directories_from_environment"
                    },
                    {
                      "name": "BotPath.base_actions_directory returns real agile_bot base_actions",
                      "type": "happy_path",
                      "steps": [
                        "Given BotPath instantiated",
                        "When base_actions_directory property accessed",
                        "Then Returns real agile_bot/base_actions path (not test directory)",
                        "Then Note: base_actions_directory always returns the real agile_bot/base_actions path,",
                        "Then not the test directory. This is by design - see get_base_actions_directory() in workspace.py."
                      ],
                      "test_method": "test_bot_paths_base_actions_directory_property"
                    },
                    {
                      "name": "BotPath.python_workspace_root property returns Python workspace root.",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_bot_paths_python_workspace_root_property"
                    },
                    {
                      "name": "BotPath.find_repo_root() method returns repository root.",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_bot_paths_find_repo_root_method"
                    },
                    {
                      "name": "BotPath raises error when environment variables not set",
                      "type": "happy_path",
                      "steps": [
                        "Given No BOT_DIRECTORY or WORKING_AREA environment variables",
                        "When BotPath instantiated",
                        "Then Raises RuntimeError"
                      ],
                      "test_method": "test_bot_paths_raises_error_when_environment_variables_not_set"
                    }
                  ]
                },
                {
                  "name": "Load Actions",
                  "sequential_order": 999,
                  "connector": "or",
                  "users": [
                    "Bot Behavior"
                  ],
                  "story_type": "user",
                  "test_class": "TestLoadActions",
                  "scenarios": [
                    {
                      "name": "Actions are loaded and available.",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_load_actions_from_behavior_config"
                    },
                    {
                      "name": "When actions are loaded, first action is set as current.",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_load_actions_sets_first_as_current"
                    },
                    {
                      "name": "Action merges instructions from BaseActionConfig and Behavior config.",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_action_merges_instructions_from_base_and_behavior"
                    }
                  ]
                },
                {
                  "name": "Manage Bot Registry",
                  "sequential_order": 5,
                  "connector": "or",
                  "users": [
                    "Bot Behavior"
                  ],
                  "story_type": "system",
                  "test_class": "TestManageBotRegistry",
                  "scenarios": [
                    {
                      "name": "Get List of Registered Bots",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_get_list_of_registered_bots"
                    },
                    {
                      "name": "Get Active Bot",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_get_active_bot"
                    },
                    {
                      "name": "Set Active Bot to Registered Bot",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_set_active_bot_to_registered_bot"
                    },
                    {
                      "name": "Attempt to Set Unregistered Bot",
                      "type": "error_path",
                      "steps": [],
                      "test_method": "test_attempt_to_set_unregistered_bot"
                    },
                    {
                      "name": "Set Active Bot to Current Bot",
                      "type": "happy_path",
                      "steps": [],
                      "test_method": "test_set_active_bot_to_current_bot"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ],
  "increments": [
    {
      "name": "User Manually Drops Config In to AI Chat",
      "priority": 1,
      "stories": [
        "Generate Bot Tools"
      ]
    },
    {
      "name": "Simplest MCP",
      "priority": 2,
      "stories": [
        "Generate MCP Bot Server",
        "Generate Behavior Action Tools",
        "Deploy MCP BOT Server",
        "Inject Validation Rules for Validate Rules Action",
        "Restart MCP Server To Load Code Changes",
        "Invoke Bot Tool"
      ]
    },
    {
      "name": "Workflow",
      "priority": 3,
      "stories": [
        "Generate Behavior Tools",
        "Generate MCP Bot Server",
        "Inject Knowledge Graph Template and Builder Instructions",
        "Track Activity for Build Knowledge Action",
        "Proceed To Render Output",
        "Track Activity for Gather Context Action",
        "Proceed To Decide Planning",
        "Load Render Configurations",
        "Inject Template Instructions",
        "Inject Synchronizer Instructions",
        "Track Activity for Render Output Action",
        "Track Activity for Validate Rules Action",
        "Initialize Project Location",
        "Close Current Action",
        "Execute Behavior",
        "Find Behavior Folder",
        "Forward To Current Action",
        "Forward To Current Behavior and Current Action",
        "Invoke Behavior Actions in Workflow Order",
        "Invoke Behavior in Workflow Order",
        "Track Activity For Workspace"
      ]
    },
    {
      "name": "CLI",
      "priority": 4,
      "stories": [
        "Generate REPL Command Definitions",
        "Generate CLI Entry Point",
        "Generate Cursor Commands",
        "Generate Help Documentation"
      ]
    },
    {
      "name": "Inject / Store Content",
      "priority": 6,
      "stories": [
        "Load Story Graph Into Memory",
        "Update Existing Knowledge Graph",
        "Save Final Assumptions and Decisions",
        "Store Clarification Data",
        "Inject Guardrails As Part Of Clarify Requirements",
        "Store Context Files",
        "Stores Activity for Initialize Project Action",
        "Guards Prevent Writes Without Project",
        "Initialize Project Creates Context Folder",
        "Inject Next Behavior Reminder",
        "Input File Copied To Context Folder",
        "Load And Merge Behavior Action Instructions"
      ]
    },
    {
      "name": "Code Scanner",
      "priority": 7,
      "stories": [
        "Inject Validation Rules for Validate Rules Action",
        "Discovers Scanners",
        "Run Scanners against Knowledge Graph",
        "Track Activity for Validate Rules Action",
        "Handle Validate Rules Exceptions",
        "Run All Scanners",
        "Run Scanners Against Test Code",
        "Run Scanners Against Code",
        "Load Rules Collection",
        "Find Rule By Name",
        "Iterate Rules",
        "Load Rule From File",
        "Load Scanner For Rule",
        "Get Rule Properties",
        "Create Validation Scope",
        "Load Scanner Class",
        "Load Scanner Classes",
        "Perform Incremental Validation",
        "Scope Based Parameter Handling",
        "Validation With All Parameter Combinations",
        "Inject Rules Into AI Chat Message",
        "Example Story",
        "Another Story"
      ]
    },
    {
      "name": "Refactoring",
      "priority": 8,
      "stories": [
        "Create Build Scope",
        "Filter Knowledge Graph",
        "Inject Render Instructions And Configs",
        "Get Render Instructions",
        "Merge Base And Render Instructions",
        "Render Output Using Synchronizers",
        "Detect Trigger Words Through Extension",
        "Get Trigger Priority",
        "Match Text Against Triggers",
        "CLI Accepts Scope With Python Dict Syntax",
        "CLI Normalizes Python Dict To JSON",
        "CLI Builds Parameters From Arguments",
        "CLI Handles Scope In Real Usage",
        "CLI Preserves Array Values In Scope",
        "Scope Based Parameter Handling",
        "Validation Parameter Variations",
        "CLI Type Safe Action Context",
        "CLI Context Builder Parses Typed Context",
        "CLI Parser Generator Creates Action Parsers",
        "Bootstrap Workspace",
        "Generate Help",
        "Generate Cursor Awareness Files",
        "Generate Help Parameters From Action Context Classes",
        "Insert Context Into Instructions",
        "Inject Status Update Breadcrumbs Into Instructions",
        "Load Bot Configuration",
        "Load Bot Behaviors",
        "Load Actions",
        "Load Base Action Configuration",
        "Access Bot Paths",
        "Get Base Instructions",
        "Load Behavior Config",
        "Manage Behaviors Collection",
        "Resolve Bot Paths",
        "Filter Action Based On Scope",
        "Inject Strategy Into Instructions",
        "Store Strategy Data"
      ]
    },
    {
      "name": "LangGraph Orchestration",
      "priority": 9,
      "stories": [
        "Route to Default Behavior Action",
        "Route to BotLangFlow",
        "Invoke BotLangActionNode",
        "Prepare Action Instructions",
        "Process Bot Behavor Action Instructions Automatically",
        "Process Behavor Action Instructions Through AI Chat",
        "Confirm Behavor Action Instruction Response",
        "Return to chat and pause for human-in-the-loop Node",
        "Handle Execution Modes",
        "Resume BotLangFlow from Checkpoint"
      ]
    },
    {
      "name": "REPL CLI",
      "priority": 10,
      "stories": [
        "Launch REPL Loop",
        "Detect TTY Input",
        "Support Pipe Automation Mode",
        "Support Dot Notation Commands",
        "Display Fresh Start",
        "Display Existing State",
        "Show Current Position In Workflow Breadcrumbs",
        "Show Available Behaviors and Actions",
        "Navigate To Behavior",
        "Navigate To Action",
        "Navigate Within Behavior",
        "Confirm Advances Across Behaviors",
        "Request Help",
        "Request Status",
        "Auto-Run Instructions On Navigate",
        "Confirm Action Completion Through CLI",
        "Auto-Confirm Action After Instructions Complete",
        "Advance To Next Action",
        "Loop Back To Display State",
        "Exit REPL",
        "Provide Context For Instructions",
        "Provide Story Scope Context For Instructions",
        "Provide File Scope Context For Instructions",
        "Store Scope Context",
        "Show Current Behavior Action Help",
        "Generate REPL Command Definitions",
        "Generate CLI Entry Point",
        "Generate Cursor Commands",
        "Generate Help Documentation",
        "Execute Current Action",
        "Parse Command Input",
        "Retrieve and Display Bot Behavior Action Instructions",
        "Display Action Output",
        "Prompt For Basic Parameters",
        "Prompt For Story Scope Parameters",
        "Prompt For File Scope Parameters"
      ]
    },
    {
      "name": "CLI Multi Bots",
      "priority": 13,
      "description": "Additional CLI features for bot switching, command display, and behavior invocation",
      "stories": [
        "Load All Registered Bots",
        "Invoke Specific Bot Behavior Command through CLI",
        "Navigate to Bot using CLI Dot Notation",
        "Display Available Bot in Tree Hierarchy",
        "Display CLI Bot Command in Navigation Menu Footer"
      ]
    }
  ]
}