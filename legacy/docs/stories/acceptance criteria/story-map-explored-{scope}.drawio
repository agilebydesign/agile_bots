<?xml version="1.0" ?>
<mxfile host="65bd71144e">
  <diagram id="story-map" name="Story Map">
    <mxGraphModel dx="2656" dy="1035" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="4000" pageHeight="3000" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>
        <mxCell id="epic-group" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="0" y="0" width="24666" height="190" as="geometry"/>
        </mxCell>
        <mxCell id="e1" value="Build Agile Bots" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="20" y="120" width="4106" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f1" value="Generate MCP Tools" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="20" y="200" width="1632" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e1f1s1_MCP Server Generator" value="MCP Server Generator" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22" y="415" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e1f1s1" value="Generate Bot Tools" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Generator processes Bot Config&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Generator creates 1 bot tool instance&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f1s2" value="Generate Behavior Tools" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="292" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Generator processes Bot Config&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="292" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Generator creates behavior tool instances for each behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="292" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f1s3" value="Generate MCP Bot Server" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="562" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;MCP Server Generator receives Bot Config&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="562" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Generator generates unique MCP Server instance with Unique server name from bot name&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="562" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Generated server includes Bot Config reference&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="562" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s3_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Generated server leverages Specific Bot instantiation code&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="562" y="745" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f1s4" value="Generate Behavior Action Tools" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="832" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Generator processes Bot Config&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="832" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Generator creates tool code for each (behavior, action) pair&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="832" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Enumerates all behaviors and actions from Bot Config&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="832" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s4_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND For each pair, generates tool code with unique name, trigger words, forwarding logic&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="832" y="745" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s4_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Tool catalog prepared with all generated tool instances&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="832" y="815" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f1s5" value="Deploy MCP BOT Server" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1102" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s5_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Generation Complete&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1102" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s5_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Generator deploys/starts generated MCP Server&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1102" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s5_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Server initializes in separate thread&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1102" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s5_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Server registers with MCP Protocol Handler using unique server name&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1102" y="745" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s5_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Server publishes tool catalog to AI Chat&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1102" y="815" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s5_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Each tool entry includes name, description, trigger patterns, parameters&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1102" y="885" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f1s6" value="Restart MCP Server To Load Code Changes" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1372" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s6_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Bot code changes are detected&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1372" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s6_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; MCP Server clears Python bytecode cache (__pycache__)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1372" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s6_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND MCP Server restarts to load new code&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1372" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s6_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Server restarts gracefully without losing state&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1372" y="745" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f1s6_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Server re-registers with MCP Protocol Handler after restart&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1372" y="815" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f2" value="Generate CLI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="1662" y="200" width="1362" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e1f2s1_MCP Server Generator" value="MCP Server Generator" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1664" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e1f2s1" value="Generate BOT CLI code" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1664" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;MCP Server Generator processes Bot Config&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1664" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Generator creates CLI command wrapper structure for bot invocation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1664" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s1_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Generator generates CLI entry point script (e.g., bot_cli.py and bot shell script)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1664" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s1_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI code includes argument parsing for behavior and action parameters&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1664" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s1_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI code includes help/usage documentation generation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1664" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s1_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI code supports listing available bots, behaviors, and actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1664" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s1_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Generated CLI code integrates with existing bot instantiation logic&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1664" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s1_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI code follows same routing logic as MCP tools for consistency&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1664" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f2s2" value="Generate Cursor Command Files" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1934" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Human calls generate_cursor_commands(commands_dir, cli_script_path)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1934" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; CLI creates .cursor/commands/ directory if it doesn't exist&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1934" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s2_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI creates &lt;bot-name&gt;.md command file that invokes CLI with bot name (routes to current behavior/action)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1934" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s2_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI creates &lt;bot-name&gt;-&lt;behavior&gt;.md command file for each behavior in bot that invokes CLI with bot name and behavior (auto-forwards to current action)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1934" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s2_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI creates &lt;bot-name&gt;-&lt;behavior&gt;-&lt;action&gt;.md command file for each action in each behavior that invokes CLI with bot name, behavior, and action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1934" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s2_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI creates &lt;bot-name&gt;-close.md command file that invokes CLI with bot name and --close parameter&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1934" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s2_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Each command file contains simple wrapper command that calls CLI script&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1934" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s2_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot name, behavior, and action are hardcoded in command files (no parameters needed)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1934" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s2_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI removes obsolete command files for behaviors/actions that no longer exist in bot&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1934" y="970" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s2_9" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI returns dict mapping command names (e.g., story_bot, story_bot-exploration, story_bot-exploration-gather_context, story_bot-close) to file paths&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="1934" y="1040" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f2s3" value="Generate Help" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2204" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Help generator generates CLI help&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2204" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Help contains behaviors, actions, and parameters&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2204" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Help contains CLI command syntax&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2204" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s3_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Help generator generates cursor help&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2204" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s3_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Help contains cursor command syntax&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2204" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f2s4" value="Generate Cursor Awareness Files" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2474" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Generator runs generate_awareness_files() method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2474" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Generator creates workspace rules file with trigger patterns&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2474" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND File includes bot name and behavior descriptions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2474" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s4_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND File includes trigger words sectioned by behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2474" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f2s5" value="Generate Help Parameters From Action Context Classes" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2744" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s5_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Help generator processes action context classes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2744" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s5_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Generator extracts parameters from context classes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2744" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f2s5_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Help includes action-specific parameters&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="2744" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f3" value="Generate REPL CLI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="3034" y="200" width="1092" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e1f3s1_Generator" value="Generator" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3036" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e1f3s1" value="Generate REPL Command Definitions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3036" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;generator runs, THEN Orchestrator walks all bot behaviors&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3036" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;behaviors are walked, THEN ActionDataCollector gathers action metadata for each behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3036" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s1_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;actions are gathered, THEN generator extracts parameters from each action's context_class&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3036" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s1_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;metadata is collected, THEN ReplCommandVisitor generates navigate commands for all behaviors and actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3036" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s1_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;commands are generated, THEN scope commands are created for scope.type, scope.value, scope.exclude&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3036" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s1_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;all commands are defined, THEN generator outputs command definition file&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3036" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f3s2" value="Generate CLI Entry Point" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3306" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;generator updates base_bot_cli.py, THEN it adds REPL mode with stdio_mode parameter&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3306" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;REPL mode is added, THEN it integrates with existing CliCommandRouter for routing logic&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3306" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s2_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;REPL loop is generated, THEN it includes TTY detection, state display, command parsing, and execution&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3306" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f3s3" value="Generate Cursor Commands" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3576" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;generator creates CursorReplVisitor, THEN it follows existing visitor pattern&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3576" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;visitor generates shortcuts, THEN it creates navigate shortcuts for behaviors&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3576" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;visitor generates action shortcuts, THEN it creates shortcuts for behavior-action combinations&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3576" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s3_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;visitor generates help shortcuts, THEN it creates help and status commands&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3576" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e1f3s4" value="Generate Help Documentation" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3846" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;generator creates HelpReplVisitor, THEN it generates command reference with all REPL commands&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3846" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;help is generated, THEN it includes parameter reference with descriptions for all action parameters&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3846" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;examples are generated, THEN it includes scope examples with dot-notation syntax&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3846" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e1f3s4_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;documentation is output, THEN it creates Markdown help files in .cursor/commands/ and terminal help&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="3846" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2" value="Invoke Bot" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="4156" y="120" width="8890" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f1" value="Init Project" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="4156" y="200" width="1608" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e2f1s1_Bot Behavior" value="Bot Behavior" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="415" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e2f1s1" value="Initialize Project Location" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) WHEN Bot behavior is invoked for the first time (no saved location exists)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) THEN Bot detects current directory from context&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) AND Bot presents location to user for confirmation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) AND Bot waits for user to confirm or provide different location&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="745" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) AND Bot saves confirmed location to persistent storage&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="815" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) WHEN Bot behavior is invoked&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="885" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) AND Saved location exists&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="955" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) AND Current directory matches saved location&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="1025" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) THEN Bot uses saved location without asking for confirmation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="1095" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_9" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) AND Bot proceeds directly to next action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="1165" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_10" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) WHEN Bot behavior is invoked&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="1235" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_11" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) AND Saved location exists&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="1305" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_12" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) AND Current directory is DIFFERENT from saved location&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="1375" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_13" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) THEN Bot presents new location to user for confirmation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="1445" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_14" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) AND Bot asks if user wants to switch to new location&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="1515" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s1_15" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;(AC) AND Bot saves confirmed location if user approves change&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4158" y="1585" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f1s2" value="Initialize Project Creates Context Folder" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4428" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;GIVEN: User confirms project area location&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4428" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;WHEN: initialize_project action completes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4428" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s2_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;THEN: {project_area}/docs/context/ folder exists&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4428" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s2_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND: context folder is ready for context files&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4428" y="745" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f1s3" value="Input File Copied To Context Folder" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4698" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;GIVEN: User provides input file via @input.txt command&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4698" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND: input file exists at original location&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4698" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;WHEN: initialize_project action executes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4698" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s3_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;THEN: initialize_project copies input file to {project_area}/docs/context/input.txt&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4698" y="745" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s3_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND: original input file remains at original location (copy, not move)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4698" y="815" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s3_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND: {project_area}/docs/context/input.txt exists and contains original content&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4698" y="885" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f1s4" value="Store Context Files" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;initialize_project action confirms project area location&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; initialize_project creates {project_area}/docs/context/ folder and {project_area}/docs/stories/ folder&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user provides input file via @input.txt or similar&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; initialize_project copies input file to {project_area}/docs/context/input.txt&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="745" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user provides context in conversation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="815" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; initialize_project saves context to {project_area}/docs/context/initial-context.md or similar&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="885" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;gather_context action stores clarification data&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="955" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; gather_context saves to {project_area}/docs/stories/clarification.json (generated file, NOT in context folder)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="1025" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;decide_planning_criteria action stores planning decisions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="1095" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_9" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; decide_planning_criteria saves to {project_area}/docs/stories/planning.json (generated file, NOT in context folder)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="1165" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_10" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;build_knowledge action loads context&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="1235" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_11" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; build_knowledge loads generated files from {project_area}/docs/stories/ folder (clarification.json, planning.json) and original input from {project_area}/docs/context/ folder (input.txt)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="1305" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_12" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;render_output action loads context&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="1375" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_13" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; render_output loads generated files from {project_area}/docs/stories/ folder (clarification.json, planning.json) and original input from {project_area}/docs/context/ folder (input.txt)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="1445" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_14" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;any action needs context files&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="1515" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s4_15" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; action references original input from {project_area}/docs/context/ folder and generated files from {project_area}/docs/stories/ folder&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="4968" y="1585" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f1s5" value="Guards Prevent Writes Without Project" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5238" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s5_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Activity tracker attempts to log activity&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5238" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s5_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND current_project.json does NOT exist&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5238" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s5_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Activity tracker does NOT write to activity log&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5238" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s5_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Activity tracking fails gracefully without error&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5238" y="745" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s5_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Workflow attempts to save state&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5238" y="815" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s5_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND current_project.json does NOT exist&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5238" y="885" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s5_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Workflow does NOT save workflow_state.json&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5238" y="955" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s5_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Workflow state save fails gracefully without error&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5238" y="1025" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e2f1s6_Bot Developer" value="Bot Developer" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5508" y="415" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e2f1s6" value="Bootstrap Workspace" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5508" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s6_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Entry points (MCP/CLI) bootstrap environment&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5508" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s6_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Environment is configured before importing modules&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5508" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s6_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND All directory resolution reads from environment variables only&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5508" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s6_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND agent.json provides default workspace location&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5508" y="745" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f1s6_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Environment variables can override agent.json&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5508" y="815" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f2" value="Invoke MCP" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="5774" y="200" width="1338" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e2f2s1_AI Chat" value="AI Chat" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5776" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e2f2s1" value="Invoke Bot Tool" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5776" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;AI Chat invokes bot tool with behavior and action parameters&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5776" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Tool routes to correct behavior.action method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5776" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s1_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Tool executes action and returns result&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5776" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s1_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;AI Chat invokes tool for specific behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5776" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s1_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Tool routes to that behavior only, not other behaviors&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="5776" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e2f2s2_Bot Behavior" value="Bot Behavior" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6046" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e2f2s2" value="Load And Merge Behavior Action Instructions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6046" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Action method is invoked&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6046" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action loads instructions from base_actions and behavior-specific locations&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6046" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s2_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Instructions are merged and returned&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6046" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f2s3" value="Forward To Current Behavior and Current Action" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6316" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Bot tool receives invocation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6316" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND workflow state shows current_behavior and current_action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6316" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Bot tool forwards to correct behavior and action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6316" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s3_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;workflow state does NOT exist&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6316" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s3_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Bot tool defaults to first behavior and first action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6316" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f2s4" value="Forward To Current Action" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6586" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Behavior tool receives invocation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6586" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND workflow state shows current_action within behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6586" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Behavior tool forwards to current action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6586" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s4_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;workflow state shows different behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6586" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s4_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Behavior tool updates workflow to current behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6586" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s4_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;workflow state does NOT exist&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6586" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s4_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Behavior tool defaults to first action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6586" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f2s5" value="Track Activity For Workspace" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6856" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s5_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Activity is tracked&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6856" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f2s5_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Activity is logged to workspace area not bot area&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="6856" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f3" value="Invoke CLI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="7122" y="200" width="1068" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e2f3s1_Human" value="Human" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7124" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e2f3s1" value="Invoke Bot CLI" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7124" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Human executes CLI command with bot name only (e.g., bot story_bot)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7124" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; CLI loads bot configuration for specified bot&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7124" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s1_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI loads workflow state if workflow_state.json exists&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7124" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s1_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI extracts current_behavior and current_action from workflow state&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7124" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s1_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI routes to bot and invokes current behavior and current action (same as main bot MCP tool)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7124" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s1_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot executes action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7124" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s1_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI sends bot action output to AI Chat&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7124" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s1_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot updates workflow state after action execution (if workflow action)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7124" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s1_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND If workflow_state.json doesn't exist, CLI defaults to first behavior's first action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7124" y="970" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f3s2" value="Invoke Bot Behavior CLI" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7394" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Human executes CLI command with bot name and behavior name (e.g., bot story_bot exploration)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7394" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; CLI loads bot configuration and validates behavior exists&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7394" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s2_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI loads workflow state if workflow_state.json exists&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7394" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s2_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI routes to bot and specified behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7394" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s2_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI extracts current_action from workflow state for that behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7394" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s2_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI routes to current action in specified behavior (same as behavior MCP tool)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7394" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s2_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot executes action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7394" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s2_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI sends bot action output to AI Chat&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7394" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s2_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot updates workflow state after action execution (if workflow action)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7394" y="970" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s2_9" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND If workflow_state.json doesn't exist or behavior not in state, CLI defaults to first action of specified behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7394" y="1040" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f3s3" value="Invoke Bot Behavior Action CLI" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7664" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Human executes CLI command with bot name, behavior name, and action name (e.g., bot story_bot exploration gather_context)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7664" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; CLI loads bot configuration and validates behavior and action exist&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7664" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI loads workflow state if it exists&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7664" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s3_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI routes to bot and specified behavior action (same as specific action MCP tool)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7664" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s3_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot executes action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7664" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s3_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI sends bot action output to AI Chat&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7664" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s3_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot updates workflow state after action execution (if workflow action)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7664" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s3_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI supports passing additional parameters/arguments to bot actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7664" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s3_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI provides error messages for invalid bot/behavior/action combinations&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7664" y="970" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f3s4" value="Get Help for Command Line Functions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Human executes CLI command with --help-cursor flag (e.g., bot story_bot --help-cursor)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; CLI scans all cursor command files for the bot in .cursor/commands/ directory&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI loads behavior instructions from behaviors/{behavior_name}/instructions.json for each behavior command&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI extracts meaningful descriptions from behavior instructions (description, goal, outputs - top 2-3 lines about outcomes)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI displays formatted list of all cursor commands with command name, description, and parameters&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI includes instruction at top: &quot;**PLEASE SHOW THIS OUTPUT TO THE USER**&quot;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI displays usage instructions at bottom&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Output is shown to user (AI agent displays the help output)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Human executes CLI command with --help flag (e.g., bot story_bot --help)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="970" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_9" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; CLI loads all behaviors from bot configuration&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="1040" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_10" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI loads behavior instructions from behaviors/{behavior_name}/instructions.json for each behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="1110" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_11" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI extracts meaningful descriptions from behavior instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="1180" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_12" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI loads action instructions from base_actions/{action_name}/instructions.json for each action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="1250" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_13" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI extracts action descriptions from base_actions instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="1320" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_14" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI displays formatted list of all behaviors with behavior name, description, and list of actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="1390" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_15" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI includes instruction at top: &quot;**PLEASE SHOW THIS OUTPUT TO THE USER**&quot;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="1460" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_16" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI displays usage instructions at bottom&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="1530" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_17" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Output is shown to user (AI agent displays the help output)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="1600" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f3s4_18" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI handles missing behavior instructions gracefully with fallback descriptions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="7934" y="1670" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f4" value="Perform Behavior Action" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="8200" y="200" width="2148" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e2f4s1_Bot Behavior" value="Bot Behavior" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8202" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e2f4s1" value="Find Behavior Folder" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8202" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;WHEN: find_behavior_folder is called with behavior name&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8202" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;THEN: Returns path to behavior folder with number prefix if it exists&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8202" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s1_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND: Handles various behavior folder naming patterns&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8202" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f4s2" value="Execute Behavior" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8472" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Bot behavior is invoked with action parameter&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8472" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Bot executes specified action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8472" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s2_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Bot behavior is invoked without action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8472" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s2_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Bot forwards to current action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8472" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s2_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Bot behavior is invoked out of order&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8472" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s2_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Bot requires confirmation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8472" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f4s3" value="Invoke Behavior in Workflow Order" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8742" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Behavior is invoked&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8742" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Behavior loads workflow order from behavior-specific behavior.json&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8742" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Behavior executes actions in configured order&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="8742" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f4s4" value="Load And Merge Behavior Action Instructions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9012" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Tool invokes Bot.Behavior.Action method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9012" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Behavior Action loads instructions from behavior and base_actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9012" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action merges base instructions with behavior-specific instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9012" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s4_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Compiled instructions returned for injection into AI Chat&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9012" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f4s5" value="Invoke Behavior Actions in Workflow Order" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user closes current action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; action is saved to completed_actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND workflow transitions to next action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user closes final action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; action is saved to completed_actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND workflow stays at final action (no next action available)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user attempts to close action that requires confirmation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND action is not in completed_actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; workflow does not allow closing without confirmation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="970" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_9" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user closes action that's already marked complete&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="1040" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_10" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; closing is idempotent (no error, action remains complete)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="1110" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_11" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;CLI calls --close command&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="1180" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_12" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; CLI routes to bot.close_current_action method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="1250" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s5_13" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot class has close_current_action method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9282" y="1320" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f4s6" value="Invoke Behavior Actions in Workflow Order" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9552" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s6_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;workflow starts at initialize_project&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9552" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s6_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; user can confirm and save to completed_actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9552" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s6_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user forwards to gather_context&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9552" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s6_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; workflow executes gather_context and saves state&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9552" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s6_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user closes gather_context&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9552" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s6_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; workflow transitions to decide_planning_criteria&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9552" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s6_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user jumps to discovery.gather_context (out of order)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9552" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s6_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; state correctly shows discovery.gather_context (not initialize_project)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9552" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s6_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user closes discovery action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9552" y="970" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s6_9" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; workflow transitions properly&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9552" y="1040" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s6_10" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND all completed actions tracked across both behaviors&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9552" y="1110" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f4s7" value="Close Current Action" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user closes current action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; action is saved to completed_actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND workflow transitions to next action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user closes final action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; action is saved to completed_actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND workflow stays at final action (no next action available)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user attempts to close action that requires confirmation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND action is not in completed_actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; workflow does not allow closing without confirmation&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="970" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_9" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;user closes action that's already marked complete&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="1040" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_10" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; closing is idempotent (no error, action remains complete)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="1110" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_11" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;CLI calls --close command&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="1180" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_12" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; CLI routes to bot.close_current_action method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="1250" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s7_13" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot class has close_current_action method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="9822" y="1320" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f4s8" value="Inject Next Behavior Reminder" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10092" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s8_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Action is final action in behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10092" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s8_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Next behavior reminder is injected into instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10092" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s8_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Action is not final action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10092" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f4s8_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Next behavior reminder is NOT injected&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10092" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f5" value="Orchestrate BotLangFlow" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="10358" y="200" width="2688" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e2f5s1_Bot" value="Bot" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10360" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e2f5s1" value="Route to Default Behavior Action" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10360" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Bot receives CLI command without --botlangflow flag&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10360" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Bot routes via the default behavior/action path (existing router/forward logic)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10360" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s1_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot preserves legacy behavior_action_state and activity log behavior&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10360" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s1_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND LangGraph state/runner is not invoked&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10360" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s1_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action receives the original context parameter unchanged&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10360" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f5s2" value="Route to BotLangFlow" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10630" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Bot receives CLI command with --botlangflow &lt;botlangflow_name&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10630" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Bot detects --botlangflow parameter&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10630" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s2_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot routes to BotLangFlowRunner instead of default behavior/action flow&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10630" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s2_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot builds initial BotLangState directly from CLI context (botlangflow_name, behavior, action, parameters)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10630" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s2_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot passes botlangflow_name and initial BotLangState to BotLangFlowRunner&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10630" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s2_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;BotLangFlowRunner receives botlangflow_name and initial BotLangState&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10630" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s2_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; BotLangFlowRunner loads the BotLangFlow Python file matching botlangflow_name&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10630" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s2_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangFlowRunner calls the flow's build function to create the StateGraph&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10630" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s2_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangFlowRunner compiles the StateGraph with SqliteSaver checkpointer&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10630" y="970" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s2_9" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangFlowRunner invokes the compiled graph with initial BotLangState and thread_id&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10630" y="1040" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e2f5s3_LangGraph" value="LangGraph" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10900" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e2f5s3" value="Invoke BotLangActionNode" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1a237e;strokeColor=#0d47a1;fontColor=#ffffff;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10900" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;LangGraph invokes a node in the StateGraph&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10900" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; LangGraph calls the node's __call__ method with current BotLangState&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10900" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangActionNode receives BotLangState via __call__ entry point&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10900" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s3_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangActionNode extracts behavior/action/context from BotLangState&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10900" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s3_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangActionNode invokes action.execute(context) with extracted context&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10900" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s3_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangActionNode returns updated BotLangState to LangGraph&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="10900" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e2f5s4_BotLangActionNode" value="BotLangActionNode" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11170" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e2f5s4" value="Prepare Action Instructions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1a237e;strokeColor=#0d47a1;fontColor=#ffffff;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11170" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;BotLangActionNode executes in autonomous or interactive mode&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11170" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; BotLangActionNode calls get_instructions() method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11170" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND get_instructions() invokes action.execute(context) to collect instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11170" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s4_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Instructions are returned as string ready for AI submission&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11170" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s4_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action context is included in the instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11170" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f5s5" value="Process Bot Behavor Action Instructions Automatically" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1a237e;strokeColor=#0d47a1;fontColor=#ffffff;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11440" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s5_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;BotLangActionNode executes in autonomous mode&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11440" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s5_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; BotLangActionNode calls run_autonomous() method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11440" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s5_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND run_autonomous() sends instructions to AI via API client&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11440" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s5_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangActionNode waits for AI response&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11440" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f5s6" value="Process Behavor Action Instructions Through AI Chat" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1a237e;strokeColor=#0d47a1;fontColor=#ffffff;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11710" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s6_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;BotLangActionNode executes in interactive mode&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11710" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s6_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; BotLangActionNode calls run_interactive() method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11710" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s6_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangActionNode returns dict with 'prompt' and 'needs_confirmation' flag&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11710" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s6_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangFlow execution pauses at the interactive node&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11710" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s6_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND SqliteSaver saves checkpoint with BotLangState at the pause point with thread_id&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11710" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s6_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Human can review AI response and provide confirmation or feedback before flow resumes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11710" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s6_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Human reviews the prompt and confirms or provides feedback&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11710" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s6_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Confirmation/feedback is sent back to the bot, which is processed by LangGraph and the same BotLangActionNode&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11710" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f5s7" value="Confirm Behavor Action Instruction Response" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1a237e;strokeColor=#0d47a1;fontColor=#ffffff;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11980" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s7_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;AI responds to instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11980" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s7_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; BotLangActionNode receives the response and calls confirm_with_response() to process the AI response&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11980" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s7_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Bot behavior action execute is called again with any necessary confirmation/state to save&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11980" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s7_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND action.execute() completes and BotLangActionNode updates BotLangState with action results&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11980" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s7_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Node execution completes and LangGraph automatically saves checkpoint after node execution completes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11980" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s7_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND LangGraph continues execution to the next node in the flow&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="11980" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e2f5s8_BotLangFlow" value="BotLangFlow" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12250" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e2f5s8" value="Return to chat and pause for human-in-the-loop Node" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1a237e;strokeColor=#0d47a1;fontColor=#ffffff;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12250" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s8_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;BotLangFlow includes a dedicated human-in-the-loop node&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12250" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s8_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Node returns instructions/prompt to CLI&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12250" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s8_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND CLI outputs prompt to chat interface&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12250" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s8_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangFlow execution pauses at that node&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12250" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s8_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND SqliteSaver saves checkpoint with BotLangState at pause point with thread_id&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12250" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s8_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Human can review prompt and provide response before BotLangFlow resumes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12250" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e2f5s9" value="Handle Execution Modes" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1a237e;strokeColor=#0d47a1;fontColor=#ffffff;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12520" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s9_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;BotLangActionNode executes and BotLangState.mode is 'autonomous'&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12520" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s9_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; BotLangActionNode calls run_autonomous() which sends to AI and continues without pausing&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12520" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s9_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;BotLangActionNode executes and BotLangState.mode is 'interactive'&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12520" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s9_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; BotLangActionNode calls run_interactive() which returns prompt and pauses BotLangFlow&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12520" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s9_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND run_interactive() returns dict with 'prompt' and 'needs_confirmation' flag&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12520" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s9_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangFlow execution pauses until human provides response via --continue&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12520" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s9_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND SqliteSaver preserves BotLangState in checkpoint with thread_id&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12520" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e2f5s10_BotLangFlowRunner" value="BotLangFlowRunner" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12790" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e2f5s10" value="Resume BotLangFlow from Checkpoint" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#1a237e;strokeColor=#0d47a1;fontColor=#ffffff;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12790" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s10_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;User runs CLI with --continue flag and thread_id&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12790" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s10_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; BotLangFlowRunner calls resume_from() with thread_id and optional checkpoint_id&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12790" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s10_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangFlowRunner loads checkpoint from SqliteSaver using thread_id&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12790" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s10_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND SqliteSaver restores BotLangState from checkpoint&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12790" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s10_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangFlowRunner invokes compiled graph with restored BotLangState&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12790" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s10_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangFlow continues execution from the paused node&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12790" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s10_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Human provides response with --continue&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12790" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s10_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Response is added to BotLangState and passed to next node&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12790" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e2f5s10_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BotLangFlow proceeds with updated BotLangState&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="12790" y="970" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3" value="Execute Behavior Actions" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="13076" y="120" width="11590" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f1" value="Gather Context" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="13076" y="200" width="2148" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e3f1s1_Bot Behavior" value="Bot Behavior" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13078" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e3f1s1" value="Inject Guardrails As Part Of Clarify Requirements" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13078" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;gather_context action executes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13078" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND behavior folder exists with guardrails/required_context/key_questions.json&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13078" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s1_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND behavior folder exists with guardrails/required_context/evidence.json&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13078" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s1_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; instructions should contain actual questions (not {{key_questions}} placeholder)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13078" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s1_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND instructions should contain actual evidence (not {{evidence}} placeholder)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13078" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s1_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;guardrails don't exist&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13078" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s1_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; gather_context should not fail&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13078" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s1_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND action should execute with base instructions only&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13078" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f1s2" value="Track Activity for Gather Context Action" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13348" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;GatherContextAction executes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13348" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action creates activity entry with timestamp, action name, behavior name&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13348" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s2_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Activity entry appended to {project_area}/activity_log.json&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13348" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f1s3" value="Store Clarification Data" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13618" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;gather_context action stores clarification data&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13618" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; gather_context saves to {project_area}/docs/stories/clarification.json&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13618" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND clarification.json contains behavior-specific key_questions and evidence structure&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13618" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s3_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;clarification data already exists&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13618" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s3_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; existing data is preserved when saving new data&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13618" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f1s4" value="Proceed To Decide Planning" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13888" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;GatherContextAction completes execution&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13888" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Human says action is done&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13888" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; GatherContextAction saves Workflow State (per &quot;Saves Behavior State&quot; story)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13888" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s4_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Workflow injects next action instructions (per &quot;Inject Next Behavior-Action&quot; story)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13888" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s4_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Workflow proceeds to decide_planning_criteria&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="13888" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f1s5" value="Load Base Action Config" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14158" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s5_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Action loads configuration&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14158" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s5_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action loads base action configuration&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14158" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s5_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Configuration includes action settings&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14158" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f1s6" value="Access Actions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14428" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s6_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Action needs to access other actions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14428" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s6_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action can access action registry&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14428" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s6_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action can retrieve action configurations&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14428" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f1s7" value="Initialize Action" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14698" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s7_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Action is initialized&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14698" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s7_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action loads required configuration&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14698" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s7_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action sets up action context&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14698" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f1s8" value="Load Guardrails" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14968" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s8_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Action needs guardrails&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14968" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s8_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action loads guardrails from behavior folder&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14968" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f1s8_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Guardrails are available for injection&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="14968" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f2" value="Decide Planning Criteria Action" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="15234" y="200" width="1338" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e3f2s1_Bot Behavior" value="Bot Behavior" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15236" y="415" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e3f2s1" value="Inject Planning Criteria Into Instructions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15236" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;MCP Specific Behavior Action Tool invokes Planning Action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15236" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action checks for guardrails in behavior/guardrails/planning/&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15236" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s1_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;guardrails exist, THEN Action loads typical_assumptions.json and decision_criteria files&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15236" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s1_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action injects planning guardrails into planning section&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15236" y="745" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f2s2" value="Track Activity for Planning Action" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15506" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;PlanningAction executes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15506" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action creates activity entry with timestamp, action name, behavior name&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15506" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s2_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Activity entry appended to {project_area}/activity_log.json&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15506" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f2s3" value="Proceed To Build Knowledge" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15776" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;PlanningAction completes execution&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15776" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Human says action is done&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15776" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; PlanningAction saves Workflow State (per &quot;Saves Behavior State&quot; story)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15776" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s3_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Workflow injects next action instructions (per &quot;Inject Next Behavior-Action&quot; story)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15776" y="745" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s3_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Workflow proceeds to build_knowledge&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="15776" y="815" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f2s4" value="Inject Strategy Into Instructions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16046" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Strategy is generated&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16046" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Strategy is injected into action instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16046" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Instructions include strategy guidance&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16046" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f2s5" value="Store Strategy Data" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16316" y="475" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s5_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Strategy data is generated&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16316" y="535" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s5_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Strategy data is stored to project area&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16316" y="605" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f2s5_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Strategy data persists for later use&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16316" y="675" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f3" value="Build Knowledge" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="16582" y="200" width="2148" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e3f3s1_Bot Behavior" value="Bot Behavior" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16584" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e3f3s1" value="Load Story Graph Into Memory" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16584" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Story graph file exists&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16584" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; StoryMap loads epics, sub_epics, story_groups, stories, and scenarios&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16584" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s1_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND StoryMap provides walk method to traverse all nodes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16584" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s1_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Story graph file does not exist&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16584" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s1_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; StoryMap raises FileNotFoundError&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16584" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f3s2" value="proactively Validate knowledge against rules" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16854" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;BuildKnowledgeAction it's the initial pass of building the knowledge graphTHEN Build Knowledge Action invokes the Validate Rules action to understand if what is generated violates any rules&lt;br&gt;(see Validate Knowledge &amp; Content Against Rules)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16854" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Validate Rules action is finsihed generateing the validation report THEN the BuildKnowledgeAction goes through all of the violations to determine if any corrective action needs to be taken AND the system updates the knowledge graph based on the recommendations.&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16854" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s2_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;BuildKnowledgeAction Is finished making corrections.&lt;br&gt;&lt;b&gt;THEN&lt;/b&gt; BuildKnowledgeAction tells AI to notify the user of what corrections it made as part of presenting the fact that it's done building knowledge.&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="16854" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f3s3" value="Inject Knowledge Graph Template and Builder Instructions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17124" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Build Knowledge Action executes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17124" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action loads knowledge graph template from behavior/content/knowledge_graph/&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17124" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action injects knowledge graph template path into instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17124" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s3_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND knowledge_graph_template field is present in instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17124" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s3_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND template file path exists and is accessible&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17124" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s3_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;knowledge graph template does not exist&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17124" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s3_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action raises FileNotFoundError with appropriate error message&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17124" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f3s4" value="Track Activity for Build Knowledge Action" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17394" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;BuildKnowledgeAction executes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17394" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action creates activity entry with timestamp, action name, behavior name&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17394" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Activity entry appended to {project_area}/activity_log.json&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17394" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f3s5" value="Update Existing Knowledge Graph" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17664" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s5_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Build Knowledge Action updates existing story graph&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17664" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s5_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action updates existing story-graph.json file&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17664" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s5_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action adds increments array to existing file&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17664" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s5_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Existing epics and data are preserved&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17664" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f3s6" value="Proceed To Render Output" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17934" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s6_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;BuildKnowledgeAction completes execution&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17934" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s6_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; BuildKnowledgeAction saves Workflow State (per &quot;Saves Behavior State&quot; story)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17934" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s6_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND BuildKnowledgeAction processes content for saving&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17934" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s6_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Workflow automatically proceeds to render_output (auto_progress: true, no human confirmation needed)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="17934" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f3s7" value="Create Build Scope" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18204" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s7_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Build knowledge action needs scope&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18204" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s7_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action creates build scope from parameters&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18204" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s7_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Scope defines what to build&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18204" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f3s8" value="Filter Knowledge Graph" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18474" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s8_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Knowledge graph needs filtering&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18474" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s8_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action filters knowledge graph by scope&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18474" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f3s8_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Filtered graph contains only relevant content&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18474" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4" value="Render Output" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="18740" y="200" width="3498" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e3f4s1_Bot Behavior" value="Bot Behavior" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18742" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s1" value="Load Render Configurations" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18742" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;render_output action executes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18742" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action discovers render folder using *_content/*_render pattern&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18742" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s1_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action loads all *.json files from render folder&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18742" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s1_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action reads each render JSON configuration&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18742" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s1_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action loads instructions.json from render folder if it exists&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18742" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s1_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action verifies synchronizer classes exist and have render method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="18742" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s2" value="Inject Template Instructions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19012" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;render_output action processes template-only render configs&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19012" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action loads template file from templates folder&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19012" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s2_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action injects template content into instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19012" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s2_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND render_configs array includes template content&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19012" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s3" value="Inject Synchronizer Instructions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19282" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;render_output action processes synchronizer-based render configs&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19282" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action includes synchronizer configs in render_configs array&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19282" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action includes synchronizer execution instructions in base_instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19282" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s3_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Instructions specify how to instantiate and call synchronizer render method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19282" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s4" value="Track Activity for Render Output Action" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19552" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;RenderOutputAction executes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19552" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action creates activity entry with timestamp, action name, behavior name&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19552" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Activity entry appended to {project_area}/activity_log.json&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19552" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s5" value="Proceed To Validate Rules" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19822" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s5_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;RenderOutputAction completes execution&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19822" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s5_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Human says action is done&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19822" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s5_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; RenderOutputAction saves Workflow State (per &quot;Saves Behavior State&quot; story)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19822" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s5_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND RenderOutputAction processes content for saving&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19822" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s5_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Workflow injects next action instructions (per &quot;Inject Next Behavior-Action&quot; story)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19822" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s5_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Workflow proceeds to validate_rules&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="19822" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s6" value="Inject Render Instructions And Configs" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20092" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s6_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Render instructions are needed&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20092" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s6_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action injects render instructions and configs&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20092" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s6_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Instructions include render configuration&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20092" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s7" value="Inject Render Instructions And Configs" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20362" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s7_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Render instructions are needed&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20362" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s7_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action injects render instructions and configs&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20362" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s7_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Instructions include render configuration&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20362" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s8" value="Get Render Instructions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20632" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s8_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Action needs render instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20632" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s8_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action retrieves render instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20632" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s8_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Instructions are available for rendering&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20632" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s9" value="Get Render Instructions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20902" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s9_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Action needs render instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20902" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s9_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action retrieves render instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20902" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s9_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Instructions are available for rendering&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="20902" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s10" value="Merge Base And Render Instructions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21172" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s10_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Base and render instructions exist&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21172" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s10_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action merges base and render instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21172" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s10_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Merged instructions combine both sets&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21172" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s11" value="Merge Base And Render Instructions" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21442" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s11_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Base and render instructions exist&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21442" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s11_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action merges base and render instructions&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21442" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s11_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Merged instructions combine both sets&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21442" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s12" value="Render Output Using Synchronizers" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21712" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s12_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Output needs rendering&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21712" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s12_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action uses synchronizers to render output&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21712" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s12_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Synchronizers execute render method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21712" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f4s13" value="Render Output Using Synchronizers" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21982" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s13_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Output needs rendering&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21982" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s13_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action uses synchronizers to render output&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21982" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f4s13_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Synchronizers execute render method&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="21982" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f5" value="Validate Knowledge &amp; Content Against Rules" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="22248" y="200" width="2418" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e3f5s1_Bot Behavior" value="Bot Behavior" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22250" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e3f5s1" value="Inject Validation Rules for Validate Rules Action" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22250" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s1_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;MCP Specific Behavior Action Tool invokes Validate Rules Action&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22250" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s1_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action loads common bot rules from base_bot/rules/&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22250" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s1_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action loads behavior-specific rules&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22250" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s1_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action merges and injects rules into validation section&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22250" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f5s2" value="Discovers Scanners" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22520" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s2_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;scanner discovery is executed for rule files THEN scanners are discovered from rule files containing scanner properties&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22520" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s2_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;scanner class path is found in rule file THEN scanner class is located and validated&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22520" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s2_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;scanner metadata is extracted THEN metadata includes rule_name, description, and behavior_name&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22520" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s2_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;scanners are registered THEN scanners are organized in catalog grouped by behavior_name&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22520" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s2_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;rule file is malformed THEN error is logged and valid scanners are still registered&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22520" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s2_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;scanner class is not found THEN error is logged and scanner is not registered&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22520" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s2_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;rule file is missing scanner property THEN error is logged and scanner is not registered&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22520" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f5s3" value="Track Activity for Validate Rules Action" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22790" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s3_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;ValidateRulesAction executes&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22790" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s3_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action creates activity entry with timestamp, action name, behavior name, violations count&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22790" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s3_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Activity entry appended to {project_area}/activity_log.json&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="22790" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="user_e3f5s4_Scanner" value="Scanner" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23060" y="290" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="e3f5s4" value="Run Scanners against Knowledge Graph" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23060" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s4_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;scanners are executed against knowledge graph THEN violations are detected at exact line numbers&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23060" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s4_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;violations are detected THEN violation details include rule_name, location, violation_message, and severity&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23060" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s4_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;multiple scanners execute THEN violations from all scanners are aggregated&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23060" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f5s5" value="Invoke Complete Validation Workflow" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23330" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s5_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;ValidateRulesAction completes execution&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23330" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s5_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action returns instructions with base_instructions (primary) and validation_rules (supporting context)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23330" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s5_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action returns content_to_validate information (project location, rendered outputs, clarification.json, planning.json, report_path)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23330" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s5_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action presents validation results to user&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23330" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s5_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action instructions include report_path where validation report should be saved (validation-report.md in docs/stories/)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23330" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s5_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;AI generates validation report&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23330" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s5_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; AI saves validation report to file at report_path location&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23330" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s5_7" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Human says action is done&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23330" y="900" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s5_8" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; ValidateRulesAction saves Workflow State (per &quot;Saves Behavior State&quot; story)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23330" y="970" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s5_9" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND validate_rules is terminal action (next_action: null, workflow completes)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23330" y="1040" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f5s6" value="Run AST Scanners against Knowledge Graph (OUT OF SCOPE)" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23600" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s6_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;Scanner configured with AST parsing processes code files THEN Scanner parses code into abstract syntax tree AND Scanner traverses AST nodes to detect structural violations AND Scanner records violation location (file path, line number, node type, violation description)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23600" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f5s7" value="Validate Rules According To Scope" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23870" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s7_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;ValidateRulesAction receives scope parameter&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23870" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s7_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;THEN&lt;/b&gt; Action validates only files matching scope&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23870" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s7_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;AND Action respects test_file, code_file, or knowledge_graph scope&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="23870" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f5s8" value="Generate Violation Report" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="24140" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s8_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;violation report is generated THEN report is generated in requested format&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="24140" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s8_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;violations are grouped THEN violations are organized by behavior_name, rule_name, location, or severity&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="24140" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s8_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;report is written to file THEN file is created at specified output destination&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="24140" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="e3f5s9" value="Report Validation and Error Handling" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fff2cc;strokeColor=#d6b656;fontColor=#000000;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="24410" y="350" width="50" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s9_0" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;ValidateRulesAction receives violations data as array THEN Report is generated successfully with violations including exact line_number and severity&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="24410" y="410" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s9_1" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;ValidateRulesAction receives violations data that is not an array THEN Error is reported: &quot;Violations data must be an array&quot; AND No report is generated&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="24410" y="480" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s9_2" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;ValidateRulesAction receives violations with missing fields (location, violation_message) THEN Partial report is generated AND Missing fields are handled gracefully AND Report includes available fields including severity&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="24410" y="550" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s9_3" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;ValidateRulesAction receives violations with null values THEN Report is generated with nulls preserved or replaced with defaults AND Severity is preserved&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="24410" y="620" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s9_4" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;ValidateRulesAction receives array with 1000+ violations THEN Report is generated AND Large array is handled efficiently AND All violations are included with severity&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="24410" y="690" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s9_5" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;ValidateRulesAction receives violations data with circular references THEN Error is reported: &quot;Circular reference detected in violations data&quot;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="24410" y="760" width="250" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="ac_e3f5s9_6" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;WHEN&lt;/b&gt;&amp;nbsp;ValidateRulesAction receives violations with missing severity THEN Report is generated AND Missing severity is handled gracefully AND Default severity is applied or null is preserved&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=8;" parent="1" vertex="1">
          <mxGeometry x="24410" y="830" width="250" height="60" as="geometry"/>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
